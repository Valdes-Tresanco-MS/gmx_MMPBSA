{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"","title":"Home"},{"location":"advanced/","text":"Advanced Options \u00b6 The default values for the various parameters as well as the inclusion of some variables over others in the general MMPBSA.py input file were chosen to cover the majority of all MM/PB(GB)SA calculations that would be attempted while maintaining maximum simplicity. However, there are situations in which MMPBSA.py may appear to be restrictive and ill-equipped to address. Attempts were made to maintain the simplicity described above while easily providing users with the ability to modify most aspects of the calculation easily and without editing the source code. -make-mdins This flag will create all of the mdin and input files used by sander and nmode so that additional control can be granted to the user beyond the variables detailed in the input file section above. The files created are _GMXMMPBSA_gb.mdin which controls GB calculation; _GMXMMPBSA_pb.mdin which controls the PB calculation; _GMXMMPBSA_sander_nm_min.mdin which controls the sander minimization of snapshots to be prepared for nmode calculations; and _GMXMMPBSA_nmode.in which controls the nmode calculation. If no input file is specified, all files above are created with default values, and _GMXMMPBSA_pb.mdin is created for AmberTools\u2019s pbsa. If you wish to create a file for sander.APBS , you must include an input file with sander_apbs=1 specified to generate the desired input file. Note that if an input file is specified, only those mdin files pertinent to the calculation described therein will be created! -use-mdins This flag will prevent MMPBSA.py from creating the input files that control the various calculations (_GMXMMPBSA_gb.mdin, _GMXMMPBSA_pb.mdin, _GMXMMPBSA_sander_nm_min.mdin, and _GMXMMPBSA_nmode.in). It will instead attempt to use existing input files (though they must have those names above!) in their place. In this way, the user has full control over the calculations performed, however care must be taken. The mdin files created by MMPBSA.py have been tested and are (generally) known to be consistent. Modifying certain variables (such as imin=5 ) may prevent the script from working, so this should only be done with care. It is recommended that users start with the existing mdin files (generated by the -make-mdins flag above), and add and/or modify parameters from there. Note -make-mdins and -use-mdins are intended to give added flexibility to user input. If the MM/PBSA input file does not expose a variable you require, you may use the -make-mdins flag to generate the MDIN files and then quit. Then, edit those MDIN files, changing the variables you need to, then running gmx_MMPBSA with -use-mdins to use those modified files. QM/MMGBSA There are a lot of options for QM/MM calculations in sander, but not all of those options were made available via options in the MMPBSA.py input file. In order to take advantage of these other options, you\u2019ll have to make use of the -make-mdins and -use-mdins flags as detailed above and change the resulting _GMXMMPBSA_gb_qmmm_com/rec/lig.mdin files to fit your desired calculation. Additionally, MMPBSA.py suffers all shortcomings of sander, one of those being that PB and QM/MM are incompatible. Therefore, only QM/MMGBSA is a valid option right now.","title":"Advanced Options"},{"location":"advanced/#advanced-options","text":"The default values for the various parameters as well as the inclusion of some variables over others in the general MMPBSA.py input file were chosen to cover the majority of all MM/PB(GB)SA calculations that would be attempted while maintaining maximum simplicity. However, there are situations in which MMPBSA.py may appear to be restrictive and ill-equipped to address. Attempts were made to maintain the simplicity described above while easily providing users with the ability to modify most aspects of the calculation easily and without editing the source code. -make-mdins This flag will create all of the mdin and input files used by sander and nmode so that additional control can be granted to the user beyond the variables detailed in the input file section above. The files created are _GMXMMPBSA_gb.mdin which controls GB calculation; _GMXMMPBSA_pb.mdin which controls the PB calculation; _GMXMMPBSA_sander_nm_min.mdin which controls the sander minimization of snapshots to be prepared for nmode calculations; and _GMXMMPBSA_nmode.in which controls the nmode calculation. If no input file is specified, all files above are created with default values, and _GMXMMPBSA_pb.mdin is created for AmberTools\u2019s pbsa. If you wish to create a file for sander.APBS , you must include an input file with sander_apbs=1 specified to generate the desired input file. Note that if an input file is specified, only those mdin files pertinent to the calculation described therein will be created! -use-mdins This flag will prevent MMPBSA.py from creating the input files that control the various calculations (_GMXMMPBSA_gb.mdin, _GMXMMPBSA_pb.mdin, _GMXMMPBSA_sander_nm_min.mdin, and _GMXMMPBSA_nmode.in). It will instead attempt to use existing input files (though they must have those names above!) in their place. In this way, the user has full control over the calculations performed, however care must be taken. The mdin files created by MMPBSA.py have been tested and are (generally) known to be consistent. Modifying certain variables (such as imin=5 ) may prevent the script from working, so this should only be done with care. It is recommended that users start with the existing mdin files (generated by the -make-mdins flag above), and add and/or modify parameters from there. Note -make-mdins and -use-mdins are intended to give added flexibility to user input. If the MM/PBSA input file does not expose a variable you require, you may use the -make-mdins flag to generate the MDIN files and then quit. Then, edit those MDIN files, changing the variables you need to, then running gmx_MMPBSA with -use-mdins to use those modified files. QM/MMGBSA There are a lot of options for QM/MM calculations in sander, but not all of those options were made available via options in the MMPBSA.py input file. In order to take advantage of these other options, you\u2019ll have to make use of the -make-mdins and -use-mdins flags as detailed above and change the resulting _GMXMMPBSA_gb_qmmm_com/rec/lig.mdin files to fit your desired calculation. Additionally, MMPBSA.py suffers all shortcomings of sander, one of those being that PB and QM/MM are incompatible. Therefore, only QM/MMGBSA is a valid option right now.","title":"Advanced Options"},{"location":"analyzer/","text":"gmx_MMPBSA_ana : The analyzer tool \u00b6 Overview \u00b6 gmx_MMPBSA_ana is a simple but powerful analysis tool. It is mainly focused on providing a fast, easy and efficient access to different graphics according to the analysis ( Figure 1 ). The tool has been optimized to work with a large number of charts, even more than you can review ( Check this section to learn about the potential of gmx_MMPBSA_ana ). Figure 1. gmx_MMPBSA_ana graphical overview gmx_MMPBSA_ana components Start dialog Plot area Data control area Menus Types of charts \u00b6 Line plot \u00b6 Represents the evolution of a component during the simulation time. In some cases, it is the value of the calculated parameter, eg: TOTAL DELTA , VDWAALS , etc., and in others, it is the sum of the elements it contains, eg: TDC as the sum of all the per-residue energy contributions. Note The line plot can additionally contain the moving average (solid red line) or other elements such as other indicators (dash red and green lines). Warning Note that TDC , SDC , and BDC are calculated from the immediate items contained within themselves. This means that the results obtained for the TDC in a per-residue calculation will probably be different from the TDC of a per-wise calculation with the same residues. This is because the per-residue energy contribution is calculated taking into account the environment that surrounds each residue, so the sum of their contributions will be exactly the maximum contribution per selected residues. On the other hand, in the per-wise calculation, the TDC will be equal to the sum of each residue contribution, the difference being that the contribution of each residue is obtained from the contributions of the selected pairs and not with all the environment that surrounds it. Therefore, both calculations should be used for different purposes and care should be taken with the interpretation of the results. Figure 2 . Line plot examples. Up: \u0394H representation, Down: Interaction Entropy representation Bar plot \u00b6 Represents the total contribution of a component for the simulation. In some cases, it is the Average of the calculated parameter, eg: TOTAL DELTA , VDWAALS , RESIDUES in per-residue calculation, etc., and in others, it is the sum of the elements it contains, eg: NMODE and QH Entropy, \u0394G Binding, etc. The bars that represent averages also have a solid line that represents the standard deviation, while the bars representing a specific value do not. Figure 3 . Bar plot examples. Up: Per-residue contribution, Down: \u0394G Binding Heatmap plot \u00b6 Represents the evolution of several components at the same time during the simulation. It is used to represent the contribution of all residues in per-residue calculation or all pairs for each residue in the per-wise calculation. It could also represent the relationship between components.This is explicit for per-wise calculations and represents the contribution of each residue with its respective pairs. Tip The relational heatmap graph is the best representation in the per-wise analysis. Figure 4 . Heatmap plot examples. Up: Per-residue contribution per-frame, Down: Inter Residue-pair contribution Representations \u00b6 Note The following videos provide a visual medium to facilitate the use of gmx_MMPBSA_ana . If you find our tool useful and want to use it for a visual project, such as tutorials, examples, etc., we will gladly include it in the documentation as well as in the list of acknowledgments and collaborators. Binding Free Energy calculation (GB + IE) \u00b6 Correlation analysis \u00b6 Alanine scanning \u00b6 Per-residue decomposition \u00b6 Functionalities \u00b6 gmx_MMPBSA_ana under pressure \u00b6 Warning Around 1.8 million graphs were loaded in gmx_MMPBSA_ana and it is showed only for educational purposes. In this experiment, we replicated our examples folder 9 times (differs from the one available on Github) giving us a total of 99 systems. As you can see in the video, gmx_MMPBSA_ana manages to deal well with the incredible amount of ~1.6 million items. Every item contains between 1 and 3 graphics, for a total of ~1.8 million graphics loaded. This feat is accomplished in ~11 minutes. Most of this time is consumed processing the data associated with each graph. At the moment, gmx_MMPBSA_ana processes this data serially, since parallelizing this process would be a bit difficult. In any case, for the usual processes, this will take a maximum of 25-30 seconds, depending on your hardware. Each item has associated the data of each of its graphs, which is stored in memory. In this experiment, RAM consumption reached up to 14GB. Danger Be aware that if you run out of available RAM, your OS could crash, freeze, or slow down. Does this mean that you will not be able to load 100 systems in gmx_MMPBSA_ana ? Not at all. Consumption depends on the type of calculation you have made, and the data you want to analyze. In this experiment, there were several systems that contain the decomp data. We also selected to show the complex, receptor, and ligand data, which usually can be skipped. Only a system calculated with per-wise selecting about 40 amino acids generates about 11 thousand items.","title":"gmx_MMPBSA_ana"},{"location":"analyzer/#gmx_mmpbsa_ana-the-analyzer-tool","text":"","title":"gmx_MMPBSA_ana: The analyzer tool"},{"location":"analyzer/#overview","text":"gmx_MMPBSA_ana is a simple but powerful analysis tool. It is mainly focused on providing a fast, easy and efficient access to different graphics according to the analysis ( Figure 1 ). The tool has been optimized to work with a large number of charts, even more than you can review ( Check this section to learn about the potential of gmx_MMPBSA_ana ). Figure 1. gmx_MMPBSA_ana graphical overview gmx_MMPBSA_ana components Start dialog Plot area Data control area Menus","title":"Overview"},{"location":"analyzer/#types-of-charts","text":"","title":"Types of charts"},{"location":"analyzer/#line-plot","text":"Represents the evolution of a component during the simulation time. In some cases, it is the value of the calculated parameter, eg: TOTAL DELTA , VDWAALS , etc., and in others, it is the sum of the elements it contains, eg: TDC as the sum of all the per-residue energy contributions. Note The line plot can additionally contain the moving average (solid red line) or other elements such as other indicators (dash red and green lines). Warning Note that TDC , SDC , and BDC are calculated from the immediate items contained within themselves. This means that the results obtained for the TDC in a per-residue calculation will probably be different from the TDC of a per-wise calculation with the same residues. This is because the per-residue energy contribution is calculated taking into account the environment that surrounds each residue, so the sum of their contributions will be exactly the maximum contribution per selected residues. On the other hand, in the per-wise calculation, the TDC will be equal to the sum of each residue contribution, the difference being that the contribution of each residue is obtained from the contributions of the selected pairs and not with all the environment that surrounds it. Therefore, both calculations should be used for different purposes and care should be taken with the interpretation of the results. Figure 2 . Line plot examples. Up: \u0394H representation, Down: Interaction Entropy representation","title":"Line plot"},{"location":"analyzer/#bar-plot","text":"Represents the total contribution of a component for the simulation. In some cases, it is the Average of the calculated parameter, eg: TOTAL DELTA , VDWAALS , RESIDUES in per-residue calculation, etc., and in others, it is the sum of the elements it contains, eg: NMODE and QH Entropy, \u0394G Binding, etc. The bars that represent averages also have a solid line that represents the standard deviation, while the bars representing a specific value do not. Figure 3 . Bar plot examples. Up: Per-residue contribution, Down: \u0394G Binding","title":"Bar plot"},{"location":"analyzer/#heatmap-plot","text":"Represents the evolution of several components at the same time during the simulation. It is used to represent the contribution of all residues in per-residue calculation or all pairs for each residue in the per-wise calculation. It could also represent the relationship between components.This is explicit for per-wise calculations and represents the contribution of each residue with its respective pairs. Tip The relational heatmap graph is the best representation in the per-wise analysis. Figure 4 . Heatmap plot examples. Up: Per-residue contribution per-frame, Down: Inter Residue-pair contribution","title":"Heatmap plot"},{"location":"analyzer/#representations","text":"Note The following videos provide a visual medium to facilitate the use of gmx_MMPBSA_ana . If you find our tool useful and want to use it for a visual project, such as tutorials, examples, etc., we will gladly include it in the documentation as well as in the list of acknowledgments and collaborators.","title":"Representations"},{"location":"analyzer/#binding-free-energy-calculation-gb-ie","text":"","title":"Binding Free Energy calculation (GB + IE)"},{"location":"analyzer/#correlation-analysis","text":"","title":"Correlation analysis"},{"location":"analyzer/#alanine-scanning","text":"","title":"Alanine scanning"},{"location":"analyzer/#per-residue-decomposition","text":"","title":"Per-residue decomposition"},{"location":"analyzer/#functionalities","text":"","title":"Functionalities"},{"location":"analyzer/#gmx_mmpbsa_ana-under-pressure","text":"Warning Around 1.8 million graphs were loaded in gmx_MMPBSA_ana and it is showed only for educational purposes. In this experiment, we replicated our examples folder 9 times (differs from the one available on Github) giving us a total of 99 systems. As you can see in the video, gmx_MMPBSA_ana manages to deal well with the incredible amount of ~1.6 million items. Every item contains between 1 and 3 graphics, for a total of ~1.8 million graphics loaded. This feat is accomplished in ~11 minutes. Most of this time is consumed processing the data associated with each graph. At the moment, gmx_MMPBSA_ana processes this data serially, since parallelizing this process would be a bit difficult. In any case, for the usual processes, this will take a maximum of 25-30 seconds, depending on your hardware. Each item has associated the data of each of its graphs, which is stored in memory. In this experiment, RAM consumption reached up to 14GB. Danger Be aware that if you run out of available RAM, your OS could crash, freeze, or slow down. Does this mean that you will not be able to load 100 systems in gmx_MMPBSA_ana ? Not at all. Consumption depends on the type of calculation you have made, and the data you want to analyze. In this experiment, there were several systems that contain the decomp data. We also selected to show the complex, receptor, and ligand data, which usually can be skipped. Only a system calculated with per-wise selecting about 40 amino acids generates about 11 thousand items.","title":"gmx_MMPBSA_ana under pressure"},{"location":"api/","text":"Python API \u00b6 The aim of the gmx_MMPBSA API is to provide you with direct access to the raw data produced during a gmx_MMPBSA calculation. By default, gmx_MMPBSA calculates an average, standard deviation, and standard error of the mean for all the generated data sets, but it does not support custom analyses. The API reads an _GMXMMPBSA_info file, from which it will determine what kind of calculation was performed, then automatically parse the output files and load the data into arrays. Warning The topology files you used in the gmx_MMPBSA calculation must also be available in the location specified in the _ GMXMMPBSA_info file. Using the API \u00b6 We have derived a new API to reorganize the data so that it is arranged more hierarchically. This makes easier to transform the data into graphs in the gmx_MMPBSA_ana . **The original and the current API only differ in the name of the callable function, the disposition of the data in Per-wise decomposition analysis and in the new 'delta' key. The function load_gmxmmpbsa_info takes the name of a gmx_MMPBSA info file (typically _GMXMMPBSA_info ) and returns a populated mmpbsa_data instance with all the parsed data. An example code snippet that creates a mmpbsa_data instance from the information in _ GMXMMPBSA_info is shown below. Important Unlike MMPBSA.py, load_gmxmmpbsa_info does not need to be located in the folder that contains the _GMXMMPBSA_info file. New in v1.4.0 from GMXMMPBSA import API as gmxMMPBSAapi data = gmxMMPBSAapi . load_gmxmmpbsa_info ( \"_GMXMMPBSA_info\" ) Properties of mmpbsa_data \u00b6 The mmpbsa_data class is a nested dictionary structure ( mmpbsa_data is actually derived from dict ). The various attributes of mmpbsa_data are described below followed by the defined operators. Attributes \u00b6 If the numpy package is installed and available, all data arrays will be numpy.ndarray instances. Otherwise, all data arrays will be array.array instances with the \u2019d\u2019 data type specifier (for a double precision float). The data is organized in an mmpbsa_data instance in the following manner: mmpbsa_data_instance [ 'calc_key' ][ 'system_component' ][ 'energy_term' ] In this example, calc_key is a dict key that is paired to another dict ( mmpbsa_data_instance is the first-level dict , in this case) (Table 2). The keys of these second-level dict instances ( system_component ) pair to another dict (Table 3). Table 2. List and description of calc_key dict keys that may be present in instances of the mmpbsa_data class. Dictionary Key (calc_key) Calculation Type gb Generalized Born Results pb Poisson-Boltzmann Results rism gf Gaussian Fluctuation 3D-RISM Results rism std Standard 3D-RISM Results ie Interaction Entropy Results nmode Normal Mode Analysis Results qh Quasi-harmonic Approximation Results Table 3. List and description of system_component keys that may be present in instances of the mmpbsa_data class. Dictionary Key (system_component) Description complex Data sets for the complex. (Stability & Binding) receptor Data sets for the receptor. (Binding only) ligand Data sets for the ligand. (Binding only) delta Data sets for the delta. (Binding only) The keys of these inner-most (third-level) dict instances are paired with the data arrays for that energy term (Table 4). The various dictionary keys are listed below for each level. If alanine scanning was performed, the mmpbsa_data_instance also has a \"mutant\" attribute that contains the same dictionary structure as mmpbsa_data does for the normal system. If not, the mutant attribute is None. The only difference is that the data is accessed as follows: mmpbsa_data_instance . mutant [ 'calc_key' ][ 'system_component' ][ 'energy_term' ] Warning All keys are case-sensitive, and if a space appears in the key, it must be present in your program. Also, if polar/non-polar decomposition is not performed for 3D-RISM , then the POLAR SOLV and APOLAR SOLV keys are replaced with the single key ERISM Table 4. List and description of energy_term keys that may be present in instances of the mmpbsa_data class. The allowed values of energy_term depend on the value of calc_key above in Table 2. The energy_term keys are listed for each calc_key enumerated above, accompanied by a description. The RISM keys are the same for both rism gf and rism std although the value of POLAR SOLV and APOLAR SOLV will differ depending on the method chosen. Those keys marked with * are specific to the CHARMM force field used through chamber. Those arrays are all 0 for normal Amber topology files. Description gb pb RISM Bond energy BOND BOND BOND Angle energy ANGLE ANGLE ANGLE Dihedral Energy DIHED DIHED DIHED Urey-Bradley* UB UB \u2014 Improper Dihedrals* IMP IMP \u2014 Correction Map* CMAP CMAP \u2014 1-4 van der Waals energy 1-4 VDW 1-4 VDW 1-4 VDW 1-4 Electrostatic energy 1-4 EEL 1-4 EEL 1-4 EEL van der Waals energy VDWAALS VDWAALS VDWAALS Electrostatic energy EEL EEL EEL Polar solvation energy EGB EPB POLAR SOLV Non-polar solvation energy ESURF ENPOLAR APOLAR SOLV Total solvation free energy G solv G solv G solv Total gas phase free energy G gas G gas G gas Total energy TOTAL TOTAL TOTAL Table 5. Same as Table 4 for the entropy (nmode and qh) data. Description nmode qh Translational entropy Translational Translational Rotational entropy Rotational Rotational Vibrational entropy Vibrational Vibrational Total entropy Total Total Table 6. Same as Table 5 for the Interaction Entropy data. Description IE Data per-frame data Mean of the selected interval value Star and End frames of the selected interval frames Defined operators \u00b6 In-place addition: It extends all of the arrays that are common to both mmpbsa_data instances. This is useful if, for instance, you run two gmx_MMPBSA calculations, and you use -prefix for the second simulation. Assuming that is _GMXMMPBSA2_ for the second gmx_MMPBSA calculation, the following pseudo-code will generate an mmpbsa_data instance with all of the data in concatenated arrays. The pseudo-code assumes GMXMMPBSA.API was imported as demonstrated below. data = gmxMMPBSAapi . load_gmxmmpbsa_info ( \"_GMXMMPBSA_info\" ) data += gmxMMPBSAapi . load_gmxmmpbsa_info ( \"_GMXMMPBSA2_info\" ) Example API Usage \u00b6 In many cases, the autocorrelation function of the energy can aid in the analysis of MM/PBSA data, since it provides a way of determining the statistical independence of your data points. For example, 1000 correlated snapshots provide less information, and therefore less statistical certainty, than 1000 uncorrelated snapshots. The standard error of the mean calculation performed by gmx_MMPBSA assumes a completely uncorrelated set of snapshots, which means that it is a lower bound of the true standard error of the mean, and a plot of the autocorrelation function may help determine the actual value. The example program below will calculate the autocorrelation function of the total energy (complex only for both the normal and alanine mutant systems) from a GB calculation and plot the resulting code using matplotlib. import os import sys # append AMBERHOME/bin to sys.path sys . path . append ( os . path . join ( os . getenv ( 'AMBERHOME' ), 'bin' )) # Now import the MMPBSA API from GMXMMPBSA import API as gmxMMPBSAapi import matplotlib.pyplot as plt import numpy as np data = gmxMMPBSAapi . load_gmxmmpbsa_info ( '_GMXMMPBSA_info' ) total = data [ 'gb' ][ 'complex' ][ 'TOTAL' ] . copy () data = gmxMMPBSAapi . load_gmxmmpbsa_info ( '_GMXMMPBSA_info' ) total_mut = data . mutant [ 'gb' ][ 'complex' ][ 'TOTAL' ] . copy () # Create a second copy of the data set. The np.correlate function does not # normalize the correlation function, so we modify total and total2 to get # that effect total -= total . mean () total /= total . std () total2 = total . copy () / len ( total ) acor = np . correlate ( total , total2 , 'full' ) total_mut -= total_mut . mean () total_mut /= total_mut . std () total2_mut = total_mut . copy () / len ( total_mut ) acor_mut = np . correlate ( total_mut , total2_mut , 'full' ) # Now generate the 'lag' axis xdata = np . arange ( 0 , len ( total )) # The acor data set is symmetric about the origin, so only accept the # positive lag times. Graph the result plt . plot ( xdata , acor [ len ( acor ) // 2 :], xdata , acor_mut [ len ( acor ) // 2 :]) plt . show () Decomposition Data \u00b6 When performing decomposition analysis, the various decomp data is stored in a separate tree of dicts referenced with the decomp key. The key sequence is similar to the sequence for the normal data described above, where decomp is followed by the solvent model ( GB or PB ), followed by the species ( complex , receptor , or ligand ) (additionally, we include delta key), followed by the decomposition components (total, backbone, or sidechain), followed by the residue number (and residue pair for pairwise decomposition), finally followed by the contribution ( internal , van der Waals , electrostatics , etc.) The available keys are shown in Figure 1 (and each key is described afterwards). Decomp Key Descriptions: gb All Generalized Born results pb All Poisson-Boltzmann results complex All results from the complex trajectory receptor All results from the receptor trajectory ligand All results from the ligand trajectory delta All results from delta total decomposition [ complex TDC - (receptor TDC + ligand TDC) ] TDC All results from the total decomposition SDC All results from the sidechain decomposition BDC All results from the backbone decomposition # All data from residue number # in per-residue and per-wise decomposition (same residue numbering scheme as in each respective topology file) ## All interaction energies between residues ## and their respective pair # in per-wise decomposition (same residue numbering scheme as in each respective topology file) int Internal energy contributions (see the idecomp variable description above) vdw van der Waals energy contributions eel Electrostatic energy contributions pol Polar solvation free energy contributions sas Non-polar solvation free energy contributions tot Total free energy contributions (sum of previous 5). Figure 1 . Tree of dict keys following the decomp key in a mmpbsa_data instance.","title":"Python API"},{"location":"api/#python-api","text":"The aim of the gmx_MMPBSA API is to provide you with direct access to the raw data produced during a gmx_MMPBSA calculation. By default, gmx_MMPBSA calculates an average, standard deviation, and standard error of the mean for all the generated data sets, but it does not support custom analyses. The API reads an _GMXMMPBSA_info file, from which it will determine what kind of calculation was performed, then automatically parse the output files and load the data into arrays. Warning The topology files you used in the gmx_MMPBSA calculation must also be available in the location specified in the _ GMXMMPBSA_info file.","title":"Python API"},{"location":"api/#using-the-api","text":"We have derived a new API to reorganize the data so that it is arranged more hierarchically. This makes easier to transform the data into graphs in the gmx_MMPBSA_ana . **The original and the current API only differ in the name of the callable function, the disposition of the data in Per-wise decomposition analysis and in the new 'delta' key. The function load_gmxmmpbsa_info takes the name of a gmx_MMPBSA info file (typically _GMXMMPBSA_info ) and returns a populated mmpbsa_data instance with all the parsed data. An example code snippet that creates a mmpbsa_data instance from the information in _ GMXMMPBSA_info is shown below. Important Unlike MMPBSA.py, load_gmxmmpbsa_info does not need to be located in the folder that contains the _GMXMMPBSA_info file. New in v1.4.0 from GMXMMPBSA import API as gmxMMPBSAapi data = gmxMMPBSAapi . load_gmxmmpbsa_info ( \"_GMXMMPBSA_info\" )","title":"Using the API"},{"location":"api/#properties-of-mmpbsa_data","text":"The mmpbsa_data class is a nested dictionary structure ( mmpbsa_data is actually derived from dict ). The various attributes of mmpbsa_data are described below followed by the defined operators.","title":"Properties of mmpbsa_data"},{"location":"api/#attributes","text":"If the numpy package is installed and available, all data arrays will be numpy.ndarray instances. Otherwise, all data arrays will be array.array instances with the \u2019d\u2019 data type specifier (for a double precision float). The data is organized in an mmpbsa_data instance in the following manner: mmpbsa_data_instance [ 'calc_key' ][ 'system_component' ][ 'energy_term' ] In this example, calc_key is a dict key that is paired to another dict ( mmpbsa_data_instance is the first-level dict , in this case) (Table 2). The keys of these second-level dict instances ( system_component ) pair to another dict (Table 3). Table 2. List and description of calc_key dict keys that may be present in instances of the mmpbsa_data class. Dictionary Key (calc_key) Calculation Type gb Generalized Born Results pb Poisson-Boltzmann Results rism gf Gaussian Fluctuation 3D-RISM Results rism std Standard 3D-RISM Results ie Interaction Entropy Results nmode Normal Mode Analysis Results qh Quasi-harmonic Approximation Results Table 3. List and description of system_component keys that may be present in instances of the mmpbsa_data class. Dictionary Key (system_component) Description complex Data sets for the complex. (Stability & Binding) receptor Data sets for the receptor. (Binding only) ligand Data sets for the ligand. (Binding only) delta Data sets for the delta. (Binding only) The keys of these inner-most (third-level) dict instances are paired with the data arrays for that energy term (Table 4). The various dictionary keys are listed below for each level. If alanine scanning was performed, the mmpbsa_data_instance also has a \"mutant\" attribute that contains the same dictionary structure as mmpbsa_data does for the normal system. If not, the mutant attribute is None. The only difference is that the data is accessed as follows: mmpbsa_data_instance . mutant [ 'calc_key' ][ 'system_component' ][ 'energy_term' ] Warning All keys are case-sensitive, and if a space appears in the key, it must be present in your program. Also, if polar/non-polar decomposition is not performed for 3D-RISM , then the POLAR SOLV and APOLAR SOLV keys are replaced with the single key ERISM Table 4. List and description of energy_term keys that may be present in instances of the mmpbsa_data class. The allowed values of energy_term depend on the value of calc_key above in Table 2. The energy_term keys are listed for each calc_key enumerated above, accompanied by a description. The RISM keys are the same for both rism gf and rism std although the value of POLAR SOLV and APOLAR SOLV will differ depending on the method chosen. Those keys marked with * are specific to the CHARMM force field used through chamber. Those arrays are all 0 for normal Amber topology files. Description gb pb RISM Bond energy BOND BOND BOND Angle energy ANGLE ANGLE ANGLE Dihedral Energy DIHED DIHED DIHED Urey-Bradley* UB UB \u2014 Improper Dihedrals* IMP IMP \u2014 Correction Map* CMAP CMAP \u2014 1-4 van der Waals energy 1-4 VDW 1-4 VDW 1-4 VDW 1-4 Electrostatic energy 1-4 EEL 1-4 EEL 1-4 EEL van der Waals energy VDWAALS VDWAALS VDWAALS Electrostatic energy EEL EEL EEL Polar solvation energy EGB EPB POLAR SOLV Non-polar solvation energy ESURF ENPOLAR APOLAR SOLV Total solvation free energy G solv G solv G solv Total gas phase free energy G gas G gas G gas Total energy TOTAL TOTAL TOTAL Table 5. Same as Table 4 for the entropy (nmode and qh) data. Description nmode qh Translational entropy Translational Translational Rotational entropy Rotational Rotational Vibrational entropy Vibrational Vibrational Total entropy Total Total Table 6. Same as Table 5 for the Interaction Entropy data. Description IE Data per-frame data Mean of the selected interval value Star and End frames of the selected interval frames","title":"Attributes"},{"location":"api/#defined-operators","text":"In-place addition: It extends all of the arrays that are common to both mmpbsa_data instances. This is useful if, for instance, you run two gmx_MMPBSA calculations, and you use -prefix for the second simulation. Assuming that is _GMXMMPBSA2_ for the second gmx_MMPBSA calculation, the following pseudo-code will generate an mmpbsa_data instance with all of the data in concatenated arrays. The pseudo-code assumes GMXMMPBSA.API was imported as demonstrated below. data = gmxMMPBSAapi . load_gmxmmpbsa_info ( \"_GMXMMPBSA_info\" ) data += gmxMMPBSAapi . load_gmxmmpbsa_info ( \"_GMXMMPBSA2_info\" )","title":"Defined operators"},{"location":"api/#example-api-usage","text":"In many cases, the autocorrelation function of the energy can aid in the analysis of MM/PBSA data, since it provides a way of determining the statistical independence of your data points. For example, 1000 correlated snapshots provide less information, and therefore less statistical certainty, than 1000 uncorrelated snapshots. The standard error of the mean calculation performed by gmx_MMPBSA assumes a completely uncorrelated set of snapshots, which means that it is a lower bound of the true standard error of the mean, and a plot of the autocorrelation function may help determine the actual value. The example program below will calculate the autocorrelation function of the total energy (complex only for both the normal and alanine mutant systems) from a GB calculation and plot the resulting code using matplotlib. import os import sys # append AMBERHOME/bin to sys.path sys . path . append ( os . path . join ( os . getenv ( 'AMBERHOME' ), 'bin' )) # Now import the MMPBSA API from GMXMMPBSA import API as gmxMMPBSAapi import matplotlib.pyplot as plt import numpy as np data = gmxMMPBSAapi . load_gmxmmpbsa_info ( '_GMXMMPBSA_info' ) total = data [ 'gb' ][ 'complex' ][ 'TOTAL' ] . copy () data = gmxMMPBSAapi . load_gmxmmpbsa_info ( '_GMXMMPBSA_info' ) total_mut = data . mutant [ 'gb' ][ 'complex' ][ 'TOTAL' ] . copy () # Create a second copy of the data set. The np.correlate function does not # normalize the correlation function, so we modify total and total2 to get # that effect total -= total . mean () total /= total . std () total2 = total . copy () / len ( total ) acor = np . correlate ( total , total2 , 'full' ) total_mut -= total_mut . mean () total_mut /= total_mut . std () total2_mut = total_mut . copy () / len ( total_mut ) acor_mut = np . correlate ( total_mut , total2_mut , 'full' ) # Now generate the 'lag' axis xdata = np . arange ( 0 , len ( total )) # The acor data set is symmetric about the origin, so only accept the # positive lag times. Graph the result plt . plot ( xdata , acor [ len ( acor ) // 2 :], xdata , acor_mut [ len ( acor ) // 2 :]) plt . show ()","title":"Example API Usage"},{"location":"api/#decomposition-data","text":"When performing decomposition analysis, the various decomp data is stored in a separate tree of dicts referenced with the decomp key. The key sequence is similar to the sequence for the normal data described above, where decomp is followed by the solvent model ( GB or PB ), followed by the species ( complex , receptor , or ligand ) (additionally, we include delta key), followed by the decomposition components (total, backbone, or sidechain), followed by the residue number (and residue pair for pairwise decomposition), finally followed by the contribution ( internal , van der Waals , electrostatics , etc.) The available keys are shown in Figure 1 (and each key is described afterwards). Decomp Key Descriptions: gb All Generalized Born results pb All Poisson-Boltzmann results complex All results from the complex trajectory receptor All results from the receptor trajectory ligand All results from the ligand trajectory delta All results from delta total decomposition [ complex TDC - (receptor TDC + ligand TDC) ] TDC All results from the total decomposition SDC All results from the sidechain decomposition BDC All results from the backbone decomposition # All data from residue number # in per-residue and per-wise decomposition (same residue numbering scheme as in each respective topology file) ## All interaction energies between residues ## and their respective pair # in per-wise decomposition (same residue numbering scheme as in each respective topology file) int Internal energy contributions (see the idecomp variable description above) vdw van der Waals energy contributions eel Electrostatic energy contributions pol Polar solvation free energy contributions sas Non-polar solvation free energy contributions tot Total free energy contributions (sum of previous 5). Figure 1 . Tree of dict keys following the decomp key in a mmpbsa_data instance.","title":"Decomposition Data"},{"location":"changelog/","text":"Changelog \u00b6 gmx_MMPBSA v1.5.0 (coming soon...) \u00b6 Additions \u00b6 gmx_MMPBSA \u00b6 Option to create an input file ( --create_input ) New format file (h5) to store all the data result enabled NonLinear PB solver in sander ( #63 ) enabled all pbsa options in sander ( #64 ) enabled all 3D-RISM variables ( #68 ) Improve IE output data ( #91 ) New C2 Entropy method added ( #73 ) New method to get the decomp data without the API classes gmx_MMPBSA_ana \u00b6 Chart properties selector. The following properties can be changed: Font size: Axes (Ticks, Labels) Title, Subtitle and legend Color bar Pallete, color or theme: Line plot Bar plot Heatmap plot PyMOL visualization Rotation, padding and number of ticks Figure size, dpi and format Chart type specific properties Highlight or split components Frame range and interval selection Chart data can be visualized in table format and copy directly to excel Now the outputs files can be visualized as document in their own sub-window New button to launch all the graphics and functions associated to item Highlighted Bar and Heatmap plot User setting file per-system Documentation \u00b6 Code block names and annotations Input and Output file pages Fixes \u00b6 gmx_MMPBSA \u00b6 Issue with protonated residues print_res selection Error when startframe=0 ( #66 ) parmchk2 always uses GAFF as force field ( #45 ) Now IE is calculated for PB and GB independently ( #72 ) Issue with alanine scanning CHARMM ff ( #88 ) Issue with MT approach ( #78 ) get_num_terms function run forever if TDC term not found. ( #98 ) Check if the groups defined for receptor and ligand are the same ( #86 ) Standard deviation calculation. This error comes from the original version of MMPBSA.py ( #105 ) Structure consistency ( #80 , #79 ) Now gmx_MMPBSA launches an error when there is an OverflowError on IE calculation ( #57 ) Improve gmx_MMPBSA .log file ( #108 ) Inconsistency with multiple trajectories ( #120 ) gmx_MMPBSA_ana \u00b6 Tick labels in line plots ( #65 ) Improved PyMOL 3D visualization ( #85 ) Improved the system options in the init dialog gmx_MMPBSA_test \u00b6 Error when -f option it not defined ( #46 ) Changes \u00b6 gmx_MMPBSA \u00b6 Removed deprecate variables EnergyVector changed to ndarray subclass Regen expression for mutant_res Now the COM, REC and LIG trajectories must have the same length when MT approach Improved verbose logging Removed *.gro file support in -cs , -rs and -ls flags Added trjconv to avoid the PBC in the tpr file ( #43 ) gmx_MMPBSA_ana \u00b6 New set of chart buttons IE plot gmx_MMPBSA_test \u00b6 Improved parallel processing Documentation \u00b6 Updated packages dependency gxm_MMPBSA v1.4.3 (26/05/2021) \u00b6 Additions \u00b6 Added two new tutorials Protein_ligand_LPH_atoms_CHARMMff and QM/MMGBSA calculations Now the program reports the p-value associated with the correlation coefficient when performing the correlation analysis Google Analytics is used as a third-party tracking service to improve documentation. Check our Private Policy for more details Fixes \u00b6 Minor fixes in the documentation Improved parsing of forcefields variable Fixed bug when gmx_MMPBSA_ana runs without arguments Fixed compatibility with older files ( < v1.4.0 ) Fixed error when debug_printlevel > 1 in tleap command Changes \u00b6 Now the command line used is added to the log file The gmx_MMPBSA data folder is exported directly rather than copied in the $AMBERHOME data folder. gxm_MMPBSA v1.4.2 (01/05/2021) \u00b6 Additions \u00b6 Added Covid-19 and other complex systems as examples in the documentation Added Q&A section to the documentation Implemented an adaptive intdiel (GB)/ indi (PB) for Alanine scanning (Check the input file section) Fixes \u00b6 Fixed bug when startframe = 0 ( #33 ) Fixed bug when blank lines exist in [molecule] section in topology file Fixed pipe command-line for Gromacs execution in macOS Fixed compatibility issues with v1.3.x Improved and fixed the documentation Improved output file information related to \u0394G binding Improved calculation with different entropy approximations simultaneously Changes \u00b6 Changed protein_forcefields and ligand_forcefield by forcefields variable in all examples Now QH and IE can be calculated at the same time entropy variable was separated in qh_entropy and interaction_entropy . The entropy variable is deprecated and will be removed in the next major version (v1.5.0). entropy_seg was replaced by ie_segment . The entropy_seg variable is deprecated and will be removed in the next major version (v1.5.0). gxm_MMPBSA v1.4.1 (08/04/2021) \u00b6 Additions New class Residue added to handle residues selection in Gromacs format with Amber index Verification of the presence of water molecules in receptor and ligand groups Gromacs timer added Fixes Gromacs topology conversion qm_residues notation Default path in gmx_MMPBSA_test The Entropy representation in gmx_MMPBSA_ana Bug when the structure has insertion code Improved \u0394G Binding plot representation Changes Now forcefields variable unifies protein_forcefield and ligand_forcefield . These variables protein_forcefield and ligand_forcefield are deprecated and will be removed in the next major version (v1.5.0). Improved documentation Examples Command-line MPI Examples Links and references Updated to material 7.1.0 Dark mode Material \"Back to Top\" button Grammatical corrections Installation section Figures caption The Ambiguous name for Entropy term in output files gxm_MMPBSA v1.4.0 (22/03/2021) \u00b6 This release focuses almost entirely on gmx_MMPBSA_ana with minor issues fixed in gmx_MMPBSA Additions New start window to select options Option to make correlation (Pearson and Spearman coefficients) Option to hide decomposition data Option to not compute charts with a non-significant contribution Option to not include terms with a non-significant contribution in bar charts Selection of the components to display in addition to Delta (i.e. complex, receptor, and ligand) Toggle the chart toolbar for a cleaner visualization An informative table with selected systems data Option to exclude any system Option to change: The system name The experimental Ki for correlation The temperature to calculate the Experimental Energy and the Interaction Entropy Data reader with progress bar and multiprocessing Multiple systems to analyze in the same session Correlation dock Multiple models at the same time Graphs and correlation data for each calculated energy term (\u0394H, \u0394H+IE, \u0394H+NMODE and \u0394H+QH) Table with the experimental energy of the systems, and the data of the selected model New arguments flags for gmx_MMPBSA_ana (See the gmx_MMPBSA_ana documentation ) replaced -p by -f -f accept a folder, single info file or a list of them New flag -r . This flag allows to load all the systems inside a selected folder New graphical options A new set of graphics (heatmap) Per-frame when analyzing Per-residue and pair in Per-wise Relation matrix for Per-wise Interactive visualization of PDB files with per-residue energies with PyMOL (up to 5 instances). Regression plot for correlation Plot features Added Standard deviation to bar plots Added rolling average to line plots Added indicators for the selected interval and average value in IE chart Added crosshair cursor for better analysis on charts Multiprocessing application for testing ( gmx_MMPBSA_test ) Embed Youtube videos for gmx_MMPBSA_ana Fixes Now gmx_MMPBSA_ana shows stability results as expected Errors in the documentation MPI Changes Converted analyzer.py into a sub-module for more flexibility, organization and portability Residues notation for mutation: CHAIN:RESNAME:RESNUMBER:ICODE instead of Amber residue index Improve the selection method in decomposition calculation Replaced variable entropy_temp (deprecated) by temperature IE in API Color Palette used in graphs Use seaborn and matplotlib for charts Use Pandas Dataframe and numpy to store data Changed the data structure to implement dynamic selection of frames in future versions Improved data export: now any item can be exported as CSV file Improved the documentation Improve examples documentation Added changelog button at home Separated changelog in a new header Added tags to mark the history of changes of variables and functionalities gxm_MMPBSA v1.3.3 (09/03/2021) \u00b6 Fixes fixed Boltzmann constant for IE fix mutation in ligand fixed analyzer error when interval > 1 fixed residue selection within fixed ChainID assignation when reference structure is defined fixed the selection to print when decomposition gxm_MMPBSA v1.3.2 (01/03/2021) \u00b6 Additions Now, gmx_MMPBSA is in Zenodo . You can refer to us in this way in what we publish the article Added Interaction Entropy to gmx_MMPBSA output file Added a new class to save IE in a csv file Added \"Go to Top\" button to documentation HTML. Fixes Error when ligand and/or receptor are discontinuous (Testing it) Error when ligand and/or receptor are discontinuous and numbered non-consecutively Non-critical errors and inconsistencies in documentation Changes receptor_mask and ligand_mask have been removed from input file variables. Now we extract the amber mask directly based on the GROMACS index file The receptor and ligand mapping in the complex was improved. Now we use a method based on the GROMACS index file The method Map of the system_MMPBSA class has been restructured. Now always processes amber masks Changing the IE calculation function to a class gmx_MMPBSA-v1.3.1 \u00b6 Additions New variable ( overwrite_data ) to overwrite gmx_MMPBSA data. More informative message when sander fail. Useful for PB calculation Fixes Protein-ligand with charmm force field example Stability calculation gmx path error leaprc.GLYCAM_06h-1 file Protein-glycan example Changes Documentation banner gmx_MMPBSA-v1.3.0 \u00b6 Additions Documentation at Github pages Charmm force field support Amber topology generation from GROMACS topology. Work for Charmm and Amber force fields New flag for topologies ( -cp , -rp and -lp ) added Now gmx_MMPBSA supports discontinuous receptor and ligand. Glycine scanning Autocompletion script for both gmx_MMPBSA and gmx_MMPBSA_ana Versioneer to control the semantic version. Argument type checker for the command-line Fixes Alanine scanning tutorial GROMACS executable path The -gui option has been changed by -nogui and fixed when it is defined Improvement on documentation Changes Documentation theme. Now we use Material Alanine scanning variable. Now mutant correspond to mutant amino acid (ALA and GLY) The gmx_MMPBSA_gui was changed by gmx_MMPBSA_ana Improvement on the topologies construction process Order in which the trajectories are cleaned. Now, the topology is built and finally, the trajectories are cleaned gmx_MMPBSA v1.2.0 \u00b6 Additions New ligand force field (Zwitterionic amino acids) A new flag (-cr) added for defining a reference structure (guarantee a better consistency in generated PDB files) API documentation Fixes More comprehensive output log file Best handling of structure files Changes gmx editconf is used to generate PDB files instead of gmx trjconv ( #14 ) gmx_MMPBSA data is copied in AMBER as an independent folder *.gro files can be used as a MD Structure+mass(db) file Updated tutorial list in README (Protein_DNA_RNA_Ion_ligand BFE calculations) gmx_MMPBSA v1.1.1 \u00b6 Additions New tutorial added (see Protein_DNA_RNA_Ion_ligand tutorial) Fixes Support various metallo-complexes formats Changes Keep all the temporary files in the folder for debugging purposes gxm_MMPBSA v.1.1.0 \u00b6 Additions Now supports carbohydrates as ligand. See this tutorial Now supports metalloprotein-ligand complexes. See this tutorial. We have added data folder to gmx_MMPBSA module. This folder contains the GLYCAM_06h-1 force field files (Compatible with amber99sb and early, see at http://glycam.org ) which is not in AmberTools. Fixes Minor bugs Changes We changed the notation of the force fields, now the user can define any force field (We have only tested Amber and GLYCAM force fields) available in AmberTools. Charmm is not yet supported. See this section gxm_MMPBSA first release \u00b6 This version includes: Compatibility with different Gromacs versions Support for all types of calculations available in MMPBSA.py Graphical user interface for results analysis (gmx_MMPBSA_ana) API modified to get more information Some new facilities and types of calculations","title":"Changelog"},{"location":"changelog/#changelog","text":"","title":"Changelog"},{"location":"changelog/#gmx_mmpbsa-v150-coming-soon","text":"","title":"gmx_MMPBSA v1.5.0 (coming soon...)"},{"location":"changelog/#additions","text":"","title":"Additions"},{"location":"changelog/#gmx_mmpbsa","text":"Option to create an input file ( --create_input ) New format file (h5) to store all the data result enabled NonLinear PB solver in sander ( #63 ) enabled all pbsa options in sander ( #64 ) enabled all 3D-RISM variables ( #68 ) Improve IE output data ( #91 ) New C2 Entropy method added ( #73 ) New method to get the decomp data without the API classes","title":"gmx_MMPBSA"},{"location":"changelog/#gmx_mmpbsa_ana","text":"Chart properties selector. The following properties can be changed: Font size: Axes (Ticks, Labels) Title, Subtitle and legend Color bar Pallete, color or theme: Line plot Bar plot Heatmap plot PyMOL visualization Rotation, padding and number of ticks Figure size, dpi and format Chart type specific properties Highlight or split components Frame range and interval selection Chart data can be visualized in table format and copy directly to excel Now the outputs files can be visualized as document in their own sub-window New button to launch all the graphics and functions associated to item Highlighted Bar and Heatmap plot User setting file per-system","title":"gmx_MMPBSA_ana"},{"location":"changelog/#documentation","text":"Code block names and annotations Input and Output file pages","title":"Documentation"},{"location":"changelog/#fixes","text":"","title":"Fixes"},{"location":"changelog/#gmx_mmpbsa_1","text":"Issue with protonated residues print_res selection Error when startframe=0 ( #66 ) parmchk2 always uses GAFF as force field ( #45 ) Now IE is calculated for PB and GB independently ( #72 ) Issue with alanine scanning CHARMM ff ( #88 ) Issue with MT approach ( #78 ) get_num_terms function run forever if TDC term not found. ( #98 ) Check if the groups defined for receptor and ligand are the same ( #86 ) Standard deviation calculation. This error comes from the original version of MMPBSA.py ( #105 ) Structure consistency ( #80 , #79 ) Now gmx_MMPBSA launches an error when there is an OverflowError on IE calculation ( #57 ) Improve gmx_MMPBSA .log file ( #108 ) Inconsistency with multiple trajectories ( #120 )","title":"gmx_MMPBSA"},{"location":"changelog/#gmx_mmpbsa_ana_1","text":"Tick labels in line plots ( #65 ) Improved PyMOL 3D visualization ( #85 ) Improved the system options in the init dialog","title":"gmx_MMPBSA_ana"},{"location":"changelog/#gmx_mmpbsa_test","text":"Error when -f option it not defined ( #46 )","title":"gmx_MMPBSA_test"},{"location":"changelog/#changes","text":"","title":"Changes"},{"location":"changelog/#gmx_mmpbsa_2","text":"Removed deprecate variables EnergyVector changed to ndarray subclass Regen expression for mutant_res Now the COM, REC and LIG trajectories must have the same length when MT approach Improved verbose logging Removed *.gro file support in -cs , -rs and -ls flags Added trjconv to avoid the PBC in the tpr file ( #43 )","title":"gmx_MMPBSA"},{"location":"changelog/#gmx_mmpbsa_ana_2","text":"New set of chart buttons IE plot","title":"gmx_MMPBSA_ana"},{"location":"changelog/#gmx_mmpbsa_test_1","text":"Improved parallel processing","title":"gmx_MMPBSA_test"},{"location":"changelog/#documentation_1","text":"Updated packages dependency","title":"Documentation"},{"location":"changelog/#gxm_mmpbsa-v143-26052021","text":"","title":"gxm_MMPBSA v1.4.3 (26/05/2021)"},{"location":"changelog/#additions_1","text":"Added two new tutorials Protein_ligand_LPH_atoms_CHARMMff and QM/MMGBSA calculations Now the program reports the p-value associated with the correlation coefficient when performing the correlation analysis Google Analytics is used as a third-party tracking service to improve documentation. Check our Private Policy for more details","title":"Additions"},{"location":"changelog/#fixes_1","text":"Minor fixes in the documentation Improved parsing of forcefields variable Fixed bug when gmx_MMPBSA_ana runs without arguments Fixed compatibility with older files ( < v1.4.0 ) Fixed error when debug_printlevel > 1 in tleap command","title":"Fixes"},{"location":"changelog/#changes_1","text":"Now the command line used is added to the log file The gmx_MMPBSA data folder is exported directly rather than copied in the $AMBERHOME data folder.","title":"Changes"},{"location":"changelog/#gxm_mmpbsa-v142-01052021","text":"","title":"gxm_MMPBSA v1.4.2 (01/05/2021)"},{"location":"changelog/#additions_2","text":"Added Covid-19 and other complex systems as examples in the documentation Added Q&A section to the documentation Implemented an adaptive intdiel (GB)/ indi (PB) for Alanine scanning (Check the input file section)","title":"Additions"},{"location":"changelog/#fixes_2","text":"Fixed bug when startframe = 0 ( #33 ) Fixed bug when blank lines exist in [molecule] section in topology file Fixed pipe command-line for Gromacs execution in macOS Fixed compatibility issues with v1.3.x Improved and fixed the documentation Improved output file information related to \u0394G binding Improved calculation with different entropy approximations simultaneously","title":"Fixes"},{"location":"changelog/#changes_2","text":"Changed protein_forcefields and ligand_forcefield by forcefields variable in all examples Now QH and IE can be calculated at the same time entropy variable was separated in qh_entropy and interaction_entropy . The entropy variable is deprecated and will be removed in the next major version (v1.5.0). entropy_seg was replaced by ie_segment . The entropy_seg variable is deprecated and will be removed in the next major version (v1.5.0).","title":"Changes"},{"location":"changelog/#gxm_mmpbsa-v141-08042021","text":"Additions New class Residue added to handle residues selection in Gromacs format with Amber index Verification of the presence of water molecules in receptor and ligand groups Gromacs timer added Fixes Gromacs topology conversion qm_residues notation Default path in gmx_MMPBSA_test The Entropy representation in gmx_MMPBSA_ana Bug when the structure has insertion code Improved \u0394G Binding plot representation Changes Now forcefields variable unifies protein_forcefield and ligand_forcefield . These variables protein_forcefield and ligand_forcefield are deprecated and will be removed in the next major version (v1.5.0). Improved documentation Examples Command-line MPI Examples Links and references Updated to material 7.1.0 Dark mode Material \"Back to Top\" button Grammatical corrections Installation section Figures caption The Ambiguous name for Entropy term in output files","title":"gxm_MMPBSA v1.4.1 (08/04/2021)"},{"location":"changelog/#gxm_mmpbsa-v140-22032021","text":"This release focuses almost entirely on gmx_MMPBSA_ana with minor issues fixed in gmx_MMPBSA Additions New start window to select options Option to make correlation (Pearson and Spearman coefficients) Option to hide decomposition data Option to not compute charts with a non-significant contribution Option to not include terms with a non-significant contribution in bar charts Selection of the components to display in addition to Delta (i.e. complex, receptor, and ligand) Toggle the chart toolbar for a cleaner visualization An informative table with selected systems data Option to exclude any system Option to change: The system name The experimental Ki for correlation The temperature to calculate the Experimental Energy and the Interaction Entropy Data reader with progress bar and multiprocessing Multiple systems to analyze in the same session Correlation dock Multiple models at the same time Graphs and correlation data for each calculated energy term (\u0394H, \u0394H+IE, \u0394H+NMODE and \u0394H+QH) Table with the experimental energy of the systems, and the data of the selected model New arguments flags for gmx_MMPBSA_ana (See the gmx_MMPBSA_ana documentation ) replaced -p by -f -f accept a folder, single info file or a list of them New flag -r . This flag allows to load all the systems inside a selected folder New graphical options A new set of graphics (heatmap) Per-frame when analyzing Per-residue and pair in Per-wise Relation matrix for Per-wise Interactive visualization of PDB files with per-residue energies with PyMOL (up to 5 instances). Regression plot for correlation Plot features Added Standard deviation to bar plots Added rolling average to line plots Added indicators for the selected interval and average value in IE chart Added crosshair cursor for better analysis on charts Multiprocessing application for testing ( gmx_MMPBSA_test ) Embed Youtube videos for gmx_MMPBSA_ana Fixes Now gmx_MMPBSA_ana shows stability results as expected Errors in the documentation MPI Changes Converted analyzer.py into a sub-module for more flexibility, organization and portability Residues notation for mutation: CHAIN:RESNAME:RESNUMBER:ICODE instead of Amber residue index Improve the selection method in decomposition calculation Replaced variable entropy_temp (deprecated) by temperature IE in API Color Palette used in graphs Use seaborn and matplotlib for charts Use Pandas Dataframe and numpy to store data Changed the data structure to implement dynamic selection of frames in future versions Improved data export: now any item can be exported as CSV file Improved the documentation Improve examples documentation Added changelog button at home Separated changelog in a new header Added tags to mark the history of changes of variables and functionalities","title":"gxm_MMPBSA v1.4.0 (22/03/2021)"},{"location":"changelog/#gxm_mmpbsa-v133-09032021","text":"Fixes fixed Boltzmann constant for IE fix mutation in ligand fixed analyzer error when interval > 1 fixed residue selection within fixed ChainID assignation when reference structure is defined fixed the selection to print when decomposition","title":"gxm_MMPBSA v1.3.3 (09/03/2021)"},{"location":"changelog/#gxm_mmpbsa-v132-01032021","text":"Additions Now, gmx_MMPBSA is in Zenodo . You can refer to us in this way in what we publish the article Added Interaction Entropy to gmx_MMPBSA output file Added a new class to save IE in a csv file Added \"Go to Top\" button to documentation HTML. Fixes Error when ligand and/or receptor are discontinuous (Testing it) Error when ligand and/or receptor are discontinuous and numbered non-consecutively Non-critical errors and inconsistencies in documentation Changes receptor_mask and ligand_mask have been removed from input file variables. Now we extract the amber mask directly based on the GROMACS index file The receptor and ligand mapping in the complex was improved. Now we use a method based on the GROMACS index file The method Map of the system_MMPBSA class has been restructured. Now always processes amber masks Changing the IE calculation function to a class","title":"gxm_MMPBSA v1.3.2 (01/03/2021)"},{"location":"changelog/#gmx_mmpbsa-v131","text":"Additions New variable ( overwrite_data ) to overwrite gmx_MMPBSA data. More informative message when sander fail. Useful for PB calculation Fixes Protein-ligand with charmm force field example Stability calculation gmx path error leaprc.GLYCAM_06h-1 file Protein-glycan example Changes Documentation banner","title":"gmx_MMPBSA-v1.3.1"},{"location":"changelog/#gmx_mmpbsa-v130","text":"Additions Documentation at Github pages Charmm force field support Amber topology generation from GROMACS topology. Work for Charmm and Amber force fields New flag for topologies ( -cp , -rp and -lp ) added Now gmx_MMPBSA supports discontinuous receptor and ligand. Glycine scanning Autocompletion script for both gmx_MMPBSA and gmx_MMPBSA_ana Versioneer to control the semantic version. Argument type checker for the command-line Fixes Alanine scanning tutorial GROMACS executable path The -gui option has been changed by -nogui and fixed when it is defined Improvement on documentation Changes Documentation theme. Now we use Material Alanine scanning variable. Now mutant correspond to mutant amino acid (ALA and GLY) The gmx_MMPBSA_gui was changed by gmx_MMPBSA_ana Improvement on the topologies construction process Order in which the trajectories are cleaned. Now, the topology is built and finally, the trajectories are cleaned","title":"gmx_MMPBSA-v1.3.0"},{"location":"changelog/#gmx_mmpbsa-v120","text":"Additions New ligand force field (Zwitterionic amino acids) A new flag (-cr) added for defining a reference structure (guarantee a better consistency in generated PDB files) API documentation Fixes More comprehensive output log file Best handling of structure files Changes gmx editconf is used to generate PDB files instead of gmx trjconv ( #14 ) gmx_MMPBSA data is copied in AMBER as an independent folder *.gro files can be used as a MD Structure+mass(db) file Updated tutorial list in README (Protein_DNA_RNA_Ion_ligand BFE calculations)","title":"gmx_MMPBSA v1.2.0"},{"location":"changelog/#gmx_mmpbsa-v111","text":"Additions New tutorial added (see Protein_DNA_RNA_Ion_ligand tutorial) Fixes Support various metallo-complexes formats Changes Keep all the temporary files in the folder for debugging purposes","title":"gmx_MMPBSA v1.1.1"},{"location":"changelog/#gxm_mmpbsa-v110","text":"Additions Now supports carbohydrates as ligand. See this tutorial Now supports metalloprotein-ligand complexes. See this tutorial. We have added data folder to gmx_MMPBSA module. This folder contains the GLYCAM_06h-1 force field files (Compatible with amber99sb and early, see at http://glycam.org ) which is not in AmberTools. Fixes Minor bugs Changes We changed the notation of the force fields, now the user can define any force field (We have only tested Amber and GLYCAM force fields) available in AmberTools. Charmm is not yet supported. See this section","title":"gxm_MMPBSA v.1.1.0"},{"location":"changelog/#gxm_mmpbsa-first-release","text":"This version includes: Compatibility with different Gromacs versions Support for all types of calculations available in MMPBSA.py Graphical user interface for results analysis (gmx_MMPBSA_ana) API modified to get more information Some new facilities and types of calculations","title":"gxm_MMPBSA first release"},{"location":"cite_us/","text":"Vald\u00e9s-Tresanco, M.S., Vald\u00e9s-Tresanco, M.E., Valiente, P.A. and Moreno E. gmx_MMPBSA: A New Tool to Perform End-State Free Energy Calculations with GROMACS . Journal of Chemical Theory and Computation , 2021 17 (10), 6281-6291. https://pubs.acs.org/doi/10.1021/acs.jctc.1c00645 . Download | *.bib | *.ris Please also consider citing MMPBSA.py's paper: Bill R. Miller, T. Dwight McGee, Jason M. Swails, Nadine Homeyer, Holger Gohlke, and Adrian E. Roitberg. MMPBSA. py: An Efficient Program for End-State Free Energy Calculations . Journal of Chemical Theory and Computation , 2012 8 (9), 3314-3321. https://pubs.acs.org/doi/10.1021/ct300418h . Download | *.bib | *.ris | *.xml Example \u00b6 Important This does not constitute by any means the only way to cite gmx_MMPBSA and programs/methods implemented in it. It is just meant to serve as a guidance. Here there is an example on how to cite gmx_MMPBSA and programs/methods implemented in it: MM/GBSA calculations PBC conditions were removed from GROMACS output trajectory before running the calculations with gmx_MMPBSA. 1 , 2 Energetically relevant residues within 5 \u00c5 at the interface were predicted using the per-residue effective free energy decomposition (prEFED) protocol. 3 The AMBER99SB force field 5 was used to calculate the internal term (\u0394E int ) as well as van der Waals (\u0394E vdW ) and electrostatic (\u0394E ele ) energies. The GB-Neck2 model (igb = 8) 6 was used to estimate the polar component of the solvation energy (\u0394G GB ) while the non-polar solvation free energy (\u2206\ud835\udc3a \ud835\udc46\ud835\udc34 ) was obtained by the equation: \u2206\ud835\udc3a \ud835\udc46\ud835\udc34 = \ud835\udefe \u00b7 \u2206\ud835\udc46\ud835\udc34\ud835\udc46\ud835\udc34 + \ud835\udefd where \u2206\ud835\udc46\ud835\udc34\ud835\udc46\ud835\udc34 represents the solvent-accessible surface area variation of the solute molecule upon complex formation, and \ud835\udefe and \ud835\udefd are empiric constants whose values for GB models are 0.0072 kcal\u00b7\u00c5 -2 \u00b7mol -1 and 0, respectively. 7 , 8 The entropic term was calculated by the Interaction Entropy method. 9 The input file for gmx_MMPBSA decomposition calculation is shown below: ============================ Sample input file with decomposition analysis &general startframe=1750, endframe=2400, interval=1, PBRadii=4, forcefields=\"oldff/leaprc.ff99SB\" / &gb igb=8, saltcon=0.150, intdiel=5, / &decomp idecomp=2, dec_verbose=3, print_res=\"within 5\" ============================ Computational alanine scanning 10 was performed for five residues (TP62, EP68, EP70, HP76, and EP83) with a specific internal dielectric constant as suggested by Yan et al. 11 and according to the chemical-physical properties of the mutated amino acid (i.e., e i = 5 for charged residues; e i = 3 for polar residues; and e i = 1 for hydrophobic residues). An example of the input file for gmx_MMPBSA alanine scanning (EP68 residue) calculation is shown below: ============================ Sample input file for alanine scanning analysis &general startframe=1750, endframe=2400, interval=1, PBRadii=4, forcefields=\"oldff/leaprc.ff99SB\", interaction_entropy=1, ie_segment=25, temperature=298 / &gb igb=8, saltcon=0.150, / &alanine_scanning mutant='ALA', mutant_res='C:68', cas_intdiel=1 / ============================ Authors \u00b6 Mario Sergio Vald\u00e9s Tresanco, PhD Student. University of Medellin, Colombia Mario Ernesto Vald\u00e9s Tresanco, PhD Student. University of Calgary, Canada. Pedro Alberto Valiente, PhD. University of Toronto, Canada Ernesto Moreno Fr\u00edas, PhD. University of Medellin, Colombia","title":"Cite us"},{"location":"cite_us/#example","text":"Important This does not constitute by any means the only way to cite gmx_MMPBSA and programs/methods implemented in it. It is just meant to serve as a guidance. Here there is an example on how to cite gmx_MMPBSA and programs/methods implemented in it: MM/GBSA calculations PBC conditions were removed from GROMACS output trajectory before running the calculations with gmx_MMPBSA. 1 , 2 Energetically relevant residues within 5 \u00c5 at the interface were predicted using the per-residue effective free energy decomposition (prEFED) protocol. 3 The AMBER99SB force field 5 was used to calculate the internal term (\u0394E int ) as well as van der Waals (\u0394E vdW ) and electrostatic (\u0394E ele ) energies. The GB-Neck2 model (igb = 8) 6 was used to estimate the polar component of the solvation energy (\u0394G GB ) while the non-polar solvation free energy (\u2206\ud835\udc3a \ud835\udc46\ud835\udc34 ) was obtained by the equation: \u2206\ud835\udc3a \ud835\udc46\ud835\udc34 = \ud835\udefe \u00b7 \u2206\ud835\udc46\ud835\udc34\ud835\udc46\ud835\udc34 + \ud835\udefd where \u2206\ud835\udc46\ud835\udc34\ud835\udc46\ud835\udc34 represents the solvent-accessible surface area variation of the solute molecule upon complex formation, and \ud835\udefe and \ud835\udefd are empiric constants whose values for GB models are 0.0072 kcal\u00b7\u00c5 -2 \u00b7mol -1 and 0, respectively. 7 , 8 The entropic term was calculated by the Interaction Entropy method. 9 The input file for gmx_MMPBSA decomposition calculation is shown below: ============================ Sample input file with decomposition analysis &general startframe=1750, endframe=2400, interval=1, PBRadii=4, forcefields=\"oldff/leaprc.ff99SB\" / &gb igb=8, saltcon=0.150, intdiel=5, / &decomp idecomp=2, dec_verbose=3, print_res=\"within 5\" ============================ Computational alanine scanning 10 was performed for five residues (TP62, EP68, EP70, HP76, and EP83) with a specific internal dielectric constant as suggested by Yan et al. 11 and according to the chemical-physical properties of the mutated amino acid (i.e., e i = 5 for charged residues; e i = 3 for polar residues; and e i = 1 for hydrophobic residues). An example of the input file for gmx_MMPBSA alanine scanning (EP68 residue) calculation is shown below: ============================ Sample input file for alanine scanning analysis &general startframe=1750, endframe=2400, interval=1, PBRadii=4, forcefields=\"oldff/leaprc.ff99SB\", interaction_entropy=1, ie_segment=25, temperature=298 / &gb igb=8, saltcon=0.150, / &alanine_scanning mutant='ALA', mutant_res='C:68', cas_intdiel=1 / ============================","title":"Example"},{"location":"cite_us/#authors","text":"Mario Sergio Vald\u00e9s Tresanco, PhD Student. University of Medellin, Colombia Mario Ernesto Vald\u00e9s Tresanco, PhD Student. University of Calgary, Canada. Pedro Alberto Valiente, PhD. University of Toronto, Canada Ernesto Moreno Fr\u00edas, PhD. University of Medellin, Colombia","title":"Authors"},{"location":"command-line/","text":"gmx_MMPBSA applications command-line \u00b6 gmx_MMPBSA command-line \u00b6 gmx_MMPBSA is invoked through the command line as follows: $ gmx_MMPBSA -h usage: gmx_MMPBSA [-h] [-v] [--input-file-help] [--create_input [{gb,pb,rism,ala,decomp,nmode,all}] [-O] [-prefix <file prefix>] [-i FILE] [-xvvfile XVVFILE] [-o FILE] [-do FILE] [-eo FILE] [-deo FILE] [-nogui] [-s] [-cs <Structure File>] [-ci <Index File>] [-cg index index] [-ct [TRJ [TRJ ...]]] [-cp <Topology>] [-cr <PDB File>] [-rs <Structure File>] [-ri <Index File>] [-rg index] [-rt [TRJ [TRJ ...]]] [-rp <Topology>] [-lm <Structure File>] [-ls <Structure File>] [-li <Index File>] [-lg index] [-lt [TRJ [TRJ ...]]] [-lp <Topology>] [--rewrite-output] [--clean] gmx_MMPBSA is a new tool based on AMBER's MMPBSA.py aiming to perform end-state free energy calculations with GROMACS files. This program is an adaptation of Amber's MMPBSA.py and essentially works as such. gmx_MMPBSA works with any GROMACS version. This program will calculate binding free energies using end-state free energy methods on an ensemble of snapshots using a variety of implicit solvent models. This is the core of gmx_MMPBSA and it will do all the calculations optional arguments: -h, --help show this help message and exit -v, --version show program's version number and exit --input-file-help Print all available options in the input file. (default: False) --create_input Create an new input file with selected calculation type. (default: None) [{gb,pb,rism,ala,decomp,nmode,all}] Miscellaneous Options: -O, --overwrite Allow output files to be overwritten (default: False) -prefix <file prefix> Prefix for intermediate files. (default: _GMXMMPBSA_) Input and Output Files: These options specify the input files and optional output files. -i FILE MM/PBSA input file. (default: None) -xvvfile XVVFILE XVV file for 3D-RISM. (default: /home/mario/programs/amber20/dat/mmpbsa/spc.xvv) -o FILE Output file with MM/PBSA statistics. (default: FINAL_RESULTS_MMPBSA.dat) -do FILE Output file for decomposition statistics summary. (default: FINAL_DECOMP_MMPBSA.dat) -eo FILE CSV-format output of all energy terms for every frame in every calculation. File name forced to end in [.csv]. This file is only written when specified on the command-line. (default: None) -deo FILE CSV-format output of all energy terms for each printed residue in decomposition calculations. File name forced to end in [.csv]. This file is only written when specified on the command-line. (default: None) -nogui No open gmx_MMPBSA_ana after all calculations finished (default: True) -s, --stability Perform stability calculation. Only the complex parameters are required. Only If the ligand is non-Protein (small molecule) type and you not define a complex topology, then ligand *.mol2 file is required. In any other case receptor and ligand parameters will be ignored. See description bellow (default: False) Complex: Complex files and info that are needed to perform the calculation. If the receptor and/or the ligand info is not defined, we generate them from that of the complex. -cs <Structure File> Structure file of the complex. If it is Protein-Ligand (small molecule) complex and -cp is not defined, make sure that you define -lm option. See -lm description below Allowed formats: *.tpr (recommended), *.pdb, *.gro (default: None) -ci <Index File> Index file of the bound complex. (default: None) -cg index index Groups of receptor and ligand in complex index file. The notation is as follows: \"-cg <Receptor group> <Ligand group>\", ie. -cg 1 13 (default: None) -ct [TRJ [TRJ ...]] Complex trajectories. Make sure the trajectory is fitted and pbc have been removed. Allowed formats: *.xtc (recommended), *.trr, *.pdb (specify as many as you'd like). (default: None) -cp <Topology> The complex Topology file. When it is defined -lm option is not needed (default: None) -cr <PDB File> Complex Reference Structure file. This option is optional but recommended (Use the PDB file used to generate the topology in GROMACS). If not defined, the chains ID assignment (if the structure used in -cs does not have chain IDs) will be done automatically according to the structure (can generate wrong mapping). (default: None) Receptor: Receptor files and info that are needed to perform the calculation. If the receptor info is not defined, we generate it from that of the complex. -rs <Structure File> Structure file of the unbound receptor for multiple trajectory approach. Allowed formats: *.tpr (recommended), *.pdb, *.gro (default: None) -ri <Index File> Index file of the unbound receptor. (default: None) -rg index Receptor group in receptor index file. Notation: \"-lg <Receptor group>\", e.g. -rg 1 (default: None) -rt [TRJ [TRJ ...]] Input trajectories of the unbound receptor for multiple trajectory approach. Allowed formats: *.xtc (recommended), *.trr, *.pdb, *.gro (specify as many as you'd like). (default: None) -rp <Topology> Topology file of the receptor. (default: None) Ligand: Ligand files and info that are needed to perform the calculation. If the ligand are not defined, we generate it from that of the complex. -lm <Structure File> A *.mol2 file of the unbound ligand used to parametrize ligand for GROMACS using Antechamber. Must be defined if Protein-Ligand (small molecule) complex was define and -cp or -lp option are not defined. No needed for Proteins, DNA, RNA, Ions, Glycans or any ligand parametrized in the Amber force fields. Must be the Antechamber output *.mol2. (default: None) -ls <Structure File> Structure file of the unbound ligand. If ligand is a small molecule and -lp is not defined, make sure that you define above -lm option. Allowed formats: *.tpr (recommended), *.pdb, *.gro (default: None) -li <Index File> Index file of the unbound ligand. Only if tpr file was define in -ls. (default: None) -lg index Ligand group in ligand index file. Notation: \"-lg <Ligand group>\", e.g. -lg 13 (default: None) -lt [TRJ [TRJ ...]] Input trajectories of the unbound ligand for multiple trajectory approach. Allowed formats: *.xtc (recommended), *.trr, *.pdb, *.gro (specify as many as you'd like). (default: None) -lp <Topology> Topology file of the ligand. (default: None) Miscellaneous Actions: -rewrite-output Do not re-run any calculations, just parse the output files from the previous calculation and rewrite the output files. (default: False) --clean Clean temporary files and quit. (default: False) gmx_MMPBSA is an effort to implement the GB/PB and others calculations in GROMACS. Based on MMPBSA.py (version 16.0) and AmberTools20 Running gmx_MMPBSA \u00b6 Tip Since version 1.4.0 we have fixed the gmx_MMPBSA inconsistencies when using MPI . We currently recommend the use of MPI since the computation time decreases considerably. Parallel (MPI) version Serial version gmx_MMPBSA as MMPBSA.py uses the MPI only to perform the calculations during the dynamics, the rest of the process (Generation/conversion of Amber topologies, mutation, division of the trajectories, etc) occurs in a single thread (See Figure 1 1 for better reference). This means that it is not necessary to install any program (AmberTools or GROMACS) with MPI , which can be used in any circumstance, and the time required to process the data prior to the calculation depends on the system and will be the same for both versions ( Serial and MPI ). Note Note that gmx_MMPBSA processes, converts, or builds topologies from GROMACS files, so it takes slightly longer than MMPBSA.py at the same stage of the process. However, this is not really significant. Remember Make sure that you install the OpenMPI library sudo apt install openmpi-bin libopenmpi-dev openssh-client A usage example is shown below: Local HPC mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc #!/bin/sh #PBS -N nmode #PBS -o nmode.out #PBS -e nmode.err #PBS -m abe #PBS -M email@domain.edu #PBS -q brute #PBS -l nodes=1:surg:ppn=3 #PBS -l pmem=1450mb or > 5gb for nmode calculation cd $PBS_O_WORKDIR mpirun -np 3 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc > progress.log Danger Unfortunately, when gmx_MMPBSA is run with MPI , GROMACS's gmx_mpi is incompatible. This is probably because of gmx_mpi conflicts with mpirun. In any case, this is not a problem since gmx works correctly and gmx_mpi only parallels mdrun , the rest of the GROMACS tools work in a single thread. See this issue to see the output. Warning The nmode calculations require a considerable amount of RAM. Consider that the total amount of RAM will be: RAM total = RAM 1_frame * NUM of Threads If it consumes all the RAM of the system it can cause crashes, instability or system shutdown! Note At a certain level, running RISM in parallel may actually hurt performance, since previous solutions are used as an initial guess for the next frame, hastening convergence. Running in parallel loses this advantage. Also, due to the overhead involved in which each thread is required to load every topology file when calculating energies, parallel scaling will begin to fall off as the number of threads reaches the number of frames. This version is installed via pip as described above. AMBERHOME variable must be set, or it will quit with an error. An example command-line call is shown below: gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc You can found test files on GitHub Figure 1 . MPI benchmark description from MMPBSA.py paper . MMPBSA.py scaling comparison for MM-PBSA and MM-GBSA calculations on 200 frames of a 5910-atom complex. Times shown are the times required for the calculation to finish. Note that MM-GBSA calculations are \u223c5 times faster than MM-PBSA calculations. All calculations were performed on NICS Keeneland (2 Intel Westmere 6-core CPUs per node, QDR infiniband interconnect) gmx_MMPBSA_ana command-line \u00b6 $ gmx_MMPBSA_ana -h usage: run_ana.py [-h] [-v] [-f [FILES [FILES ...]]] [-r] This program is part of gmx_MMPBSA and will show a workspace to analyze the gmx_MMPBSA results optional arguments: -h, --help show this help message and exit -v, --version show program's version number and exit Info file: -f [FILES [FILES ...]], --files [FILES [FILES ...]] gmx_MMPBSA info files or container folder or list of them (default: [.] Current working dir) -r, --recursive Search recursively in this folder at depth = 1 (default: False) gmx_MMPBSA is an effort to implement the GB/PB and others calculations in GROMACS. Based on MMPBSA.py (version 16.0) and AmberTools20 Running gmx_MMPBSA_ana \u00b6 In order to analyze multiple systems in the same section and implement the correlation between them, we improved the file input to gmx_MMPBSA_ana. Currently, gmx_MMPBSA_ana supports info files, the folder that contains it or a list of them. Additionally, you can pass as input one or more folders containing multiple systems using recursive . The folders must be the following structure: Valid folder structure Valid folders + files structure Wrong folder structure Here all folders (5 systems) will be processed by gmx_MMPBSA_ana Defined folder \u251c\u2500\u2500 System-1 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-2 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-3 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-4 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u2514\u2500\u2500 System-5 \u2514\u2500\u2500 _GMXMMPBSA_info Here all systems (4) will be processed by gmx_MMPBSA_ana System-1 \u2514\u2500\u2500_GMXMMPBSA_info Folder-1 \u251c\u2500\u2500 System-2.1 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u2514\u2500\u2500 System-2.2 \u2514\u2500\u2500 _GMXMMPBSA_info System-3 (_GMXMMPBSA_info) The command-line for this is: gmx_MMPBSA_ana -f /path/to/System-1 /path/to/System-3/_GMXMMPBSA_info /path/to/Folder-1 -r This estructure only work if recursive option was defined. See the examples below Note that: System-1 is defined as folder that contain a _GMXMMPBSA_info Folder-1 contain two folder (Systems), each containing a _GMXMMPBSA_info System-3 is defined as a _GMXMMPBSA_info file Here only 4 (systems) folders will be processed by gmx_MMPBSA_ana. The systems in the Internal folder will be ignored Defined folder \u251c\u2500\u2500 System-1 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-2 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 Internal folder \u2502 \u251c\u2500X\u2500 System-3.1 \u2502 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u2502 \u2514\u2500X\u2500 System-3.2 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-4 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u2514\u2500\u2500 System-5 \u2514\u2500\u2500 _GMXMMPBSA_info Examples One file One folder Files + Folders Recursive option Passing a _GMXMMPBSA_info file as input: Current directory gmx_MMPBSA_ana -f _GMXMMPBSA_info other location Version: 1.4.0 gmx_MMPBSA_ana -f /path/to/_GMXMMPBSA_info Version: 1.4.0 Passing a folder as input: Current directory gmx_MMPBSA_ana -f . other location gmx_MMPBSA_ana -f /path/to/folder Remember This folder must contain a valid _GMXMMPBSA_info file Version: 1.4.0 gmx_MMPBSA_ana -f /path/to/folder-1 /path/to/_GMXMMPBSA_info-1 /path/to/folder-2 Remember All defined folders must contain a valid _GMXMMPBSA_info file All _GMXMMPBSA_info files defined must be valid Version: 1.4.0 Passing a folder as input with recursive option: Current directory gmx_MMPBSA_ana -f . -r other location gmx_MMPBSA_ana -f /path/to/folder --recursive combine multiple folders gmx_MMPBSA_ana -f /path/to/folder-1 /path/to/folder-2 /path/to/folder-3 -r Folders can contain one or more systems combine multiple folders and files gmx_MMPBSA_ana -f /path/to/folder-1 /path/to/_GMXMMPBSA_info-1 /path/to/folder-3 -r Folders can contain one or more systems Note that if you remove the option -r, each folder must contain a valid _GMXMMPBSA_info file. gmx_MMPBSA_test command-line \u00b6 $ gmx_MMPBSA_test -h usage: gmx_MMPBSA_test [-h] [-v] [-t [{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18} [{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18} ...]]] [-f FOLDER] [-r] [-ng] [-n NUM_PROCESSORS] This program is part of gmx_MMPBSA and will allow you to run various gmx_MMPBSA examples easily. optional arguments: -h, --help show this help message and exit -v, --version show program's version number and exit Test options: -t [{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18} [{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18} ...]] The level the test is going to be run at. Multiple systems and analysis can be run at the same time. Nr. of Sys * 0 16 All -- Run all examples (Can take a long time!!!) * 1 13 Minimal -- Does a minimal test with a set of systems and analyzes that show that gmx_MMPBSA runs correctly. Only exclude 3drism, nmode protein-ligand MT because take a long time or are redundant * 2 9 Fast -- Only the calculations that take a short time are run (Default) [Systems]: Slow Frames * 3 . | 10 Protein-Ligand (Single trajectory approximation) * 4 . | 10 Protein-Protein * 5 . | 10 Protein-DNA * 6 x | 4 Protein-Membrane * 7 . | 10 Protein-Glycan * 8 x | 4 Metalloprotein-Peptide * 9 . | 10 Protein-DNA-RNA-IONs-Ligand * 10 x | 4 Protein-Ligand (CHARMM force field) * 11 x | 4 Protein-ligand complex in membrane with CHARMMff [Analysis]: Slow Frames * 12 . | 10 Alanine Scanning * 13 . | 10 Stability calculation * 14 . | 10 Decomposition Analysis * 15 . | 16 Interaction Entropy approximation * 16 . | 10 Protein-Ligand (Multiple trajectory approximation) * 17 x | 4 Entropy calculation using Normal Mode approximation * 18 x | 4 Calculations using 3D-RISM approximation -f FOLDER, --folder FOLDER Defines the folder to store all data -r, --reuse Defines the existing test forlder will be reuse -ng, --nogui No open gmx_MMPBSA_ana after all calculations finished -n NUM_PROCESSORS, --num_processors NUM_PROCESSORS Defines the number of processor cores you want to use with MPI per calculation. If the number of frames is less than the number of cpus defined, the calculation will be performed with the number of processors = number of frames. gmx_MMPBSA is an effort to implement the GB/PB and others calculations in GROMACS. Based on MMPBSA.py (version 16.0) and AmberTools20 Running gmx_MMPBSA_test \u00b6 gmx_MMPBSA_test is designed to run a set of samples (all or minimal) or a specific example efficiently. Additionally, gmx_MMPBSA_test can run in parallel, decreasing the execution time gmx_MMPBSA_test will download the most recent version of the repository in the specified folder and will perform the calculations Minimal All Specific gmx_MMPBSA_test -f /home/user/Documents -n 10 [-t 2 is the default] Through this command-line, gmxMMPBSA_test will: Download gmx_MMPBSA repository content in /home/user/Documents Works with Fast set of examples Perform the calculation on 9 examples sequentially, using 10 cpus each time gmx_MMPBSA_test -f /home/user/Documents -t 0 -n 10 Through this command-line, gmxMMPBSA_test will: Download gmx_MMPBSA repository content in /home/user/Documents Works with All set of examples Perform the calculation on 16 examples sequentially, using 10 cpus each time gmx_MMPBSA_test -f /home/user/Documents -t 3 Through this command-line, gmxMMPBSA_test will: Download gmx_MMPBSA repository content in /home/user/Documents Execute 3 [Protein-Ligand (Single Trajectory approach)] example Taken from the MMPBSA.py paper \u21a9","title":"Command-line"},{"location":"command-line/#gmx_mmpbsa-applications-command-line","text":"","title":"gmx_MMPBSA applications command-line"},{"location":"command-line/#gmx_mmpbsa-command-line","text":"gmx_MMPBSA is invoked through the command line as follows: $ gmx_MMPBSA -h usage: gmx_MMPBSA [-h] [-v] [--input-file-help] [--create_input [{gb,pb,rism,ala,decomp,nmode,all}] [-O] [-prefix <file prefix>] [-i FILE] [-xvvfile XVVFILE] [-o FILE] [-do FILE] [-eo FILE] [-deo FILE] [-nogui] [-s] [-cs <Structure File>] [-ci <Index File>] [-cg index index] [-ct [TRJ [TRJ ...]]] [-cp <Topology>] [-cr <PDB File>] [-rs <Structure File>] [-ri <Index File>] [-rg index] [-rt [TRJ [TRJ ...]]] [-rp <Topology>] [-lm <Structure File>] [-ls <Structure File>] [-li <Index File>] [-lg index] [-lt [TRJ [TRJ ...]]] [-lp <Topology>] [--rewrite-output] [--clean] gmx_MMPBSA is a new tool based on AMBER's MMPBSA.py aiming to perform end-state free energy calculations with GROMACS files. This program is an adaptation of Amber's MMPBSA.py and essentially works as such. gmx_MMPBSA works with any GROMACS version. This program will calculate binding free energies using end-state free energy methods on an ensemble of snapshots using a variety of implicit solvent models. This is the core of gmx_MMPBSA and it will do all the calculations optional arguments: -h, --help show this help message and exit -v, --version show program's version number and exit --input-file-help Print all available options in the input file. (default: False) --create_input Create an new input file with selected calculation type. (default: None) [{gb,pb,rism,ala,decomp,nmode,all}] Miscellaneous Options: -O, --overwrite Allow output files to be overwritten (default: False) -prefix <file prefix> Prefix for intermediate files. (default: _GMXMMPBSA_) Input and Output Files: These options specify the input files and optional output files. -i FILE MM/PBSA input file. (default: None) -xvvfile XVVFILE XVV file for 3D-RISM. (default: /home/mario/programs/amber20/dat/mmpbsa/spc.xvv) -o FILE Output file with MM/PBSA statistics. (default: FINAL_RESULTS_MMPBSA.dat) -do FILE Output file for decomposition statistics summary. (default: FINAL_DECOMP_MMPBSA.dat) -eo FILE CSV-format output of all energy terms for every frame in every calculation. File name forced to end in [.csv]. This file is only written when specified on the command-line. (default: None) -deo FILE CSV-format output of all energy terms for each printed residue in decomposition calculations. File name forced to end in [.csv]. This file is only written when specified on the command-line. (default: None) -nogui No open gmx_MMPBSA_ana after all calculations finished (default: True) -s, --stability Perform stability calculation. Only the complex parameters are required. Only If the ligand is non-Protein (small molecule) type and you not define a complex topology, then ligand *.mol2 file is required. In any other case receptor and ligand parameters will be ignored. See description bellow (default: False) Complex: Complex files and info that are needed to perform the calculation. If the receptor and/or the ligand info is not defined, we generate them from that of the complex. -cs <Structure File> Structure file of the complex. If it is Protein-Ligand (small molecule) complex and -cp is not defined, make sure that you define -lm option. See -lm description below Allowed formats: *.tpr (recommended), *.pdb, *.gro (default: None) -ci <Index File> Index file of the bound complex. (default: None) -cg index index Groups of receptor and ligand in complex index file. The notation is as follows: \"-cg <Receptor group> <Ligand group>\", ie. -cg 1 13 (default: None) -ct [TRJ [TRJ ...]] Complex trajectories. Make sure the trajectory is fitted and pbc have been removed. Allowed formats: *.xtc (recommended), *.trr, *.pdb (specify as many as you'd like). (default: None) -cp <Topology> The complex Topology file. When it is defined -lm option is not needed (default: None) -cr <PDB File> Complex Reference Structure file. This option is optional but recommended (Use the PDB file used to generate the topology in GROMACS). If not defined, the chains ID assignment (if the structure used in -cs does not have chain IDs) will be done automatically according to the structure (can generate wrong mapping). (default: None) Receptor: Receptor files and info that are needed to perform the calculation. If the receptor info is not defined, we generate it from that of the complex. -rs <Structure File> Structure file of the unbound receptor for multiple trajectory approach. Allowed formats: *.tpr (recommended), *.pdb, *.gro (default: None) -ri <Index File> Index file of the unbound receptor. (default: None) -rg index Receptor group in receptor index file. Notation: \"-lg <Receptor group>\", e.g. -rg 1 (default: None) -rt [TRJ [TRJ ...]] Input trajectories of the unbound receptor for multiple trajectory approach. Allowed formats: *.xtc (recommended), *.trr, *.pdb, *.gro (specify as many as you'd like). (default: None) -rp <Topology> Topology file of the receptor. (default: None) Ligand: Ligand files and info that are needed to perform the calculation. If the ligand are not defined, we generate it from that of the complex. -lm <Structure File> A *.mol2 file of the unbound ligand used to parametrize ligand for GROMACS using Antechamber. Must be defined if Protein-Ligand (small molecule) complex was define and -cp or -lp option are not defined. No needed for Proteins, DNA, RNA, Ions, Glycans or any ligand parametrized in the Amber force fields. Must be the Antechamber output *.mol2. (default: None) -ls <Structure File> Structure file of the unbound ligand. If ligand is a small molecule and -lp is not defined, make sure that you define above -lm option. Allowed formats: *.tpr (recommended), *.pdb, *.gro (default: None) -li <Index File> Index file of the unbound ligand. Only if tpr file was define in -ls. (default: None) -lg index Ligand group in ligand index file. Notation: \"-lg <Ligand group>\", e.g. -lg 13 (default: None) -lt [TRJ [TRJ ...]] Input trajectories of the unbound ligand for multiple trajectory approach. Allowed formats: *.xtc (recommended), *.trr, *.pdb, *.gro (specify as many as you'd like). (default: None) -lp <Topology> Topology file of the ligand. (default: None) Miscellaneous Actions: -rewrite-output Do not re-run any calculations, just parse the output files from the previous calculation and rewrite the output files. (default: False) --clean Clean temporary files and quit. (default: False) gmx_MMPBSA is an effort to implement the GB/PB and others calculations in GROMACS. Based on MMPBSA.py (version 16.0) and AmberTools20","title":"gmx_MMPBSA command-line"},{"location":"command-line/#running-gmx_mmpbsa","text":"Tip Since version 1.4.0 we have fixed the gmx_MMPBSA inconsistencies when using MPI . We currently recommend the use of MPI since the computation time decreases considerably. Parallel (MPI) version Serial version gmx_MMPBSA as MMPBSA.py uses the MPI only to perform the calculations during the dynamics, the rest of the process (Generation/conversion of Amber topologies, mutation, division of the trajectories, etc) occurs in a single thread (See Figure 1 1 for better reference). This means that it is not necessary to install any program (AmberTools or GROMACS) with MPI , which can be used in any circumstance, and the time required to process the data prior to the calculation depends on the system and will be the same for both versions ( Serial and MPI ). Note Note that gmx_MMPBSA processes, converts, or builds topologies from GROMACS files, so it takes slightly longer than MMPBSA.py at the same stage of the process. However, this is not really significant. Remember Make sure that you install the OpenMPI library sudo apt install openmpi-bin libopenmpi-dev openssh-client A usage example is shown below: Local HPC mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc #!/bin/sh #PBS -N nmode #PBS -o nmode.out #PBS -e nmode.err #PBS -m abe #PBS -M email@domain.edu #PBS -q brute #PBS -l nodes=1:surg:ppn=3 #PBS -l pmem=1450mb or > 5gb for nmode calculation cd $PBS_O_WORKDIR mpirun -np 3 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc > progress.log Danger Unfortunately, when gmx_MMPBSA is run with MPI , GROMACS's gmx_mpi is incompatible. This is probably because of gmx_mpi conflicts with mpirun. In any case, this is not a problem since gmx works correctly and gmx_mpi only parallels mdrun , the rest of the GROMACS tools work in a single thread. See this issue to see the output. Warning The nmode calculations require a considerable amount of RAM. Consider that the total amount of RAM will be: RAM total = RAM 1_frame * NUM of Threads If it consumes all the RAM of the system it can cause crashes, instability or system shutdown! Note At a certain level, running RISM in parallel may actually hurt performance, since previous solutions are used as an initial guess for the next frame, hastening convergence. Running in parallel loses this advantage. Also, due to the overhead involved in which each thread is required to load every topology file when calculating energies, parallel scaling will begin to fall off as the number of threads reaches the number of frames. This version is installed via pip as described above. AMBERHOME variable must be set, or it will quit with an error. An example command-line call is shown below: gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc You can found test files on GitHub Figure 1 . MPI benchmark description from MMPBSA.py paper . MMPBSA.py scaling comparison for MM-PBSA and MM-GBSA calculations on 200 frames of a 5910-atom complex. Times shown are the times required for the calculation to finish. Note that MM-GBSA calculations are \u223c5 times faster than MM-PBSA calculations. All calculations were performed on NICS Keeneland (2 Intel Westmere 6-core CPUs per node, QDR infiniband interconnect)","title":"Running gmx_MMPBSA"},{"location":"command-line/#gmx_mmpbsa_ana-command-line","text":"$ gmx_MMPBSA_ana -h usage: run_ana.py [-h] [-v] [-f [FILES [FILES ...]]] [-r] This program is part of gmx_MMPBSA and will show a workspace to analyze the gmx_MMPBSA results optional arguments: -h, --help show this help message and exit -v, --version show program's version number and exit Info file: -f [FILES [FILES ...]], --files [FILES [FILES ...]] gmx_MMPBSA info files or container folder or list of them (default: [.] Current working dir) -r, --recursive Search recursively in this folder at depth = 1 (default: False) gmx_MMPBSA is an effort to implement the GB/PB and others calculations in GROMACS. Based on MMPBSA.py (version 16.0) and AmberTools20","title":"gmx_MMPBSA_ana command-line"},{"location":"command-line/#running-gmx_mmpbsa_ana","text":"In order to analyze multiple systems in the same section and implement the correlation between them, we improved the file input to gmx_MMPBSA_ana. Currently, gmx_MMPBSA_ana supports info files, the folder that contains it or a list of them. Additionally, you can pass as input one or more folders containing multiple systems using recursive . The folders must be the following structure: Valid folder structure Valid folders + files structure Wrong folder structure Here all folders (5 systems) will be processed by gmx_MMPBSA_ana Defined folder \u251c\u2500\u2500 System-1 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-2 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-3 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-4 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u2514\u2500\u2500 System-5 \u2514\u2500\u2500 _GMXMMPBSA_info Here all systems (4) will be processed by gmx_MMPBSA_ana System-1 \u2514\u2500\u2500_GMXMMPBSA_info Folder-1 \u251c\u2500\u2500 System-2.1 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u2514\u2500\u2500 System-2.2 \u2514\u2500\u2500 _GMXMMPBSA_info System-3 (_GMXMMPBSA_info) The command-line for this is: gmx_MMPBSA_ana -f /path/to/System-1 /path/to/System-3/_GMXMMPBSA_info /path/to/Folder-1 -r This estructure only work if recursive option was defined. See the examples below Note that: System-1 is defined as folder that contain a _GMXMMPBSA_info Folder-1 contain two folder (Systems), each containing a _GMXMMPBSA_info System-3 is defined as a _GMXMMPBSA_info file Here only 4 (systems) folders will be processed by gmx_MMPBSA_ana. The systems in the Internal folder will be ignored Defined folder \u251c\u2500\u2500 System-1 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-2 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 Internal folder \u2502 \u251c\u2500X\u2500 System-3.1 \u2502 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u2502 \u2514\u2500X\u2500 System-3.2 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-4 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u2514\u2500\u2500 System-5 \u2514\u2500\u2500 _GMXMMPBSA_info Examples One file One folder Files + Folders Recursive option Passing a _GMXMMPBSA_info file as input: Current directory gmx_MMPBSA_ana -f _GMXMMPBSA_info other location Version: 1.4.0 gmx_MMPBSA_ana -f /path/to/_GMXMMPBSA_info Version: 1.4.0 Passing a folder as input: Current directory gmx_MMPBSA_ana -f . other location gmx_MMPBSA_ana -f /path/to/folder Remember This folder must contain a valid _GMXMMPBSA_info file Version: 1.4.0 gmx_MMPBSA_ana -f /path/to/folder-1 /path/to/_GMXMMPBSA_info-1 /path/to/folder-2 Remember All defined folders must contain a valid _GMXMMPBSA_info file All _GMXMMPBSA_info files defined must be valid Version: 1.4.0 Passing a folder as input with recursive option: Current directory gmx_MMPBSA_ana -f . -r other location gmx_MMPBSA_ana -f /path/to/folder --recursive combine multiple folders gmx_MMPBSA_ana -f /path/to/folder-1 /path/to/folder-2 /path/to/folder-3 -r Folders can contain one or more systems combine multiple folders and files gmx_MMPBSA_ana -f /path/to/folder-1 /path/to/_GMXMMPBSA_info-1 /path/to/folder-3 -r Folders can contain one or more systems Note that if you remove the option -r, each folder must contain a valid _GMXMMPBSA_info file.","title":"Running gmx_MMPBSA_ana"},{"location":"command-line/#gmx_mmpbsa_test-command-line","text":"$ gmx_MMPBSA_test -h usage: gmx_MMPBSA_test [-h] [-v] [-t [{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18} [{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18} ...]]] [-f FOLDER] [-r] [-ng] [-n NUM_PROCESSORS] This program is part of gmx_MMPBSA and will allow you to run various gmx_MMPBSA examples easily. optional arguments: -h, --help show this help message and exit -v, --version show program's version number and exit Test options: -t [{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18} [{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18} ...]] The level the test is going to be run at. Multiple systems and analysis can be run at the same time. Nr. of Sys * 0 16 All -- Run all examples (Can take a long time!!!) * 1 13 Minimal -- Does a minimal test with a set of systems and analyzes that show that gmx_MMPBSA runs correctly. Only exclude 3drism, nmode protein-ligand MT because take a long time or are redundant * 2 9 Fast -- Only the calculations that take a short time are run (Default) [Systems]: Slow Frames * 3 . | 10 Protein-Ligand (Single trajectory approximation) * 4 . | 10 Protein-Protein * 5 . | 10 Protein-DNA * 6 x | 4 Protein-Membrane * 7 . | 10 Protein-Glycan * 8 x | 4 Metalloprotein-Peptide * 9 . | 10 Protein-DNA-RNA-IONs-Ligand * 10 x | 4 Protein-Ligand (CHARMM force field) * 11 x | 4 Protein-ligand complex in membrane with CHARMMff [Analysis]: Slow Frames * 12 . | 10 Alanine Scanning * 13 . | 10 Stability calculation * 14 . | 10 Decomposition Analysis * 15 . | 16 Interaction Entropy approximation * 16 . | 10 Protein-Ligand (Multiple trajectory approximation) * 17 x | 4 Entropy calculation using Normal Mode approximation * 18 x | 4 Calculations using 3D-RISM approximation -f FOLDER, --folder FOLDER Defines the folder to store all data -r, --reuse Defines the existing test forlder will be reuse -ng, --nogui No open gmx_MMPBSA_ana after all calculations finished -n NUM_PROCESSORS, --num_processors NUM_PROCESSORS Defines the number of processor cores you want to use with MPI per calculation. If the number of frames is less than the number of cpus defined, the calculation will be performed with the number of processors = number of frames. gmx_MMPBSA is an effort to implement the GB/PB and others calculations in GROMACS. Based on MMPBSA.py (version 16.0) and AmberTools20","title":"gmx_MMPBSA_test command-line"},{"location":"command-line/#running-gmx_mmpbsa_test","text":"gmx_MMPBSA_test is designed to run a set of samples (all or minimal) or a specific example efficiently. Additionally, gmx_MMPBSA_test can run in parallel, decreasing the execution time gmx_MMPBSA_test will download the most recent version of the repository in the specified folder and will perform the calculations Minimal All Specific gmx_MMPBSA_test -f /home/user/Documents -n 10 [-t 2 is the default] Through this command-line, gmxMMPBSA_test will: Download gmx_MMPBSA repository content in /home/user/Documents Works with Fast set of examples Perform the calculation on 9 examples sequentially, using 10 cpus each time gmx_MMPBSA_test -f /home/user/Documents -t 0 -n 10 Through this command-line, gmxMMPBSA_test will: Download gmx_MMPBSA repository content in /home/user/Documents Works with All set of examples Perform the calculation on 16 examples sequentially, using 10 cpus each time gmx_MMPBSA_test -f /home/user/Documents -t 3 Through this command-line, gmxMMPBSA_test will: Download gmx_MMPBSA repository content in /home/user/Documents Execute 3 [Protein-Ligand (Single Trajectory approach)] example Taken from the MMPBSA.py paper \u21a9","title":"Running gmx_MMPBSA_test"},{"location":"compatibility/","text":"Upgrading \u00b6 Upgrade to the latest version with: amber.python -m pip install --upgrade gmx_MMPBSA Inspect the currently installed version with: amber.python -m pip show gmx_MMPBSA or gmx_MMPBSA -v Upgrading from 1.3.x to 1.4.x \u00b6 The differences between both versions are small, you can see them below Variables \u00b6 New variables in input file qh_entropy replace entropy = 1 ( Since v1.4.2 ) interaction_entrpy replace entropy = 2 ( Since v1.4.2 ) ie_segment replace entropy_seg ( Since v1.4.2 ) forcefields replace protein_forcefield and ligand_forcefield ( Since v1.4.1 ) temperature replace entropy_temp ( Since v1.4.1 ) sys_name ( Since v1.4.0 ) exp_ki ( Since v1.4.0 ) Internal variables (the user only interact with it in the info file) complex_fixed ( Since v1.4.0 ) Modified variables print_res ( Since v1.4.0 ) Deprecated variables entropy use qh_entropy or interaction_entropy instead ( Deprecated: v1.4.2 \u00b7 Removed: v1.5.0 ) entropy_seg use ie_segment instead ( Deprecated: v1.4.2 \u00b7 Removed: v1.5.0 ) entropy_temp use temperature instaed ( Deprecated: v1.4.1 \u00b7 Removed: v1.5.0 ) protein_forcefield use forcefields instead ( Deprecated: v1.4.1 \u00b7 Removed: v1.5.0 ) ligand_forcefield use forcefields instead ( Deprecated: v1.4.1 \u00b7 Removed: v1.5.0 ) Tip Check the changes in &general namelist variables section Command-line \u00b6 gmx_MMPBSA_ana changes the -p option by -f with more flexibility. Please check the gmx_MMPBSA_ana command-line . ( Changed in v1.4.0 ) Results and info file \u00b6 We have ensured backwards compatibility with gmx_MMPBSA , however there are some changes you can make Old results New calculation Since the calculations are done, we only have two options. Define the variables in gmx_MMPBSA_ana As we described above, these variables can be defined or modified in the gmx_MMPBSA_ana start dialog (See the gmx_MMPBSA_ana documentation ) Modify the *info file (usually _GMXMMPBSA_info ) Added the new variables as we describe below. We have modified the description in the _GMXMMPBSA_info file a bit to aid editing. Add variables to _GMXMMPBSA_info file # You can alter the variables below INPUT['debug_printlevel'] = 0 INPUT['verbose'] = 2 INPUT['csv_format'] = 1 INPUT['dec_verbose'] = 0 INPUT['temperature'] = 298.15 INPUT['exp_ki'] = 0.0 INPUT['sys_name'] = 'My System' INPUT['entropy_seg'] = 25 Warning complex_fixed is an internal variable that cannot be defined in the input file. This variable stores the PDB file name of the fixed complex. This structure corresponds to the complex with the proper chain identifiers and amino acid numbers. If it does not exist, a warning will be displayed, and the complex structure extracted from the structure file defined with the -cs option will be used. Note that this can lead to inconsistencies, for example: if the file defined in the -cs option is in GRO format, it will not have the string IDs. You can generate a structure for this variable as follows: generate a copy of the _GMXMMPBSA_COM.pdb file Open it with your preferred editor (we recommend one with column editing capabilities, such as Kate, Geany, or Sublime Text) Check the chains ID, if they do not exist add them Do not change the numbering of amino acids Save the document as _GMXMMPBSA_COM_FIXED.pdb In the _GMXMMPBSA_info file add the following line FILES.complex_fixed = '_GMXMMPBSA_COM_FIXED.pdb' save the document Removing entropy_temp variable After defining the temperature variable, you can remove the entropy_temp variable. This avoids getting the related warning. As we describe in the &general namelist variables section in the input file, these three variables are optional since they can be defined or modified in the gmx_MMPBSA_ana start dialog. However, modifying a set of systems can be cumbersome. We recommend defining them in the input file Example &general sys_name=\"Protein-Ligand\", temperature=310 exp_ki=10 / Note exp_ki Only needed when performing correlation analysis","title":"Compatibility"},{"location":"compatibility/#upgrading","text":"Upgrade to the latest version with: amber.python -m pip install --upgrade gmx_MMPBSA Inspect the currently installed version with: amber.python -m pip show gmx_MMPBSA or gmx_MMPBSA -v","title":"Upgrading"},{"location":"compatibility/#upgrading-from-13x-to-14x","text":"The differences between both versions are small, you can see them below","title":"Upgrading from 1.3.x to 1.4.x"},{"location":"compatibility/#variables","text":"New variables in input file qh_entropy replace entropy = 1 ( Since v1.4.2 ) interaction_entrpy replace entropy = 2 ( Since v1.4.2 ) ie_segment replace entropy_seg ( Since v1.4.2 ) forcefields replace protein_forcefield and ligand_forcefield ( Since v1.4.1 ) temperature replace entropy_temp ( Since v1.4.1 ) sys_name ( Since v1.4.0 ) exp_ki ( Since v1.4.0 ) Internal variables (the user only interact with it in the info file) complex_fixed ( Since v1.4.0 ) Modified variables print_res ( Since v1.4.0 ) Deprecated variables entropy use qh_entropy or interaction_entropy instead ( Deprecated: v1.4.2 \u00b7 Removed: v1.5.0 ) entropy_seg use ie_segment instead ( Deprecated: v1.4.2 \u00b7 Removed: v1.5.0 ) entropy_temp use temperature instaed ( Deprecated: v1.4.1 \u00b7 Removed: v1.5.0 ) protein_forcefield use forcefields instead ( Deprecated: v1.4.1 \u00b7 Removed: v1.5.0 ) ligand_forcefield use forcefields instead ( Deprecated: v1.4.1 \u00b7 Removed: v1.5.0 ) Tip Check the changes in &general namelist variables section","title":"Variables"},{"location":"compatibility/#command-line","text":"gmx_MMPBSA_ana changes the -p option by -f with more flexibility. Please check the gmx_MMPBSA_ana command-line . ( Changed in v1.4.0 )","title":"Command-line"},{"location":"compatibility/#results-and-info-file","text":"We have ensured backwards compatibility with gmx_MMPBSA , however there are some changes you can make Old results New calculation Since the calculations are done, we only have two options. Define the variables in gmx_MMPBSA_ana As we described above, these variables can be defined or modified in the gmx_MMPBSA_ana start dialog (See the gmx_MMPBSA_ana documentation ) Modify the *info file (usually _GMXMMPBSA_info ) Added the new variables as we describe below. We have modified the description in the _GMXMMPBSA_info file a bit to aid editing. Add variables to _GMXMMPBSA_info file # You can alter the variables below INPUT['debug_printlevel'] = 0 INPUT['verbose'] = 2 INPUT['csv_format'] = 1 INPUT['dec_verbose'] = 0 INPUT['temperature'] = 298.15 INPUT['exp_ki'] = 0.0 INPUT['sys_name'] = 'My System' INPUT['entropy_seg'] = 25 Warning complex_fixed is an internal variable that cannot be defined in the input file. This variable stores the PDB file name of the fixed complex. This structure corresponds to the complex with the proper chain identifiers and amino acid numbers. If it does not exist, a warning will be displayed, and the complex structure extracted from the structure file defined with the -cs option will be used. Note that this can lead to inconsistencies, for example: if the file defined in the -cs option is in GRO format, it will not have the string IDs. You can generate a structure for this variable as follows: generate a copy of the _GMXMMPBSA_COM.pdb file Open it with your preferred editor (we recommend one with column editing capabilities, such as Kate, Geany, or Sublime Text) Check the chains ID, if they do not exist add them Do not change the numbering of amino acids Save the document as _GMXMMPBSA_COM_FIXED.pdb In the _GMXMMPBSA_info file add the following line FILES.complex_fixed = '_GMXMMPBSA_COM_FIXED.pdb' save the document Removing entropy_temp variable After defining the temperature variable, you can remove the entropy_temp variable. This avoids getting the related warning. As we describe in the &general namelist variables section in the input file, these three variables are optional since they can be defined or modified in the gmx_MMPBSA_ana start dialog. However, modifying a set of systems can be cumbersome. We recommend defining them in the input file Example &general sys_name=\"Protein-Ligand\", temperature=310 exp_ki=10 / Note exp_ki Only needed when performing correlation analysis","title":"Results and info file"},{"location":"getting-started/","text":"gmx_MMPBSA is a new tool based on AMBER's MMPBSA.py aiming to perform end-state free energy calculations with GROMACS files. It works with all GROMACS versions along with AmberTools20 or 21 and brings improvements in compatibility, versatility, analyses, and parallelization compared to existing programs (see here for a detailed comparison) Cite gmx_MMPBSA gmx_MMPBSA official paper has been published on Journal of Chemical Theory and Computation and can be accessed here . If you use gmx_MMPBSA , please cite it as follows: Vald\u00e9s-Tresanco, M.S., Vald\u00e9s-Tresanco, M.E., Valiente, P.A. and Moreno E. gmx_MMPBSA: A New Tool to Perform End-State Free Energy Calculations with GROMACS . Journal of Chemical Theory and Computation, 2021 17 (10), 6281-6291. https://pubs.acs.org/doi/10.1021/acs.jctc.1c00645 . Download | *.bib | *.ris Please, also consider citing MMPBSA.py's paper: Bill R. Miller, T. Dwight McGee, Jason M. Swails, Nadine Homeyer, Holger Gohlke, and Adrian E. Roitberg. MMPBSA. py: An Efficient Program for End-State Free Energy Calculations. Journal of Chemical Theory and Computation, 2012 8 (9), 3314-3321. https://pubs.acs.org/doi/10.1021/ct300418h . Download | *.bib | *.ris | *.xml Visit Cite us page for more information on how to cite gmx_MMPBSA and the programs/methods implemented in it. Installation \u00b6 Ready to use gmx_MMPBSA \ud83d\ude00? Check the installation page What can be done with gmx_MMPBSA? \u00b6 Multiple calculations can be performed with gmx_MMPBSA such as: Binding free energy calculations with PB , GB and/or 3D-RISM models Alanine scanning Binding free energy decomposition Entropy corrections ( IE , C2 , NMODE ) Stability QM/MMGBSA There is always more... You can check gmx_MMPBSA in a nutshell page for a more detailed overview of the types of calculations supported in gmx_MMPBSA. Also check our example page to see a detailed list of all the examples available In the current version, gmx_MMPBSA supports a number of different systems including but not limited to: Protein-protein Protein-ligand Protein-DNA Metalloprotein-peptide Protein-glycan Membrane proteins Multicomponent systems ( e.g. , Protein-DNA-RNA-Ions-Ligand ) Support for Amber and CHARMM force fields In the current version, gmx_MMPBSA supports Amber and CHARMM force fields. That means any system built with pdb2gmx in GROMACS using Amber/CHARMM force field or CHARMM-GUI is supported in gmx_MMPBSA \ud83d\ude00 The following video shows how a typical binding free energy calculation with GB model and Interaction entropy method is performed in gmx_MMPBSA. gmx_MMPBSA a quick overview \u00b6 gmx_MMPBSA is a python module that contains 3 applications: gmx_MMPBSA is the fundamental application and carries out the calculations mentioned above gmx_MMPBSA_ana provides an intuitive way to analyze the data from gmx_MMPBSA calculations and save high-quality pictures gmx_MMPBSA_test is a tool designed to test if the installation was successful by running one or more available examples in gmx_MMPBSA. Easy to run gmx_MMPBSA can run in parallel and requires just few things in order to perform any kind of calculation. That is: an input parameters file ( *.in , contains all the specifications regarding the type of calculation that is going to be performed) a MD Structure+mass(db) file ( *.tpr , *.pdb ) an index file ( *.ndx ) receptor and ligand groups (group numbers in the index file) a trajectory file ( *.xtc , *.pdb , *.trr ) In certain occasions, defining a topology file ( *.top ) may be required. Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana You can check How gmx_MMPBSA works page to get more details. Also check our example page to see how gmx_MMPBSA works with real examples Follow gmx_MMPBSA \u00b6 Visit Pypi Stats or PePy to see how gmx_MMPBSA is doing. Acknowledgments \u00b6 This project is possible thanks to the Open Source license of the JetBrains programs.","title":"Getting started"},{"location":"getting-started/#installation","text":"Ready to use gmx_MMPBSA \ud83d\ude00? Check the installation page","title":"Installation"},{"location":"getting-started/#what-can-be-done-with-gmx_mmpbsa","text":"Multiple calculations can be performed with gmx_MMPBSA such as: Binding free energy calculations with PB , GB and/or 3D-RISM models Alanine scanning Binding free energy decomposition Entropy corrections ( IE , C2 , NMODE ) Stability QM/MMGBSA There is always more... You can check gmx_MMPBSA in a nutshell page for a more detailed overview of the types of calculations supported in gmx_MMPBSA. Also check our example page to see a detailed list of all the examples available In the current version, gmx_MMPBSA supports a number of different systems including but not limited to: Protein-protein Protein-ligand Protein-DNA Metalloprotein-peptide Protein-glycan Membrane proteins Multicomponent systems ( e.g. , Protein-DNA-RNA-Ions-Ligand ) Support for Amber and CHARMM force fields In the current version, gmx_MMPBSA supports Amber and CHARMM force fields. That means any system built with pdb2gmx in GROMACS using Amber/CHARMM force field or CHARMM-GUI is supported in gmx_MMPBSA \ud83d\ude00 The following video shows how a typical binding free energy calculation with GB model and Interaction entropy method is performed in gmx_MMPBSA.","title":"What can be done with gmx_MMPBSA?"},{"location":"getting-started/#gmx_mmpbsa-a-quick-overview","text":"gmx_MMPBSA is a python module that contains 3 applications: gmx_MMPBSA is the fundamental application and carries out the calculations mentioned above gmx_MMPBSA_ana provides an intuitive way to analyze the data from gmx_MMPBSA calculations and save high-quality pictures gmx_MMPBSA_test is a tool designed to test if the installation was successful by running one or more available examples in gmx_MMPBSA. Easy to run gmx_MMPBSA can run in parallel and requires just few things in order to perform any kind of calculation. That is: an input parameters file ( *.in , contains all the specifications regarding the type of calculation that is going to be performed) a MD Structure+mass(db) file ( *.tpr , *.pdb ) an index file ( *.ndx ) receptor and ligand groups (group numbers in the index file) a trajectory file ( *.xtc , *.pdb , *.trr ) In certain occasions, defining a topology file ( *.top ) may be required. Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana You can check How gmx_MMPBSA works page to get more details. Also check our example page to see how gmx_MMPBSA works with real examples","title":"gmx_MMPBSA a quick overview"},{"location":"getting-started/#follow-gmx_mmpbsa","text":"Visit Pypi Stats or PePy to see how gmx_MMPBSA is doing.","title":"Follow gmx_MMPBSA"},{"location":"getting-started/#acknowledgments","text":"This project is possible thanks to the Open Source license of the JetBrains programs.","title":"Acknowledgments"},{"location":"gmx_MMPBSA_ana_command-line/","text":"gmx_MMPBSA_ana command-line \u00b6 $ gmx_MMPBSA_ana -h usage: run_ana.py [-h] [-v] [-f [FILES [FILES ...]]] [-r] This program is part of gmx_MMPBSA and will show a workspace to analyze the gmx_MMPBSA results optional arguments: -h, --help show this help message and exit -v, --version show program's version number and exit Info file: -f [FILES [FILES ...]], --files [FILES [FILES ...]] gmx_MMPBSA info files or container folder or list of them (default: [.] Current working dir) -r, --recursive Search recursively in this folder at depth = 1 (default: False) gmx_MMPBSA is an effort to implement the GB/PB and others calculations in GROMACS. Based on MMPBSA.py (version 16.0) and AmberTools20","title":"Command-line"},{"location":"gmx_MMPBSA_ana_command-line/#gmx_mmpbsa_ana-command-line","text":"$ gmx_MMPBSA_ana -h usage: run_ana.py [-h] [-v] [-f [FILES [FILES ...]]] [-r] This program is part of gmx_MMPBSA and will show a workspace to analyze the gmx_MMPBSA results optional arguments: -h, --help show this help message and exit -v, --version show program's version number and exit Info file: -f [FILES [FILES ...]], --files [FILES [FILES ...]] gmx_MMPBSA info files or container folder or list of them (default: [.] Current working dir) -r, --recursive Search recursively in this folder at depth = 1 (default: False) gmx_MMPBSA is an effort to implement the GB/PB and others calculations in GROMACS. Based on MMPBSA.py (version 16.0) and AmberTools20","title":"gmx_MMPBSA_ana command-line"},{"location":"gmx_MMPBSA_ana_running/","text":"Running gmx_MMPBSA_ana \u00b6 In order to analyze multiple systems in the same section and implement the correlation between them, we improved the file input to gmx_MMPBSA_ana. Currently, gmx_MMPBSA_ana supports either several info files, a folder that contains the info file, or a list of folders containing info files. Make sure to use the following structure when working with several folders: Valid folder structure Valid folders + files structure Wrong folder structure Here all folders (5 systems) will be processed by gmx_MMPBSA_ana Defined folder \u251c\u2500\u2500 System-1 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-2 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-3 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-4 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u2514\u2500\u2500 System-5 \u2514\u2500\u2500 _GMXMMPBSA_info Here all systems (4) will be processed by gmx_MMPBSA_ana System-1 \u2514\u2500\u2500_GMXMMPBSA_info Folder-1 \u251c\u2500\u2500 System-2.1 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u2514\u2500\u2500 System-2.2 \u2514\u2500\u2500 _GMXMMPBSA_info System-3 (_GMXMMPBSA_info) The command-line for this is: gmx_MMPBSA_ana -f /path/to/System-1 /path/to/System-3/_GMXMMPBSA_info /path/to/Folder-1 -r This estructure only work if recursive option was defined. See the examples below Note that: System-1 is defined as folder that contain a _GMXMMPBSA_info Folder-1 contain two folder (Systems), each containing a _GMXMMPBSA_info System-3 is defined as a _GMXMMPBSA_info file Here only 4 (systems) folders will be processed by gmx_MMPBSA_ana. The systems in the Internal folder will be ignored Defined folder \u251c\u2500\u2500 System-1 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-2 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 Internal folder \u2502 \u251c\u2500X\u2500 System-3.1 \u2502 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u2502 \u2514\u2500X\u2500 System-3.2 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-4 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u2514\u2500\u2500 System-5 \u2514\u2500\u2500 _GMXMMPBSA_info Examples One file One folder Files + Folders Recursive option Passing a _GMXMMPBSA_info file as input: Current directory gmx_MMPBSA_ana -f _GMXMMPBSA_info other location Version: 1.4.0 gmx_MMPBSA_ana -f /path/to/_GMXMMPBSA_info Version: 1.4.0 Passing a folder as input: Current directory gmx_MMPBSA_ana -f . other location gmx_MMPBSA_ana -f /path/to/folder Remember This folder must contain a valid _GMXMMPBSA_info file Version: 1.4.0 gmx_MMPBSA_ana -f /path/to/folder-1 /path/to/_GMXMMPBSA_info-1 /path/to/folder-2 Remember All defined folders must contain a valid _GMXMMPBSA_info file All _GMXMMPBSA_info files defined must be valid Version: 1.4.0 Passing a folder as input with recursive option: Current directory gmx_MMPBSA_ana -f . -r other location gmx_MMPBSA_ana -f /path/to/folder --recursive combine multiple folders gmx_MMPBSA_ana -f /path/to/folder-1 /path/to/folder-2 /path/to/folder-3 -r Folders can contain one or more systems combine multiple folders and files gmx_MMPBSA_ana -f /path/to/folder-1 /path/to/_GMXMMPBSA_info-1 /path/to/folder-3 -r Folders can contain one or more systems Note that if you remove the option -r, each folder must contain a valid _GMXMMPBSA_info file.","title":"Running gmx_MMPBSA_ana"},{"location":"gmx_MMPBSA_ana_running/#running-gmx_mmpbsa_ana","text":"In order to analyze multiple systems in the same section and implement the correlation between them, we improved the file input to gmx_MMPBSA_ana. Currently, gmx_MMPBSA_ana supports either several info files, a folder that contains the info file, or a list of folders containing info files. Make sure to use the following structure when working with several folders: Valid folder structure Valid folders + files structure Wrong folder structure Here all folders (5 systems) will be processed by gmx_MMPBSA_ana Defined folder \u251c\u2500\u2500 System-1 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-2 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-3 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-4 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u2514\u2500\u2500 System-5 \u2514\u2500\u2500 _GMXMMPBSA_info Here all systems (4) will be processed by gmx_MMPBSA_ana System-1 \u2514\u2500\u2500_GMXMMPBSA_info Folder-1 \u251c\u2500\u2500 System-2.1 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u2514\u2500\u2500 System-2.2 \u2514\u2500\u2500 _GMXMMPBSA_info System-3 (_GMXMMPBSA_info) The command-line for this is: gmx_MMPBSA_ana -f /path/to/System-1 /path/to/System-3/_GMXMMPBSA_info /path/to/Folder-1 -r This estructure only work if recursive option was defined. See the examples below Note that: System-1 is defined as folder that contain a _GMXMMPBSA_info Folder-1 contain two folder (Systems), each containing a _GMXMMPBSA_info System-3 is defined as a _GMXMMPBSA_info file Here only 4 (systems) folders will be processed by gmx_MMPBSA_ana. The systems in the Internal folder will be ignored Defined folder \u251c\u2500\u2500 System-1 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-2 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 Internal folder \u2502 \u251c\u2500X\u2500 System-3.1 \u2502 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u2502 \u2514\u2500X\u2500 System-3.2 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u251c\u2500\u2500 System-4 \u2502 \u2514\u2500\u2500 _GMXMMPBSA_info \u2514\u2500\u2500 System-5 \u2514\u2500\u2500 _GMXMMPBSA_info Examples One file One folder Files + Folders Recursive option Passing a _GMXMMPBSA_info file as input: Current directory gmx_MMPBSA_ana -f _GMXMMPBSA_info other location Version: 1.4.0 gmx_MMPBSA_ana -f /path/to/_GMXMMPBSA_info Version: 1.4.0 Passing a folder as input: Current directory gmx_MMPBSA_ana -f . other location gmx_MMPBSA_ana -f /path/to/folder Remember This folder must contain a valid _GMXMMPBSA_info file Version: 1.4.0 gmx_MMPBSA_ana -f /path/to/folder-1 /path/to/_GMXMMPBSA_info-1 /path/to/folder-2 Remember All defined folders must contain a valid _GMXMMPBSA_info file All _GMXMMPBSA_info files defined must be valid Version: 1.4.0 Passing a folder as input with recursive option: Current directory gmx_MMPBSA_ana -f . -r other location gmx_MMPBSA_ana -f /path/to/folder --recursive combine multiple folders gmx_MMPBSA_ana -f /path/to/folder-1 /path/to/folder-2 /path/to/folder-3 -r Folders can contain one or more systems combine multiple folders and files gmx_MMPBSA_ana -f /path/to/folder-1 /path/to/_GMXMMPBSA_info-1 /path/to/folder-3 -r Folders can contain one or more systems Note that if you remove the option -r, each folder must contain a valid _GMXMMPBSA_info file.","title":"Running gmx_MMPBSA_ana"},{"location":"gmx_MMPBSA_command-line/","text":"gmx_MMPBSA command-line \u00b6 All flags available in gmx_MMPBSA are shown below: $ gmx_MMPBSA -h usage: gmx_MMPBSA [-h] [-v] [--input-file-help] [--create_input [{gb,pb,rism,ala,decomp,nmode,all}] [-O] [-prefix <file prefix>] [-i FILE] [-xvvfile XVVFILE] [-o FILE] [-do FILE] [-eo FILE] [-deo FILE] [-nogui] [-s] [-cs <Structure File>] [-ci <Index File>] [-cg index index] [-ct [TRJ [TRJ ...]]] [-cp <Topology>] [-cr <PDB File>] [-rs <Structure File>] [-ri <Index File>] [-rg index] [-rt [TRJ [TRJ ...]]] [-rp <Topology>] [-lm <Structure File>] [-ls <Structure File>] [-li <Index File>] [-lg index] [-lt [TRJ [TRJ ...]]] [-lp <Topology>] [--rewrite-output] [--clean] gmx_MMPBSA is a new tool based on AMBER's MMPBSA.py aiming to perform end-state free energy calculations with GROMACS files. This program is an adaptation of Amber's MMPBSA.py and essentially works as such. gmx_MMPBSA works with any GROMACS version. This program will calculate binding free energies using end-state free energy methods on an ensemble of snapshots using a variety of implicit solvent models. This is the core of gmx_MMPBSA and it will do all the calculations optional arguments: -h, --help show this help message and exit -v, --version show program's version number and exit --input-file-help Print all available options in the input file. (default: False) --create_input Create an new input file with selected calculation type. (default: None) [{gb,pb,rism,ala,decomp,nmode,all}] Miscellaneous Options: -O, --overwrite Allow output files to be overwritten (default: False) -prefix <file prefix> Prefix for intermediate files. (default: _GMXMMPBSA_) Input and Output Files: These options specify the input files and optional output files. -i FILE MM/PBSA input file. (default: None) -xvvfile XVVFILE XVV file for 3D-RISM. (default: /home/mario/programs/amber20/dat/mmpbsa/spc.xvv) -o FILE Output file with MM/PBSA statistics. (default: FINAL_RESULTS_MMPBSA.dat) -do FILE Output file for decomposition statistics summary. (default: FINAL_DECOMP_MMPBSA.dat) -eo FILE CSV-format output of all energy terms for every frame in every calculation. File name forced to end in [.csv]. This file is only written when specified on the command-line. (default: None) -deo FILE CSV-format output of all energy terms for each printed residue in decomposition calculations. File name forced to end in [.csv]. This file is only written when specified on the command-line. (default: None) -nogui No open gmx_MMPBSA_ana after all calculations finished (default: True) -s, --stability Perform stability calculation. Only the complex parameters are required. Only If the ligand is non-Protein (small molecule) type and you not define a complex topology, then ligand *.mol2 file is required. In any other case receptor and ligand parameters will be ignored. See description bellow (default: False) Complex: Complex files and info that are needed to perform the calculation. If the receptor and/or the ligand info is not defined, we generate them from that of the complex. -cs <Structure File> Structure file of the complex. If it is Protein-Ligand (small molecule) complex and -cp is not defined, make sure that you define -lm option. See -lm description below Allowed formats: *.tpr (recommended), *.pdb, *.gro (default: None) -ci <Index File> Index file of the bound complex. (default: None) -cg index index Groups of receptor and ligand in complex index file. The notation is as follows: \"-cg <Receptor group> <Ligand group>\", ie. -cg 1 13 (default: None) -ct [TRJ [TRJ ...]] Complex trajectories. Make sure the trajectory is fitted and pbc have been removed. Allowed formats: *.xtc (recommended), *.trr, *.pdb (specify as many as you'd like). (default: None) -cp <Topology> The complex Topology file. When it is defined -lm option is not needed (default: None) -cr <PDB File> Complex Reference Structure file. This option is optional but recommended (Use the PDB file used to generate the topology in GROMACS). If not defined, the chains ID assignment (if the structure used in -cs does not have chain IDs) will be done automatically according to the structure (can generate wrong mapping). (default: None) Receptor: Receptor files and info that are needed to perform the calculation. If the receptor info is not defined, we generate it from that of the complex. -rs <Structure File> Structure file of the unbound receptor for multiple trajectory approach. Allowed formats: *.tpr (recommended), *.pdb, *.gro (default: None) -ri <Index File> Index file of the unbound receptor. (default: None) -rg index Receptor group in receptor index file. Notation: \"-lg <Receptor group>\", e.g. -rg 1 (default: None) -rt [TRJ [TRJ ...]] Input trajectories of the unbound receptor for multiple trajectory approach. Allowed formats: *.xtc (recommended), *.trr, *.pdb, *.gro (specify as many as you'd like). (default: None) -rp <Topology> Topology file of the receptor. (default: None) Ligand: Ligand files and info that are needed to perform the calculation. If the ligand are not defined, we generate it from that of the complex. -lm <Structure File> A *.mol2 file of the unbound ligand used to parametrize ligand for GROMACS using Antechamber. Must be defined if Protein-Ligand (small molecule) complex was define and -cp or -lp option are not defined. No needed for Proteins, DNA, RNA, Ions, Glycans or any ligand parametrized in the Amber force fields. Must be the Antechamber output *.mol2. (default: None) -ls <Structure File> Structure file of the unbound ligand. If ligand is a small molecule and -lp is not defined, make sure that you define above -lm option. Allowed formats: *.tpr (recommended), *.pdb, *.gro (default: None) -li <Index File> Index file of the unbound ligand. Only if tpr file was define in -ls. (default: None) -lg index Ligand group in ligand index file. Notation: \"-lg <Ligand group>\", e.g. -lg 13 (default: None) -lt [TRJ [TRJ ...]] Input trajectories of the unbound ligand for multiple trajectory approach. Allowed formats: *.xtc (recommended), *.trr, *.pdb, *.gro (specify as many as you'd like). (default: None) -lp <Topology> Topology file of the ligand. (default: None) Miscellaneous Actions: -rewrite-output Do not re-run any calculations, just parse the output files from the previous calculation and rewrite the output files. (default: False) --clean Clean temporary files and quit. (default: False) gmx_MMPBSA is an effort to implement the GB/PB and others calculations in GROMACS. Based on MMPBSA.py (version 16.0) and AmberTools20","title":"Command-line"},{"location":"gmx_MMPBSA_command-line/#gmx_mmpbsa-command-line","text":"All flags available in gmx_MMPBSA are shown below: $ gmx_MMPBSA -h usage: gmx_MMPBSA [-h] [-v] [--input-file-help] [--create_input [{gb,pb,rism,ala,decomp,nmode,all}] [-O] [-prefix <file prefix>] [-i FILE] [-xvvfile XVVFILE] [-o FILE] [-do FILE] [-eo FILE] [-deo FILE] [-nogui] [-s] [-cs <Structure File>] [-ci <Index File>] [-cg index index] [-ct [TRJ [TRJ ...]]] [-cp <Topology>] [-cr <PDB File>] [-rs <Structure File>] [-ri <Index File>] [-rg index] [-rt [TRJ [TRJ ...]]] [-rp <Topology>] [-lm <Structure File>] [-ls <Structure File>] [-li <Index File>] [-lg index] [-lt [TRJ [TRJ ...]]] [-lp <Topology>] [--rewrite-output] [--clean] gmx_MMPBSA is a new tool based on AMBER's MMPBSA.py aiming to perform end-state free energy calculations with GROMACS files. This program is an adaptation of Amber's MMPBSA.py and essentially works as such. gmx_MMPBSA works with any GROMACS version. This program will calculate binding free energies using end-state free energy methods on an ensemble of snapshots using a variety of implicit solvent models. This is the core of gmx_MMPBSA and it will do all the calculations optional arguments: -h, --help show this help message and exit -v, --version show program's version number and exit --input-file-help Print all available options in the input file. (default: False) --create_input Create an new input file with selected calculation type. (default: None) [{gb,pb,rism,ala,decomp,nmode,all}] Miscellaneous Options: -O, --overwrite Allow output files to be overwritten (default: False) -prefix <file prefix> Prefix for intermediate files. (default: _GMXMMPBSA_) Input and Output Files: These options specify the input files and optional output files. -i FILE MM/PBSA input file. (default: None) -xvvfile XVVFILE XVV file for 3D-RISM. (default: /home/mario/programs/amber20/dat/mmpbsa/spc.xvv) -o FILE Output file with MM/PBSA statistics. (default: FINAL_RESULTS_MMPBSA.dat) -do FILE Output file for decomposition statistics summary. (default: FINAL_DECOMP_MMPBSA.dat) -eo FILE CSV-format output of all energy terms for every frame in every calculation. File name forced to end in [.csv]. This file is only written when specified on the command-line. (default: None) -deo FILE CSV-format output of all energy terms for each printed residue in decomposition calculations. File name forced to end in [.csv]. This file is only written when specified on the command-line. (default: None) -nogui No open gmx_MMPBSA_ana after all calculations finished (default: True) -s, --stability Perform stability calculation. Only the complex parameters are required. Only If the ligand is non-Protein (small molecule) type and you not define a complex topology, then ligand *.mol2 file is required. In any other case receptor and ligand parameters will be ignored. See description bellow (default: False) Complex: Complex files and info that are needed to perform the calculation. If the receptor and/or the ligand info is not defined, we generate them from that of the complex. -cs <Structure File> Structure file of the complex. If it is Protein-Ligand (small molecule) complex and -cp is not defined, make sure that you define -lm option. See -lm description below Allowed formats: *.tpr (recommended), *.pdb, *.gro (default: None) -ci <Index File> Index file of the bound complex. (default: None) -cg index index Groups of receptor and ligand in complex index file. The notation is as follows: \"-cg <Receptor group> <Ligand group>\", ie. -cg 1 13 (default: None) -ct [TRJ [TRJ ...]] Complex trajectories. Make sure the trajectory is fitted and pbc have been removed. Allowed formats: *.xtc (recommended), *.trr, *.pdb (specify as many as you'd like). (default: None) -cp <Topology> The complex Topology file. When it is defined -lm option is not needed (default: None) -cr <PDB File> Complex Reference Structure file. This option is optional but recommended (Use the PDB file used to generate the topology in GROMACS). If not defined, the chains ID assignment (if the structure used in -cs does not have chain IDs) will be done automatically according to the structure (can generate wrong mapping). (default: None) Receptor: Receptor files and info that are needed to perform the calculation. If the receptor info is not defined, we generate it from that of the complex. -rs <Structure File> Structure file of the unbound receptor for multiple trajectory approach. Allowed formats: *.tpr (recommended), *.pdb, *.gro (default: None) -ri <Index File> Index file of the unbound receptor. (default: None) -rg index Receptor group in receptor index file. Notation: \"-lg <Receptor group>\", e.g. -rg 1 (default: None) -rt [TRJ [TRJ ...]] Input trajectories of the unbound receptor for multiple trajectory approach. Allowed formats: *.xtc (recommended), *.trr, *.pdb, *.gro (specify as many as you'd like). (default: None) -rp <Topology> Topology file of the receptor. (default: None) Ligand: Ligand files and info that are needed to perform the calculation. If the ligand are not defined, we generate it from that of the complex. -lm <Structure File> A *.mol2 file of the unbound ligand used to parametrize ligand for GROMACS using Antechamber. Must be defined if Protein-Ligand (small molecule) complex was define and -cp or -lp option are not defined. No needed for Proteins, DNA, RNA, Ions, Glycans or any ligand parametrized in the Amber force fields. Must be the Antechamber output *.mol2. (default: None) -ls <Structure File> Structure file of the unbound ligand. If ligand is a small molecule and -lp is not defined, make sure that you define above -lm option. Allowed formats: *.tpr (recommended), *.pdb, *.gro (default: None) -li <Index File> Index file of the unbound ligand. Only if tpr file was define in -ls. (default: None) -lg index Ligand group in ligand index file. Notation: \"-lg <Ligand group>\", e.g. -lg 13 (default: None) -lt [TRJ [TRJ ...]] Input trajectories of the unbound ligand for multiple trajectory approach. Allowed formats: *.xtc (recommended), *.trr, *.pdb, *.gro (specify as many as you'd like). (default: None) -lp <Topology> Topology file of the ligand. (default: None) Miscellaneous Actions: -rewrite-output Do not re-run any calculations, just parse the output files from the previous calculation and rewrite the output files. (default: False) --clean Clean temporary files and quit. (default: False) gmx_MMPBSA is an effort to implement the GB/PB and others calculations in GROMACS. Based on MMPBSA.py (version 16.0) and AmberTools20","title":"gmx_MMPBSA command-line"},{"location":"gmx_MMPBSA_running/","text":"Running gmx_MMPBSA \u00b6 Tip Since version 1.4.0 we have fixed the gmx_MMPBSA inconsistencies when using MPI . We currently recommend the use of MPI since the computation time decreases considerably. Parallel (MPI) version Serial version gmx_MMPBSA as MMPBSA.py uses the MPI only to perform the calculations, the rest of the process ( i.e , Generation/conversion of Amber topologies, mutation, division of the trajectories, etc) occurs in a single thread (See Figure 1[^1] for better reference). This means that it is not necessary to install any program (AmberTools or GROMACS) with MPI , which can be used in any circumstance, and the time required to process the data prior to the calculation depends on the system and will be the same for both versions ( Serial and MPI ). Note Note that gmx_MMPBSA processes, converts, or builds topologies from GROMACS files, so it takes slightly longer than MMPBSA.py at the same stage of the process. However, this is not really significant. Remember Make sure that you install the OpenMPI library sudo apt install openmpi-bin libopenmpi-dev openssh-client A usage example is shown below: Local HPC mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc #!/bin/sh #PBS -N nmode #PBS -o nmode.out #PBS -e nmode.err #PBS -m abe #PBS -M email@domain.edu #PBS -q brute #PBS -l nodes=1:surg:ppn=3 #PBS -l pmem=1450mb or > 5gb for nmode calculation cd $PBS_O_WORKDIR mpirun -np 3 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc > progress.log Danger Unfortunately, when running gmx_MMPBSA with MPI , GROMACS's gmx_mpi can't be used. This is probably because of gmx_mpi conflicts with mpirun. In any case, this is not a problem since gmx works correctly and gmx_mpi only parallels mdrun , the rest of the GROMACS tools work in a single thread. See this issue to see the output. Warning The nmode calculations require a considerable amount of RAM. Consider that the total amount of RAM will be: RAM total = RAM 1_frame * NUM of Threads If it consumes all the RAM of the system it can cause crashes, instability or system shutdown! Note At a certain level, running RISM in parallel may actually hurt performance, since previous solutions are used as an initial guess for the next frame, hastening convergence. Running in parallel loses this advantage. Also, due to the overhead involved in which each thread is required to load every topology file when calculating energies, parallel scaling will begin to fall off as the number of threads reaches the number of frames. This version is installed via pip as described above. AMBERHOME variable must be set, or it will quit with an error. An example command-line call is shown below: gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc You can found test files on GitHub Figure 1 . MPI benchmark description from MMPBSA.py paper . MMPBSA.py scaling comparison for MM-PBSA and MM-GBSA calculations on 200 frames of a 5910-atom complex. Times shown are the times required for the calculation to finish. Note that MM-GBSA calculations are \u223c5 times faster than MM-PBSA calculations. All calculations were performed on NICS Keeneland (2 Intel Westmere 6-core CPUs per node, QDR infiniband interconnect)","title":"Running gmx_MMPBSA"},{"location":"gmx_MMPBSA_running/#running-gmx_mmpbsa","text":"Tip Since version 1.4.0 we have fixed the gmx_MMPBSA inconsistencies when using MPI . We currently recommend the use of MPI since the computation time decreases considerably. Parallel (MPI) version Serial version gmx_MMPBSA as MMPBSA.py uses the MPI only to perform the calculations, the rest of the process ( i.e , Generation/conversion of Amber topologies, mutation, division of the trajectories, etc) occurs in a single thread (See Figure 1[^1] for better reference). This means that it is not necessary to install any program (AmberTools or GROMACS) with MPI , which can be used in any circumstance, and the time required to process the data prior to the calculation depends on the system and will be the same for both versions ( Serial and MPI ). Note Note that gmx_MMPBSA processes, converts, or builds topologies from GROMACS files, so it takes slightly longer than MMPBSA.py at the same stage of the process. However, this is not really significant. Remember Make sure that you install the OpenMPI library sudo apt install openmpi-bin libopenmpi-dev openssh-client A usage example is shown below: Local HPC mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc #!/bin/sh #PBS -N nmode #PBS -o nmode.out #PBS -e nmode.err #PBS -m abe #PBS -M email@domain.edu #PBS -q brute #PBS -l nodes=1:surg:ppn=3 #PBS -l pmem=1450mb or > 5gb for nmode calculation cd $PBS_O_WORKDIR mpirun -np 3 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc > progress.log Danger Unfortunately, when running gmx_MMPBSA with MPI , GROMACS's gmx_mpi can't be used. This is probably because of gmx_mpi conflicts with mpirun. In any case, this is not a problem since gmx works correctly and gmx_mpi only parallels mdrun , the rest of the GROMACS tools work in a single thread. See this issue to see the output. Warning The nmode calculations require a considerable amount of RAM. Consider that the total amount of RAM will be: RAM total = RAM 1_frame * NUM of Threads If it consumes all the RAM of the system it can cause crashes, instability or system shutdown! Note At a certain level, running RISM in parallel may actually hurt performance, since previous solutions are used as an initial guess for the next frame, hastening convergence. Running in parallel loses this advantage. Also, due to the overhead involved in which each thread is required to load every topology file when calculating energies, parallel scaling will begin to fall off as the number of threads reaches the number of frames. This version is installed via pip as described above. AMBERHOME variable must be set, or it will quit with an error. An example command-line call is shown below: gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc You can found test files on GitHub Figure 1 . MPI benchmark description from MMPBSA.py paper . MMPBSA.py scaling comparison for MM-PBSA and MM-GBSA calculations on 200 frames of a 5910-atom complex. Times shown are the times required for the calculation to finish. Note that MM-GBSA calculations are \u223c5 times faster than MM-PBSA calculations. All calculations were performed on NICS Keeneland (2 Intel Westmere 6-core CPUs per node, QDR infiniband interconnect)","title":"Running gmx_MMPBSA"},{"location":"howworks/","text":"How gmx_MMPBSA works \u00b6 gmx_MMPBSA is a new tool based on AMBER's MMPBSA.py aiming to perform end-state free energy calculations with GROMACS files. But, what does that mean? Basically, gmx_MMPBSA brings in all the MMPBSA.py functionalities to GROMACS users. MMPBSA.py is an excellent and well-known tool to perform calculations with the PB and GB models in AMBER (February/2021 more than 1200 citations). On the other hand, there are tools like g_mmpbsa that are well known in the GROMACS community (February/2021 more than 1100 citations). Interestingly, MMPBSA.py is more robust and was published first, however, both have a similar number of citations. This is probably due to the fact that the GROMACS (Open source and free) community is large, while AMBER has the restriction of a paid license, or a small community with free academic license. The use of MMPBSA.py for GROMACS users requires enormous effort to successfully complete the process. In that regard, we have decided to make our experience in this process available to the community. We have not limited ourselves only to the extent of utility itself, but added additional value. We have designed a tool that allows to perform a number of calculations in an effortless way with a graphical tool incorporated, which we believe has great potential for the analysis of the results obtained. We also have incorporated some functionalities that aren't present in MMPBSA.py and made others more accessible to the beginner user in Amber. gmx_MMPBSA general workflow \u00b6 gmx_MMPBSA functioning can be divided into 3 parts as shown in figure 1. In the first part, Preparation , the topologies and trajectories are generated, among other elements depending on the calculations, such as the mutants for the alanine or glycine scanning or the interaction residues during decomposition analysis. In the second part, Calculation , the binding free energies and/or entropies are estimated using the selected models. Finally, in the last step Analysis , the results can be analyzed by using the graphical user interface gmx_MMPBSA_ana . Figure 1 . gmx_MMPBSA general workflow Required input files \u00b6 Currently, gmx_MMPBSA supports two families of force fields: Amber and CHARMM. Although these force fileds are quite similar, the generation of topologies differs. When Amber force filed was used to prepare the system(s), the topologies compatible with AMBER package can be generated from either GROMACS topologies or structures. Meanwhile, when CHARMM force field is used, AMBER's topologies are generated from GROMACS topologies exclusively. (Table 1). Table 1: Required input files for every force field Force field Structure Index Trajectory Topology Reference Structure Small Molecule Mol2 AMBER tpr, gro, pdb ndx xtc, trr, pdb, gro Optional Optional Only if not top CHARMM tpr, gro, pdb ndx xtc, trr, pdb, gro Always Optional No Topology preparation \u00b6 In this section, we will go in detail about each file and what they are used for. GROMACS files MD Structure+mass(db) (tpr, pdb, gro): This file is used to generate the structure in pdb format of the complex with editconf . We recommend using the *.tpr (production *.tpr) format. Index (ndx) This the file that contains the index of each element contained in the *.tpr file, organized as groups. This file is required for the definition of the groups corresponding to the receptor and the ligand. Trajectory (xtc, trr, pdb, gro) Trajectory files. Topology (top) This file contains all the parameters corresponding to the force field selected during the system setup. When using a GROMACS topology, parmed is used for converting the topologies. This method can be useful when studying a complex system with many elements. However, its main strength (flexibility) is its main weakness. GROMACS can parameterize your system differently than AMBER, so the conversion can result in a topology with very dissimilar parameters that AMBER does not understand. If you use amber, you can consider whether to use this method or not. However, when using CHARMM (any version) force field, the topology is always required. Reference Structure It corresponds to a file in *.pdb format that must contain a complete structure. That is, the user must make sure that this structure contains the same number of atoms and residues as the complex that he initially defined, the correct residue numbering, as well as its chain ID. This structure is optional, but we recommend using it since it should guarantee a smooth processing of the files in gmx_MMPBSA . Essentially, the objective is to be able to correctly assign the mentioned parameters since internally gmx_MMPBSA handles sensitive information, for example: when it extracts the receptor and the ligand from the complex structure, the mutation in the alanine scan, etc. Small molecule parameters (mol2) This file contains a ligand parameterization with antechamber that is not found in the selected force field (Amber family). It is only necessary to define it when studying a system that contains this type of ligand, and a topology has not been defined. This is used to build amber topology from structure using tleap . Here are the steps that gmx_MMPBSA follows to generate the topologies: Specific steps for the topology are highlighted like this Generates a new index and registers the groups defined by the user Generates the pdb of the complex, receptor, and ligand Topologies are cleaned (remove water and ions) The structures or parameters for the receptor and the ligand are generated if it is a ST approximation. If Alanine scanning: the mutant of the complex, and the mutant receptor or ligand are generated If decomposition: interaction residues are extracted The complex is mapped. Registers the continuity of the receptor (example: Metalloprotein structure files are generally structured as follows: Receptor protein + Ligand + Receptor Ions) The PBRadii is assigned Topologies are converted with parmed or generated with tleap The following figure shows the process to generate AMBER topologies depending on the force field. Figure 1 . Topology generation workflow for Single Trajectory Approximation","title":"How gmx_MMPBSA works"},{"location":"howworks/#how-gmx_mmpbsa-works","text":"gmx_MMPBSA is a new tool based on AMBER's MMPBSA.py aiming to perform end-state free energy calculations with GROMACS files. But, what does that mean? Basically, gmx_MMPBSA brings in all the MMPBSA.py functionalities to GROMACS users. MMPBSA.py is an excellent and well-known tool to perform calculations with the PB and GB models in AMBER (February/2021 more than 1200 citations). On the other hand, there are tools like g_mmpbsa that are well known in the GROMACS community (February/2021 more than 1100 citations). Interestingly, MMPBSA.py is more robust and was published first, however, both have a similar number of citations. This is probably due to the fact that the GROMACS (Open source and free) community is large, while AMBER has the restriction of a paid license, or a small community with free academic license. The use of MMPBSA.py for GROMACS users requires enormous effort to successfully complete the process. In that regard, we have decided to make our experience in this process available to the community. We have not limited ourselves only to the extent of utility itself, but added additional value. We have designed a tool that allows to perform a number of calculations in an effortless way with a graphical tool incorporated, which we believe has great potential for the analysis of the results obtained. We also have incorporated some functionalities that aren't present in MMPBSA.py and made others more accessible to the beginner user in Amber.","title":"How gmx_MMPBSA works"},{"location":"howworks/#gmx_mmpbsa-general-workflow","text":"gmx_MMPBSA functioning can be divided into 3 parts as shown in figure 1. In the first part, Preparation , the topologies and trajectories are generated, among other elements depending on the calculations, such as the mutants for the alanine or glycine scanning or the interaction residues during decomposition analysis. In the second part, Calculation , the binding free energies and/or entropies are estimated using the selected models. Finally, in the last step Analysis , the results can be analyzed by using the graphical user interface gmx_MMPBSA_ana . Figure 1 . gmx_MMPBSA general workflow","title":"gmx_MMPBSA general workflow"},{"location":"howworks/#required-input-files","text":"Currently, gmx_MMPBSA supports two families of force fields: Amber and CHARMM. Although these force fileds are quite similar, the generation of topologies differs. When Amber force filed was used to prepare the system(s), the topologies compatible with AMBER package can be generated from either GROMACS topologies or structures. Meanwhile, when CHARMM force field is used, AMBER's topologies are generated from GROMACS topologies exclusively. (Table 1). Table 1: Required input files for every force field Force field Structure Index Trajectory Topology Reference Structure Small Molecule Mol2 AMBER tpr, gro, pdb ndx xtc, trr, pdb, gro Optional Optional Only if not top CHARMM tpr, gro, pdb ndx xtc, trr, pdb, gro Always Optional No","title":"Required input files"},{"location":"howworks/#topology-preparation","text":"In this section, we will go in detail about each file and what they are used for. GROMACS files MD Structure+mass(db) (tpr, pdb, gro): This file is used to generate the structure in pdb format of the complex with editconf . We recommend using the *.tpr (production *.tpr) format. Index (ndx) This the file that contains the index of each element contained in the *.tpr file, organized as groups. This file is required for the definition of the groups corresponding to the receptor and the ligand. Trajectory (xtc, trr, pdb, gro) Trajectory files. Topology (top) This file contains all the parameters corresponding to the force field selected during the system setup. When using a GROMACS topology, parmed is used for converting the topologies. This method can be useful when studying a complex system with many elements. However, its main strength (flexibility) is its main weakness. GROMACS can parameterize your system differently than AMBER, so the conversion can result in a topology with very dissimilar parameters that AMBER does not understand. If you use amber, you can consider whether to use this method or not. However, when using CHARMM (any version) force field, the topology is always required. Reference Structure It corresponds to a file in *.pdb format that must contain a complete structure. That is, the user must make sure that this structure contains the same number of atoms and residues as the complex that he initially defined, the correct residue numbering, as well as its chain ID. This structure is optional, but we recommend using it since it should guarantee a smooth processing of the files in gmx_MMPBSA . Essentially, the objective is to be able to correctly assign the mentioned parameters since internally gmx_MMPBSA handles sensitive information, for example: when it extracts the receptor and the ligand from the complex structure, the mutation in the alanine scan, etc. Small molecule parameters (mol2) This file contains a ligand parameterization with antechamber that is not found in the selected force field (Amber family). It is only necessary to define it when studying a system that contains this type of ligand, and a topology has not been defined. This is used to build amber topology from structure using tleap . Here are the steps that gmx_MMPBSA follows to generate the topologies: Specific steps for the topology are highlighted like this Generates a new index and registers the groups defined by the user Generates the pdb of the complex, receptor, and ligand Topologies are cleaned (remove water and ions) The structures or parameters for the receptor and the ligand are generated if it is a ST approximation. If Alanine scanning: the mutant of the complex, and the mutant receptor or ligand are generated If decomposition: interaction residues are extracted The complex is mapped. Registers the continuity of the receptor (example: Metalloprotein structure files are generally structured as follows: Receptor protein + Ligand + Receptor Ions) The PBRadii is assigned Topologies are converted with parmed or generated with tleap The following figure shows the process to generate AMBER topologies depending on the force field. Figure 1 . Topology generation workflow for Single Trajectory Approximation","title":"Topology preparation"},{"location":"input_file/","text":"The input file \u00b6 Description \u00b6 As gmx_MMPBSA is based on MMPBSA.py , it uses an input file containing all the specification for the MM/PB(GB)SA calculation. The input file is designed to be as syntactically similar to other programs in Amber as possible. The input file has the same namelist structure as both sander and pmemd. The allowed namelists are: &general : are typically variables that apply to all aspects of the calculation or parameters required for build amber topologies from GROMACS files. &gb : unique to Generalized Born (GB) calculations &pb : unique to Poisson Boltzmann (PB) calculations &alanine_scanning : unique to alanine scanning calculations &decomp : unique to the decomposition scheme &nmode : unique to the normal mode (NMODE) calculations used to approximate vibrational entropies &rism : unique to 3D-RISM calculations Calculations namelist \u00b6 &general namelist variables \u00b6 sys_name (Default = None) (Optional) Define the System Name. This is useful when trying to analyze several systems at the same time or calculating the correlation between the predicted and the experimental energies. If the name is not defined, one will be assigned when loading it in gmx_MMPBSA_ana according to the order in this is done. Tip The definition of the system name is entirely optional, however it can provide a better clarity during the results analysis. All files associated with this system will be saved using its name. New in v1.4.0 startframe (Default = 1) The frame from which to begin extracting snapshots from the full, concatenated trajectory comprised of every trajectory file placed on the command-line. This is always the first frame read. endframe (Default = 9999999) The frame from which to stop extracting snapshots from the full, concatenated trajectory comprised of every trajectory file supplied on the command-line. forcefields (Default = \"oldff/leaprc.ff99SB,leaprc.gaff\") Comma-separated list of force fields used to build Amber topologies. This variable is more flexible than the previous ones ( protein_forcefield and ligand_forcefield ). The goal of this variable is to provide convenient support for complex systems like this one: 5O8F . It supports all force fields tested in previous protein_forcefield and ligand_forcefield variables. Tip The value of this variable depends on the force field you used for your system in GROMACS You don't need to define forcefields` variable when you using a topology. Please refer to the section \"How gmx_MMPBSA works\" The notation format is the one used in tleap In general, any forcefield present in $AMBERHOME/dat/leap/cmd could be use with forcefields variable Be cautious when defining this variable since you can define two forces fields with a similar purpose which can generate inconsistencies. Input files samples: Protein and/or Nucleic acids Protein only Protein + DNA Protein + RNA + Organic mol. Input file with forcefield variable defined for a system with protein and/or nucleic acids &general forcefields=\"oldff/leaprc.ff99SB\" / Input file with forcefield variable defined for a system with only protein &general forcefields=\"leaprc.protein.ff14SB\" / Input file with forcefield variable defined for a system with protein and nucleic acids (DNA) &general forcefields=\"leaprc.protein.ff14SB,leaprc.DNA.bsc1\" / Input file with forcefield variable defined for a system with protein, nucleic acids (RNA) and a organic molecule &general forcefields=\"leaprc.protein.ff14SB,leaprc.RNA.OL3,leaprc.gaff2\" / Forcefields for Protein/Nucleic Acids together Name Description \"oldff/leaprc.ff99\" ff99 for proteins and nucleic acids \"oldff/leaprc.ff03\" ff03 (Duan et al.) for proteins and nucleic acids \"oldff/leaprc.ff99SB\" ff99SB for proteins and nucleic acids \"oldff/leaprc.ff99SBildn\" ff99SB modified for the \"ILDN\" changes for proteins and nucleic acids \"oldff/leaprc.ff99bsc0\" ff99SB force field using parmbsc0 for nucleic acid Forcefields only for proteins Name Description \"leaprc.protein.ff14SB\" ff14SB only for proteins \"leaprc.protein.ff19SB\" ff19SB only for proteins Forcefields only for Nucleic Acids Name Description \"leaprc.DNA.bsc1\" ff99bsc0+bsc1 only for DNA \"leaprc.DNA.OL15\" ff99bsc0+OL15 only for DNA \"leaprc.RNA.OL3\" ff99bsc0_chiOL3 only for RNA Forcefields for organic molecules, glycans and zwitterionic amino acids Name Description \"leaprc.gaff\" General Amber Force Field for organic molecules \"leaprc.gaff2\" General Amber Force Field 2 for organic molecules \"leaprc.GLYCAM_06j-1\" Glycam_06j-1 carbohydrate ff ( Compatible with ff12SB and later ) \"leaprc.GLYCAM_06EPb\" GLYCAM-06EPb carbohydrate ff ( Compatible with ff12SB and later ) \"gmxMMPBSA/leaprc.GLYCAM_06h-1\" * GLYCAM-0606h-1 carbohydrate ff ( Compatible with ff99SB and earlier ) \"gmxMMPBSA/leaprc.zaa99SB\" * Force field for Zwitterionic amino acids ( Compatible with ff99SB ) Tip * We added the gmxMMPBSA data to the tleap path. This way, we keep gmx_MMPBSA data separated from Amber's. New in v1.4.1 Modiefied in v1.4.3. Internal change Updated in v1.5.0: Documentation updated ions_parameters (Default = 1) Define ions parameters to build the Amber topology. 1: frcmod.ions234lm_126_tip3p 2: frcmod.ions234lm_iod_tip4pew 3: frcmod.ions234lm_iod_spce 4: frcmod.ions234lm_hfe_spce 5: frcmod.ions234lm_126_tip4pew 6: frcmod.ions234lm_126_spce 7: frcmod.ions234lm_1264_tip4pew 8: frcmod.ions234lm_1264_tip3p 9: frcmod.ions234lm_1264_spce 10: frcmod.ions234lm_iod_tip3p 11: frcmod.ions234lm_hfe_tip4pew 12: frcmod.ions234lm_hfe_tip3p Keep in mind You don't need to define it when you use a topology. Please refer to the section \"How gmx_MMPBSA works\" This notation is simpler since these parameter files are generally the same for all systems interval (Default = 1) The offset from which to choose frames from each trajectory file. For example, an interval of 2 will pull every 2 nd frame beginning at startframe and ending less than or equal to endframe. PBRadii (Default = 3) PBRadii to build amber topology files: 1: bondi, recommended when igb = 7 2: mbondi, recommended when igb = 1 3: mbondi2, recommended when igb = 2 or 5 4: mbondi3, recommended when igb = 8 qh_entropy (Default = 0) It specifies whether to perform a quasi-harmonic entropy (QH) approximation with ptraj or not. 0: Don\u2019t 1: perform QH New in v1.4.2: Equivalent to (Removed) entropy = 1 interaction_entropy (default = 0) It specifies whether to use the Interaction Entropy (IE) approximation. 0: Don\u2019t 1: perform IE Keep in mind The standard deviation of the interaction energy (\u03c3IE) should always be reported when using the Interaction Entropy method. The Interaction Entropy method should be avoided if \u03c3IE > ~ 3.6 kcal/mol because it is impossible to converge the exponential average. It is advisable to study how the Interaction Entropy depends on N by block averaging (which also provide an estimate of the precision of the calculated entropies). A sampling frequency of 10 fs, as reported in the original IE publication , seems to be 3\u201340 times too dense. A sampling frequency of 0.1 ps would be more appropriate. The Interaction Entropy results may vary depending on the system flexibility or whether constraints were used or not in the MD simulation. Please, consult this paper for further details. New in v1.4.2: Equivalent to (Removed) entropy = 2 Updated in v1.5.0: Now reports the \u03c3IE and the warning related to it. Chart improved in gmx_MMPBSA_ana ie_segment (Default = 25) Representative segment (in %), starting from the last frame, for the calculation of the Interaction Entropy, e.g. : ie_segment = 25 means that the last quartile of the total number of frames ( (endframe-startframe)/interval ) will be used to calculate the average Interaction Entropy. New in v1.4.2 c2_entropy (default = 0) It specifies whether to use the C2 Entropy approximation. 0: Don\u2019t 1: perform C2 Keep in mind The standard deviation of the interaction energy (\u03c3IE) should always be reported. The C2 Entropy method should be avoided if \u03c3IE > ~ 6 kcal/mol because it gives unrealistically large entropies. It is advisable to study how the C2 Entropy depends on N by block averaging (which also provide an estimate of the precision of the calculated entropies). A sampling frequency of 10 fs, seems to be 3\u201340 times too dense. A sampling frequency of 0.1 ps would be more appropriate. The C2 Entropy results may vary depending on the system flexibility or whether constraints were used or not in the MD simulation. Please, consult this paper for further details. New in v1.5.0 c2_segment (Default = 25) Representative segment (in %), starting from the last frame, for the calculation of the C2 Entropy, e.g. : ie_segment = 25 means that the last quartile of the total number of frames ( (endframe-startframe)/interval ) will be used to calculate the C2 Entropy. New in v1.5.0 temperature (Default = 298.15) Specify the temperature to calculate experimental \u0394G from Ki and the Interaction Entropy (Only if entropy = 2). Avoid inconsistencies with defined internal temperature (298.15 K) when nmode or qh are used. Keep in mind Note that the nmode as qh model to calculate the entropy term are parameterized and will only work at 298.15 K New in v1.4.0: Replace entropy_temp assign_chainID (Default = 0) Defines the chains ID assignment mode. It is ignored when defining a reference structure (recommended) . If assign_chainID = 1 , gmx_MMPBSA check if the structure has no chains ID and it is assigned according to the structure 1 . If assign_chainID = 2 , gmx_MMPBSA assign the chains ID, exist or not, according to the structure 1 (can generate inconsistencies). If a *.gro file was used for complex structure ( -cs flag) and not reference structure was provided, gmx_MMPBSA assume assign_chainID = 1 . New in v1.2.0 Updated in v1.5.0: Internal changes exp_ki (Default = 0.0) Specify the experimental Ki in nM for correlations analysis. If not defined or exp_ki = 0 then this system will be omitted in the correlation analysis New in v1.4.0 gmx_path Define a path to search for GROMACS executables. This path takes precedence over the path defined in the PATH variable. In this path the following executables will be searched: gmx , gmx_mpi , gmx_d , or gmx_mpi_d (GROMACS > 5.x.x), and make_ndx , editconf and trjconv (GROMACS 4.x.x) Keep in mind This variable is used when the GROMACS used to run the system differs from that of will be used for running the analyses. It takes the path to the GROMACS bin folder where the executables will be searched on. An example of the use of this variable is given below: &general sys_name=\"my_system\", verbose=2, forcefields=\"oldff/leaprc.ff99SBildn\",leaprc.gaff\" gmx_path=\"/home/programs/gromacs/bin\" / &gb igb=5, saltcon=0.150 / # replace this \"/home/programs/gromacs/bin\" with the path to the GROMACS you want to use. New in v1.1.1 netcdf (Default = 0) Specifies whether or not to use NetCDF trajectories internally rather than writing temporary ASCII trajectory files. For very large trajectories, this could offer significant speedups, and requires less temporary space. However, this option is incompatible with alanine scanning. 0: Do NOT use temporary NetCDF trajectories 1: Use temporary NetCDF trajectories solvated_trajectory (Default = 1) Define if it is necessary to build a clean trajectory with no water and ions 0: Don\u2019t 1: Build clean trajectory New in v1.3.0 Updated in v1.5.0. Bugs fixed use_sander (Default = 0) use sander for energy calculations, even when mmpbsa_py_energy will suffice 0: Use mmpbsa_py_energy when possible 1: Always use sander Note Sander is always used when building the Amber topology from a Gromacs topology. This, because the conversion can generate parameters that are not recognized by mmpbsa_py_energy debug_printlevel gmx_MMPBSA prints errors by raising exceptions, and not catching fatal errors. If debug_printlevel is set to 0, then detailed tracebacks (effectively the call stack showing exactly where in the program the error occurred) is suppressed, so only the error message is printed. If debug_printlevel is set to 1 or higher, all tracebacks are printed, which aids in debugging of issues. (Default = 0) (Advanced Option) Changed in v1.2.0: Now gmx_MMPBSA shows the command-line used to build AMBER topologies when debug_printlevel = 1 or higher Deprecate in v1.5.0: Since we improved logging, this variable is not needed verbose (Default = 1) The variable that specifies how much output is printed in the output file. There are three allowed values: 0: print difference terms 1: print all complex, receptor, and ligand terms 2: also print bonded terms if one trajectory is used &gb namelist variables \u00b6 intdiel (Default = 1.0) Define Internal dielectric constant without use external *.mdin file igb (Default = 5) Generalized Born method to use (see Section 4 ). Allowed values are 1, 2, 5, 7 and 8 Note All models are now available with both mmpbsa_py_energy and sander saltcon (Default = 0.0) Salt concentration in Molarity. surfoff (Default 0.0) Offset to correct (by addition) the value of the non-polar contribution to the solvation free energy term surften (Default = 0.0072) Surface tension value. Units in kcal/mol/\u00c5 2 molsurf (Default 0) Define the algorithm to calculate the surface area for the nonpolar solvation termWhen 0: LCPO (Linear Combination of Pairwise Overlaps) 1: molsurf algorithm probe (Default = 1.4) Radius of the probe molecule (supposed to be the size of a solvent molecule), in Angstroms, to use when determining the molecular surface. Note only applicable when molsurf is set to 1 msoffset (Default = 0) Offset to apply to the individual atomic radii in the system when calculating the molsurf surface. See the description of the molsurf action command in cpptraj . ifqnt (Default = 0) Specifies whether a part of the system is treated with quantum mechanics. 0: Potential function is strictly classical 1: Use QM/MM Note This functionality requires sander qm_residues Complex residues to treat with quantum mechanics. All residues treated with quantum mechanics in the complex must be treated with quantum mechanics in the receptor or ligand to obtain meaningful results. This notation is the same used for print_res variable Notation: [ CHAIN /( RESNUM or RESNUM-RESNUM ) ] Treat with quantum mechanics residues individual or ranges. This notation also supports insertion codes, in which case you must define them individually Example qm_residues=\"A/1,3-10,15,100\" This treat with quantum mechanic Chain A residues 1, 3 through 10, 15, and 100 from the complex topology file and the corresponding residues in either the ligand and/or receptor topology files. Suppost that we can have the following sequence: A:LEU:5, A:GLY:6:A, A:THR:6:B, A:SER:6:C A:ASP:6D, A:ILE:7 Right notation Wrong notation Ranges selection qm_residues=\"A/5-7 Will treat with quantum mechanic all mentioned residues because all residues with insertion code are contained in the range Individual selection qm_residues=\"A/5,6:B,6:C,7 Will treat with quantum mechanic all mentioned residues except the residues A:6:A and A:6:D Multiple chain selection qm_residues=\"A/5-10,100 B/34,56 Will treat with quantum mechanic residues 3 through 10, 100 from chain A and residues 34 and 56 from Chain B. qm_residues=\"A/5-6B,6D-7 Will end in error. qm_theory Which semi-empirical Hamiltonian should be used for the quantum calculation. Options are PM3, AM1, MNDO, PDDG-PM3, PM3PDDG, PDDG-MNDO, PDDGMNDO, PM3-CARB1, PM3CARB1, DFTB, SCC-DFTB, RM1, PM6, PM3-ZnB, PM3-MAIS, PM3ZNB, MNDO/D, MNDOD. The dispersion correction can be switched on for AM1 and PM6 by choosing AM1-D* and PM6-D, respectively. The dispersion and hydrogen bond correction will be applied for AM1-DH+ and PM6-DH+. Danger No default, this must be specified if QM/MM calculations are going to be performed. qmcharge_com (Default = 0) The charge of the quantum section for the complex. qmcharge_lig (Default = 0) The charge of the quantum section of the ligand. qmcharge_rec (Default = 0) The charge of the quantum section for the receptor. qmcut (Default = 9999.0) The cutoff for the qm/mm charge interactions. &pb namelist variables \u00b6 Note PB calculations can be performed either with mmpbsa_py_energy or sander . Of note, mmpbsa_py_energy works with a lower number of variables compared to sander . Nevertheless, mmpbsa_py_energy will suffice for most routine applications of PB. mmpbsa_py_energy variables: inp , smoothopt , radiopt , npbopt , solvopt , maxitn (linit) , nfocus , fscale , epsin (indi) , epsout (exdi) , istrng , dprob (prbrad) , iprob , accept , fillratio , space (1/scale) , bcopt , eneopt , cutnb , sprob , cavity_surften , cavity_offset On the other hand, sander offers access to all pbsa functionalities. sander variables: ntb , cut , nsnb , imin , maxcyc , ipb , inp , ioutfm , ntx , epsin (indi) , epsout (exdi) , istrng , radiopt , sprob , dprob (prbrad) , space (1/scale) , maxitn (linit) , cavity_surften , cavity_offset , fillratio , epsmem (emen) , membraneopt (memopt) , sasopt , mthick , maxarcdot , solvopt , nfocus , bcopt , eneopt , frcopt , cutfd , cutnb , mctrdz , poretype , npbverb , npbopt , pbtemp0 , iprob , arcres , mprob , accept , nbuffer , npbgrid , scalec , nsnba , phiout , phiform , decompopt , use_rmin , vprob , rhow_effect , use_sav , maxsph Hereafter, a selected group of variables is presented, which should suffice for most PB calculations. The default values for these parameters are appropriate for most calculations on solvated molecular systems. Also note that the default options may have changed over time. A more thorough description of all the options can be found here . For a detailed discussion of all related options on the quality of the MM/PB(GB)SA calculations, please check this publication . npbopt (Default = 0) Option to select the linear, or the full nonlinear PB equation. 0: Linear PB equation is solved 1: Nonlinear PB equation is solved Note While the linear PB equation will suffice for most calculations, the nonlinear PB equation is recommended for highly charged systems. It is supported in both mmpbsa_py_energy and sander . Parameters such as eneopt or cutnb should be adjusted accordingly when using the nonlinear PB equation. Check the following threads on how to proceed in mmbsa_py_energy or sander when using the nonlinear PB equation. Last but not least, take into account that using nonlinear PB equation can significantly increase the calculation time required for PB calculation. inp (Default = 2) Option to select different methods to compute non-polar solvation free energy. 0: No non-polar solvation free energy is computed 1: The total non-polar solvation free energy is modeled as a single term linearly proportional to the solvent accessible surface area, as in the PARSE parameter set, that is, if INP = 1, USE_SAV must be equal to 0. 2: The total non-polar solvation free energy is modeled as two terms: the cavity term and the dispersion term. The dispersion term is computed with a surface-based integration method closely related to the PCM solvent for quantum chemical programs. Under this framework, the cavity term is still computed as a term linearly proportional to the molecular solvent-accessible-surface area (SASA) or the molecular volume enclosed by SASA. cavity_offset (Default = -0.5692) Offset value used to correct non-polar free energy contribution. Note This is not used for APBS cavity_surften (Default = 0.0378 [ kcal/mol \u00c5 2 ] ) Surface tension. Unit conversion to kJ done automatically for APBS . exdi (Default = 80.0) External dielectric constant. This corresponds to epsout in pbsa . indi (Default = 1.0) Internal dielectric constant. This corresponds to epsin in pbsa . fillratio (Default = 4.0) The ratio between the longest dimension of the rectangular finite-difference grid and that of the solute. scale (Default = 2.0) Resolution of the Poisson Boltzmann grid. It is equal to the reciprocal of the grid spacing ( space in pbsa ). istrng (Default = 0.0) Ionic strength in Molarity. It is converted to mM for PBSA and kept as M for APBS . linit (Default = 1000) Maximum number of iterations of the linear Poisson Boltzmann equation to try. This corresponds to maxitn in pbsa . prbrad (Default = 1.4) Solvent probe radius in Angstroms. Allowed values are 1.4 and 1.6. This corresponds to dprob in pbsa . radiopt (Default = 1) The option to set up atomic radii according to: 0: the prmtop, or 1: pre-computed values Warning radiopt=0 is recommended which means using radii from the prmtop file for both the PB calculation and for the NP. Check this thread and See Amber manual for more complete description. sander_apbs (Default = 0) Option to use APBS for PB calculation instead of the built-in PBSA solver. This will work only through the iAPBS interface built into sander.APBS . Instructions for this can be found online at the iAPBS/APBS websites. 0: Don\u2019t use APBS 1: Use sander.APBS memopt (Default = 0) Turn on membrane protein support. This corresponds to membraneopt in pbsa . emem (Default = 1.0) Membrane dielectric constant. This corresponds to epsmem in pbsa . mthick (Default = 40.0) Membrane thickness. mctrdz (Default=0.0, use protein center as the membrane center) Absolute membrane center in the z-direction. poretype (Default=1) Turn on the automatic membrane channel/pore finding method. &alanine_scanning namelist variables \u00b6 mutant_only (Default = 0) Option to perform specified calculations only for the mutants. 0: Do mutant and original 1: Do mutant only Note Note that all calculation details are controlled in the other namelists, though for alanine scanning to be performed, the namelist must be included (blank if desired) mutant (Default = \"ALA\") Defines the residue by which it is going to mutate. Allowed values are: \"ALA\" or \"A\" for Alanine scanning and \"GLY\" or \"G\" for Glycine scanning. Changed in v1.3.0: Change mol (receptor or ligand) by mutant aminoacid (ALA or GLY) mutant_res (Default = None. Most be defined) Define the specific residue that is going to be mutated. Use the following format CHAIN:RESNUM (eg: 'A:350') or CHAIN:RESNUM:INSERTION_CODE if applicable (eg: \"A:27:B\"). Important Only one residue for mutation is supported! We recommend using the reference structure (-cr) to ensure the perfect match between the selected residue in the defined structure or topology This option allow gmx_MMPBSA to do the mutation. This way the user does not have to provide the mutant topology Changed in v1.4.0: Allow mutation in antibodies since it support insertion code notation cas_intdiel (Default = 0) The dielectric constant ( intdiel (GB)/ indi (PB)) will be modified depending on the nature of the residue to be mutated. 0: Don\u2019t 1: Adaptative intdiel assignation Important Works with the GB and PB calculations It is ignored when intdiel (GB)/ indi (PB) has been explicitly defined, that is, it is ignored if intdiel != 1.0 / indi != 1.0 (default values) Dielectric constant values has been assigned according to Yan et al., 2017 New in v1.4.2 intdiel_nonpolar (Default = 1) Define the intdiel (GB)/ indi (PB) value for nonpolar residues ( PHE , TRP , VAL , ILE , LEU , MET , PRO , CYX , ALA , GLY , PRO ) New in v1.4.2 intdiel_polar (Default = 3) Define the intdiel (GB)/ indi (PB) value for polar residues ( TYR , SER , THR , CYM , CYS , HIE , HID , ASN , GLN , ASH , GLH , LYN ) New in v1.4.2 intdiel_positive (Default = 5) Define the intdiel (GB)/ indi (PB) value for positive charged residues ( LYS , ARG , HIP ) New in v1.4.2 intdiel_negative (Default = 5) Define the intdiel (GB)/ indi (PB) value for negative charged residues ( GLU , ASP ) New in v1.4.2 &nmode namelist variables \u00b6 dielc (Default = 1.0) Distance-dependent dielectric constant drms (Default = 0.001) Convergence criteria for minimized energy gradient. maxcyc (Default = 10000) Maximum number of minimization cycles to use per snapshot in sander. nminterval 2 (Default = 1) Offset from which to choose frames to perform nmode calculations on nmendframe 2 (Default = 1000000) Frame number to stop performing nmode calculations on nmode_igb (Default = 1) Value for Generalized Born model to be used in calculations. Options are: 0: Vacuum 1: HCT GB model nmode_istrng (Default = 0.0) Ionic strength to use in nmode calculations. Units are Molarity. Non-zero values are ignored if nmode_igb is 0 above. nmstartframe 2 Frame number to begin performing nmode calculations on &decomp namelist variables \u00b6 csv_format (Default = 1 [CSV-formatted output file]) Print the decomposition output in a Comma-Separated-Variable (CSV) file. CSV files open natively in most spreadsheets. * If set to 1, this variable will cause the data to be written out in a CSV file, and standard error of the mean will be calculated and included for all data. * If set to 0, the standard, ASCII format will be used for the output file. dec_verbose (Default = 0) Set the level of output to print in the decomp_output file. 0: DELTA energy, total contribution only 1: DELTA energy, total, sidechain, and backbone contributions 2: Complex, Receptor, Ligand, and DELTA energies, total contribution only 3: Complex, Receptor, Ligand, and DELTA energies, total, sidechain, and backbone contributions Note If the values 0 or 2 are chosen, only the Total contributions are required, so only those will be printed to the mdout files to cut down on the size of the mdout files and the time required to parse them. idecomp Energy decomposition scheme to use: 1: Per-residue decomp with 1-4 terms added to internal potential terms 2: Per-residue decomp with 1-4 EEL added to EEL and 1-4 VDW added to VDW potential terms. 3: Pairwise decomp with 1-4 terms added to internal potential terms 4: Pairwise decomp with 1-4 EEL added to EEL and 1-4 VDW added to VDW potential terms Warning No default. This must be specified!. print_res (Default = \"within 6\") Select residues from the complex to print. The default selection should be sufficient in most cases, however we have added several additional notations By Distance Amino acid selection All Notation: [ within distance ] within corresponds to the keyword and distance to the maximum distance criterion in Angstroms necessary to select the residues from both the receptor and the ligand Example print_res=\"within 6\" Will print all residues within 6 Angstroms between receptor and ligand including both. Notation: [ CHAIN /( RESNUM or RESNUM-RESNUM ) ] Print residues individual or ranges. This notation also supports insertion codes, in which case you must define them individually Example print_res=\"A/1,3-10,15,100 B/25\" This will print Chain A residues 1, 3 through 10, 15, and 100 along with chain B residue 25 from the complex topology file and the corresponding residues in either the ligand and/or receptor topology files. Danger make sure to include at least one residue from both the receptor and ligand in the print_res mask of the &decomp section. Check http://archive.ambermd.org/201308/0075.html Suppost that we can have the following sequence where chain A is the receptor and B is the ligand: A:LEU:5, A:GLY:6:A, A:THR:6:B, A:SER:6:C A:ASP:6D, A:ILE:7 , B:25 Supported notation Wrong notation Ranges selection print_res=\"A/5-7 B/25 Will print all mentioned residues because all residues with insertion code are contained in the range Individual selection print_res=\"A/5,6:B,6:C,7 B/25 Will print all mentioned residues except the residues A:6:A and A:6:D print_res=\"A/5-6B,6D-7 Will end in error. Notation: all will print all residues. This option is often not recommended since most residues contribution is zero and it is just going to be a waste of time and computational resources. Danger Using idecomp=3 or 4 (pairwise) with a very large number of printed residues and a large number of frames can quickly create very, very large temporary mdout files. Large print selections also demand a large amount of memory to parse the mdout files and write decomposition output file (~500 MB for just 250 residues, since that\u2019s 62500 pairs!) It is not unusual for the output file to take a significant amount of time to print if you have a lot of data. This is most applicable to pairwise decomp, since the amount of data scales as O(N 2 ). Important We recommend using the reference structure (-cr) to ensure the perfect match between the selected residue in the defined structure or topology Changed in v1.4.0: Improve residue selection &rism namelist variables \u00b6 Warning 3D-RISM calculations are performed with the rism3d.snglpnt program built with AmberTools, written by Tyler Luchko. It is the most expensive, yet most statistical mechanically rigorous solvation model. See RISM chapter for a thorough description of options and theory. A list of references can be found there, too. We have included more variables in 3D-RISM calculations than the ones available in the MMPBSA.py original code. That way, users can be more in control and tackle various issues (e.g., convergence problems). 3D-RISM variables and their default values: closureorder= 1 , asympcorr= 1 , buffer= 14.0 , solvcut= None (If -1 or no value is specified then the buffer distance is used) , grdspc= 0.5,0.5,0.5 , ng= -1,-1,-1 , solvbox= -1,-1,-1 , tolerance= 0.00001 (1.0e-5) , mdiis_del= 0.7 , mdiis_restart= 10.0 , mdiis_nvec= 5 , maxstep= 10000 , npropagate= 5 , centering= 1 , polarDecomp= 0 , entropicDecomp= 0 , gf= 0 , pc+= 0 , uccoeff= 0.0,0.0,0.0,0.0 , rism_verbose= 0 , treeDCF= 1 , treeTCF= 1 , treeCoulomb= 0 , treeDCFOrder= 2 , treeTCFOrder= 2 , treeCoulombOrder= 2 , treeDCFN0= 500 , treeTCFN0= 500 , treeCoulombN0= 500 , treeDCFMAC= 0.1 , treeTCFMAC= 0.1 , treeCoulombMAC= 0.1 , asympKSpaceTolerance= -1.0 , ljTolerance= -1.0 One advantage of 3D-RISM is that an arbitrary solvent can be chosen; you just need to change the xvvfile specified on the command line (see 34.3.2 ). buffer (Default = 14 \u00c5) Minimum distance between solute and edge of solvation box. Specify this with grdspc below. Mutually exclusive with ng and solvbox. Set buffer < 0 if you wish to use ng and solvbox . closure (Default = \"kh\") The approximation to the closure relation. Allowed choices are kh (Kovalenko-Hirata), hnc (Hypernetted- chain), or psen (Partial Series Expansion of order-n) where \"n\" is a positive integer ( e.g. , \"pse3\"). Deprecated closureorder (Default = 1) The order at which the PSE-n closure is truncated if closure is specified as \"pse\" or \"psen\" (no integers). grdspc (Default = 0.5 \u00c5) Grid spacing of the solvation box. Specify this with buffer above. Mutually exclusive with ng and solvbox . ng Number of grid points to use in the x, y, and z directions. Used only if buffer < 0. Mutually exclusive with buffer and grdspc above, and paired with solvbox below. Warning No default, this must be set if buffer < 0. Define like ng=1000,1000,1000 solvbox Length of the solvation box in the x, y, and z dimensions. Used only if buffer < 0. Mutually exclusive with buffer and grdspc above, and paired with ng above. Warning No default, this must be set if buffer < 0. Define like solvbox=20,20,20 polardecomp (Default = 0) Decompose the solvation free energy into polar and non-polar contributions. Note that this will increase computation time by roughly 80%. 0: Don\u2019t decompose solvation free energy. 1: Decompose solvation free energy. rism_verbose (Default = 0) Level of output in temporary RISM output files. May be helpful for debugging or following convergence. 0: just print the final result 1: additionally prints the total number of iterations for each solution 2: additionally prints the residual for each iteration and details of the MDIIS solver (useful for debugging and convergence analyses) solvcut (Default = buffer ) Cutoff used for solute-solvent interactions. The default is the value of buffer. Therefore, if you set buffer < 0 and specify ng and solvbox instead, you must set solvcut to a nonzero value, or the program will quit in error. thermo (Default = \"std\") Which thermodynamic equation you want to use to calculate solvation properties. Options are \"std\", \"gf\", or \"both\" (case-INsensitive). \"std\" uses the standard closure relation, \"gf\" uses the Gaussian Fluctuation approximation, and \"both\" will print out separate sections for both. Note Note that all data are printed out for each RISM simulation, so no choice is any more computationally demanding than another. tolerance (Default = 1e-5) Upper bound of the precision requirement used to determine convergence of the self-consistent solution. This has a strong effect on the cost of 3D-RISM calculations (smaller value for tolerance -> more computation). Generation \u00b6 The input file can be created using gmx_MMPBSA selecting the calculations you wish to perform. Command-line gmx_MMPBSA --create_input args Example: GB calculation PB calculation GB, PB and Decomposition calculation All calculations gmx_MMPBSA --create_input gb gmx_MMPBSA --create_input pb gmx_MMPBSA --create_input gb pb decomp gmx_MMPBSA --create_input or gmx_MMPBSA --create_input all Danger Note that several variables must be explicitly defined New in v1.5.0 Format \u00b6 All of the input variables are described below according to their respective namelists. Integers and floating point variables should be typed as-is while strings should be put in either single- or double-quotes. All variables should be set with variable = value and separated by commas is they appear in the same line. If the variables appear in different lines, the comma is no longer needed. See several examples below. As you will see, several calculations can be performed in the same run ( i.e. &gb and &pb , &gb and &alanine_scanning , &pb and &decomp , etc). As we have mentioned, the input file can be generated using the create_input option of gmx_MMPBSA. This style, while retaining the same Amber format (derived from Fortran), is aesthetically more familiar to the GROMACS style (*.mdp). However, it maintains the same essence, so it could be defined in any of the two format styles or even combined. See the formats below: New format style Old format style New format style Input file example # General namelist variables &general # System name sys_name = \"\" # First frame to analyze startframe = 1 # Last frame to analyze endframe = 9999999 ... # How many energy terms to print in the final output verbose = 1 / # Generalized-Born namelist variables &gb # GB model to use igb = 5 ... # Solvent probe radius for surface area calc probe = 1.4 / Old format style Input file example # General namelist variables &general sys_name = \"\", startframe = 1, endframe = 9999999 ... verbose = 1 / # Generalized-Born namelist variables &gb igb = 5, ... probe = 1.4 / Sample input files \u00b6 Tip You can refer to the examples to understand the input file in a practical way. GB and PB \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Sample input file for GB and PB calculation building the Amber topologies from structures. Please refer to the section \"How gmx_MMPBSA works\" &general startframe=5, endframe=100, interval=5, verbose=2, protein_forcefield=\"oldff/leaprc.ff99SB\", ligand_forcefield=\"leaprc.gaff\" / &gb igb=5, saltcon=0.150, / &pb istrng=0.15, fillratio=4.0 / Alanine scanning \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 Sample input file for Alanine scanning &general startframe=5, endframe=21, verbose=2, interval=1, protein_forcefield=\"oldff/leaprc.ff99SB\", PBRadii=4 / &gb igb=8, saltcon=0.150, intdiel=10 / &alanine_scanning mutant='ALA', mutant_res='B:12' / Entropy \u00b6 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 Sample input file for entropy calculations &general startframe=5, endframe=21, verbose=2, interval=1, # `entropy` variable control whether to perform a quasi-harmonic entropy (QH) # or the Interaction Entropy (IE) # (https://pubs.acs.org/doi/abs/10.1021/jacs.6b02682) approximation protein_forcefield=\"oldff/leaprc.ff99SB\", entropy=2, entropy_seg=25, temperature=298 / &gb igb=2, saltcon=0.150, / uncomment the next 4 lines for normal mode calculations #&nmode #nmstartframe=5, nmendframe=21, nminterval=2, #maxcyc=50000, drms=0.0001, #/ Decomposition analysis \u00b6 Sample input file with decomposition analysis Make sure to include at least one residue from both the receptor and ligand in the print_res mask of the &decomp section. http://archive.ambermd.org/201308/0075.html. This is automally guaranteed if use \"within\" keyword. &general startframe=5, endframe=21, interval=1, / &gb igb=5, saltcon=0.150, / &decomp idecomp=2, dec_verbose=3, # This will print all residues that are less than 4 angstroms between # the receptor and the ligand print_res=\"within 4\" / QM/MMGBSA \u00b6 Sample input file for QM/MMGBSA &general startframe=5, endframe=100, interval=5, / &gb igb=5, saltcon=0.100, ifqnt=1, qmcharge_com=0, qm_residues=\"B/240-251\", qm_theory=\"PM3\" / MM/3D-RISM \u00b6 Sample input file for 3D-RISM &general startframe=20, endframe=100, interval=5, / &rism polardecomp=1, thermo=\"gf\" / MMPBSA with membrane proteins \u00b6 Sample input file for MMPBSA with membrane proteins &general startframe=1, endframe=100, interval=1, debug_printlevel=2, use_sander=1, / &pb radiopt=0, indi=20.0, istrng=0.150, fillratio=1.25, ipb=1, nfocus=1, bcopt=10, eneopt=1, cutfd=7.0, cutnb=99.0, npbverb=1, solvopt=2, inp=2, memopt=1, emem=7.0, mctrdz=-10.383, mthick=36.086, poretype=1, maxarcdot=15000 / Info Comments are allowed by placing a # at the beginning of the line (whites-space are ignored). Variable initialization may span multiple lines. In-line comments ( i.e. , putting a # for a comment after a variable is initialized in the same line) is not allowed and will result in an input error. Variable declarations must be comma-delimited, though all whitespace is ignored. Finally, all lines between namelists are ignored, so comments can be added before each namelist without using #. The chain ID is assigned according to two criteria: terminal amino acids and residue numbering . If both criteria or residue numbering changes are present, we assign a new chain ID. If there are terminal amino acids but the numbering of the residue continues, we do not change the ID of the chain. \u21a9 \u21a9 These variables will choose a subset of the frames chosen from the variables in the &general namelist. Thus, the \"trajectory\" from which snapshots will be chosen for nmode calculations will be the collection of snapshots upon which the other calculations were performed. \u21a9 \u21a9 \u21a9","title":"The input file"},{"location":"input_file/#the-input-file","text":"","title":"The input file"},{"location":"input_file/#description","text":"As gmx_MMPBSA is based on MMPBSA.py , it uses an input file containing all the specification for the MM/PB(GB)SA calculation. The input file is designed to be as syntactically similar to other programs in Amber as possible. The input file has the same namelist structure as both sander and pmemd. The allowed namelists are: &general : are typically variables that apply to all aspects of the calculation or parameters required for build amber topologies from GROMACS files. &gb : unique to Generalized Born (GB) calculations &pb : unique to Poisson Boltzmann (PB) calculations &alanine_scanning : unique to alanine scanning calculations &decomp : unique to the decomposition scheme &nmode : unique to the normal mode (NMODE) calculations used to approximate vibrational entropies &rism : unique to 3D-RISM calculations","title":"Description"},{"location":"input_file/#calculations-namelist","text":"","title":"Calculations namelist"},{"location":"input_file/#general-namelist-variables","text":"sys_name (Default = None) (Optional) Define the System Name. This is useful when trying to analyze several systems at the same time or calculating the correlation between the predicted and the experimental energies. If the name is not defined, one will be assigned when loading it in gmx_MMPBSA_ana according to the order in this is done. Tip The definition of the system name is entirely optional, however it can provide a better clarity during the results analysis. All files associated with this system will be saved using its name. New in v1.4.0 startframe (Default = 1) The frame from which to begin extracting snapshots from the full, concatenated trajectory comprised of every trajectory file placed on the command-line. This is always the first frame read. endframe (Default = 9999999) The frame from which to stop extracting snapshots from the full, concatenated trajectory comprised of every trajectory file supplied on the command-line. forcefields (Default = \"oldff/leaprc.ff99SB,leaprc.gaff\") Comma-separated list of force fields used to build Amber topologies. This variable is more flexible than the previous ones ( protein_forcefield and ligand_forcefield ). The goal of this variable is to provide convenient support for complex systems like this one: 5O8F . It supports all force fields tested in previous protein_forcefield and ligand_forcefield variables. Tip The value of this variable depends on the force field you used for your system in GROMACS You don't need to define forcefields` variable when you using a topology. Please refer to the section \"How gmx_MMPBSA works\" The notation format is the one used in tleap In general, any forcefield present in $AMBERHOME/dat/leap/cmd could be use with forcefields variable Be cautious when defining this variable since you can define two forces fields with a similar purpose which can generate inconsistencies. Input files samples: Protein and/or Nucleic acids Protein only Protein + DNA Protein + RNA + Organic mol. Input file with forcefield variable defined for a system with protein and/or nucleic acids &general forcefields=\"oldff/leaprc.ff99SB\" / Input file with forcefield variable defined for a system with only protein &general forcefields=\"leaprc.protein.ff14SB\" / Input file with forcefield variable defined for a system with protein and nucleic acids (DNA) &general forcefields=\"leaprc.protein.ff14SB,leaprc.DNA.bsc1\" / Input file with forcefield variable defined for a system with protein, nucleic acids (RNA) and a organic molecule &general forcefields=\"leaprc.protein.ff14SB,leaprc.RNA.OL3,leaprc.gaff2\" / Forcefields for Protein/Nucleic Acids together Name Description \"oldff/leaprc.ff99\" ff99 for proteins and nucleic acids \"oldff/leaprc.ff03\" ff03 (Duan et al.) for proteins and nucleic acids \"oldff/leaprc.ff99SB\" ff99SB for proteins and nucleic acids \"oldff/leaprc.ff99SBildn\" ff99SB modified for the \"ILDN\" changes for proteins and nucleic acids \"oldff/leaprc.ff99bsc0\" ff99SB force field using parmbsc0 for nucleic acid Forcefields only for proteins Name Description \"leaprc.protein.ff14SB\" ff14SB only for proteins \"leaprc.protein.ff19SB\" ff19SB only for proteins Forcefields only for Nucleic Acids Name Description \"leaprc.DNA.bsc1\" ff99bsc0+bsc1 only for DNA \"leaprc.DNA.OL15\" ff99bsc0+OL15 only for DNA \"leaprc.RNA.OL3\" ff99bsc0_chiOL3 only for RNA Forcefields for organic molecules, glycans and zwitterionic amino acids Name Description \"leaprc.gaff\" General Amber Force Field for organic molecules \"leaprc.gaff2\" General Amber Force Field 2 for organic molecules \"leaprc.GLYCAM_06j-1\" Glycam_06j-1 carbohydrate ff ( Compatible with ff12SB and later ) \"leaprc.GLYCAM_06EPb\" GLYCAM-06EPb carbohydrate ff ( Compatible with ff12SB and later ) \"gmxMMPBSA/leaprc.GLYCAM_06h-1\" * GLYCAM-0606h-1 carbohydrate ff ( Compatible with ff99SB and earlier ) \"gmxMMPBSA/leaprc.zaa99SB\" * Force field for Zwitterionic amino acids ( Compatible with ff99SB ) Tip * We added the gmxMMPBSA data to the tleap path. This way, we keep gmx_MMPBSA data separated from Amber's. New in v1.4.1 Modiefied in v1.4.3. Internal change Updated in v1.5.0: Documentation updated ions_parameters (Default = 1) Define ions parameters to build the Amber topology. 1: frcmod.ions234lm_126_tip3p 2: frcmod.ions234lm_iod_tip4pew 3: frcmod.ions234lm_iod_spce 4: frcmod.ions234lm_hfe_spce 5: frcmod.ions234lm_126_tip4pew 6: frcmod.ions234lm_126_spce 7: frcmod.ions234lm_1264_tip4pew 8: frcmod.ions234lm_1264_tip3p 9: frcmod.ions234lm_1264_spce 10: frcmod.ions234lm_iod_tip3p 11: frcmod.ions234lm_hfe_tip4pew 12: frcmod.ions234lm_hfe_tip3p Keep in mind You don't need to define it when you use a topology. Please refer to the section \"How gmx_MMPBSA works\" This notation is simpler since these parameter files are generally the same for all systems interval (Default = 1) The offset from which to choose frames from each trajectory file. For example, an interval of 2 will pull every 2 nd frame beginning at startframe and ending less than or equal to endframe. PBRadii (Default = 3) PBRadii to build amber topology files: 1: bondi, recommended when igb = 7 2: mbondi, recommended when igb = 1 3: mbondi2, recommended when igb = 2 or 5 4: mbondi3, recommended when igb = 8 qh_entropy (Default = 0) It specifies whether to perform a quasi-harmonic entropy (QH) approximation with ptraj or not. 0: Don\u2019t 1: perform QH New in v1.4.2: Equivalent to (Removed) entropy = 1 interaction_entropy (default = 0) It specifies whether to use the Interaction Entropy (IE) approximation. 0: Don\u2019t 1: perform IE Keep in mind The standard deviation of the interaction energy (\u03c3IE) should always be reported when using the Interaction Entropy method. The Interaction Entropy method should be avoided if \u03c3IE > ~ 3.6 kcal/mol because it is impossible to converge the exponential average. It is advisable to study how the Interaction Entropy depends on N by block averaging (which also provide an estimate of the precision of the calculated entropies). A sampling frequency of 10 fs, as reported in the original IE publication , seems to be 3\u201340 times too dense. A sampling frequency of 0.1 ps would be more appropriate. The Interaction Entropy results may vary depending on the system flexibility or whether constraints were used or not in the MD simulation. Please, consult this paper for further details. New in v1.4.2: Equivalent to (Removed) entropy = 2 Updated in v1.5.0: Now reports the \u03c3IE and the warning related to it. Chart improved in gmx_MMPBSA_ana ie_segment (Default = 25) Representative segment (in %), starting from the last frame, for the calculation of the Interaction Entropy, e.g. : ie_segment = 25 means that the last quartile of the total number of frames ( (endframe-startframe)/interval ) will be used to calculate the average Interaction Entropy. New in v1.4.2 c2_entropy (default = 0) It specifies whether to use the C2 Entropy approximation. 0: Don\u2019t 1: perform C2 Keep in mind The standard deviation of the interaction energy (\u03c3IE) should always be reported. The C2 Entropy method should be avoided if \u03c3IE > ~ 6 kcal/mol because it gives unrealistically large entropies. It is advisable to study how the C2 Entropy depends on N by block averaging (which also provide an estimate of the precision of the calculated entropies). A sampling frequency of 10 fs, seems to be 3\u201340 times too dense. A sampling frequency of 0.1 ps would be more appropriate. The C2 Entropy results may vary depending on the system flexibility or whether constraints were used or not in the MD simulation. Please, consult this paper for further details. New in v1.5.0 c2_segment (Default = 25) Representative segment (in %), starting from the last frame, for the calculation of the C2 Entropy, e.g. : ie_segment = 25 means that the last quartile of the total number of frames ( (endframe-startframe)/interval ) will be used to calculate the C2 Entropy. New in v1.5.0 temperature (Default = 298.15) Specify the temperature to calculate experimental \u0394G from Ki and the Interaction Entropy (Only if entropy = 2). Avoid inconsistencies with defined internal temperature (298.15 K) when nmode or qh are used. Keep in mind Note that the nmode as qh model to calculate the entropy term are parameterized and will only work at 298.15 K New in v1.4.0: Replace entropy_temp assign_chainID (Default = 0) Defines the chains ID assignment mode. It is ignored when defining a reference structure (recommended) . If assign_chainID = 1 , gmx_MMPBSA check if the structure has no chains ID and it is assigned according to the structure 1 . If assign_chainID = 2 , gmx_MMPBSA assign the chains ID, exist or not, according to the structure 1 (can generate inconsistencies). If a *.gro file was used for complex structure ( -cs flag) and not reference structure was provided, gmx_MMPBSA assume assign_chainID = 1 . New in v1.2.0 Updated in v1.5.0: Internal changes exp_ki (Default = 0.0) Specify the experimental Ki in nM for correlations analysis. If not defined or exp_ki = 0 then this system will be omitted in the correlation analysis New in v1.4.0 gmx_path Define a path to search for GROMACS executables. This path takes precedence over the path defined in the PATH variable. In this path the following executables will be searched: gmx , gmx_mpi , gmx_d , or gmx_mpi_d (GROMACS > 5.x.x), and make_ndx , editconf and trjconv (GROMACS 4.x.x) Keep in mind This variable is used when the GROMACS used to run the system differs from that of will be used for running the analyses. It takes the path to the GROMACS bin folder where the executables will be searched on. An example of the use of this variable is given below: &general sys_name=\"my_system\", verbose=2, forcefields=\"oldff/leaprc.ff99SBildn\",leaprc.gaff\" gmx_path=\"/home/programs/gromacs/bin\" / &gb igb=5, saltcon=0.150 / # replace this \"/home/programs/gromacs/bin\" with the path to the GROMACS you want to use. New in v1.1.1 netcdf (Default = 0) Specifies whether or not to use NetCDF trajectories internally rather than writing temporary ASCII trajectory files. For very large trajectories, this could offer significant speedups, and requires less temporary space. However, this option is incompatible with alanine scanning. 0: Do NOT use temporary NetCDF trajectories 1: Use temporary NetCDF trajectories solvated_trajectory (Default = 1) Define if it is necessary to build a clean trajectory with no water and ions 0: Don\u2019t 1: Build clean trajectory New in v1.3.0 Updated in v1.5.0. Bugs fixed use_sander (Default = 0) use sander for energy calculations, even when mmpbsa_py_energy will suffice 0: Use mmpbsa_py_energy when possible 1: Always use sander Note Sander is always used when building the Amber topology from a Gromacs topology. This, because the conversion can generate parameters that are not recognized by mmpbsa_py_energy debug_printlevel gmx_MMPBSA prints errors by raising exceptions, and not catching fatal errors. If debug_printlevel is set to 0, then detailed tracebacks (effectively the call stack showing exactly where in the program the error occurred) is suppressed, so only the error message is printed. If debug_printlevel is set to 1 or higher, all tracebacks are printed, which aids in debugging of issues. (Default = 0) (Advanced Option) Changed in v1.2.0: Now gmx_MMPBSA shows the command-line used to build AMBER topologies when debug_printlevel = 1 or higher Deprecate in v1.5.0: Since we improved logging, this variable is not needed verbose (Default = 1) The variable that specifies how much output is printed in the output file. There are three allowed values: 0: print difference terms 1: print all complex, receptor, and ligand terms 2: also print bonded terms if one trajectory is used","title":"&amp;general namelist variables"},{"location":"input_file/#gb-namelist-variables","text":"intdiel (Default = 1.0) Define Internal dielectric constant without use external *.mdin file igb (Default = 5) Generalized Born method to use (see Section 4 ). Allowed values are 1, 2, 5, 7 and 8 Note All models are now available with both mmpbsa_py_energy and sander saltcon (Default = 0.0) Salt concentration in Molarity. surfoff (Default 0.0) Offset to correct (by addition) the value of the non-polar contribution to the solvation free energy term surften (Default = 0.0072) Surface tension value. Units in kcal/mol/\u00c5 2 molsurf (Default 0) Define the algorithm to calculate the surface area for the nonpolar solvation termWhen 0: LCPO (Linear Combination of Pairwise Overlaps) 1: molsurf algorithm probe (Default = 1.4) Radius of the probe molecule (supposed to be the size of a solvent molecule), in Angstroms, to use when determining the molecular surface. Note only applicable when molsurf is set to 1 msoffset (Default = 0) Offset to apply to the individual atomic radii in the system when calculating the molsurf surface. See the description of the molsurf action command in cpptraj . ifqnt (Default = 0) Specifies whether a part of the system is treated with quantum mechanics. 0: Potential function is strictly classical 1: Use QM/MM Note This functionality requires sander qm_residues Complex residues to treat with quantum mechanics. All residues treated with quantum mechanics in the complex must be treated with quantum mechanics in the receptor or ligand to obtain meaningful results. This notation is the same used for print_res variable Notation: [ CHAIN /( RESNUM or RESNUM-RESNUM ) ] Treat with quantum mechanics residues individual or ranges. This notation also supports insertion codes, in which case you must define them individually Example qm_residues=\"A/1,3-10,15,100\" This treat with quantum mechanic Chain A residues 1, 3 through 10, 15, and 100 from the complex topology file and the corresponding residues in either the ligand and/or receptor topology files. Suppost that we can have the following sequence: A:LEU:5, A:GLY:6:A, A:THR:6:B, A:SER:6:C A:ASP:6D, A:ILE:7 Right notation Wrong notation Ranges selection qm_residues=\"A/5-7 Will treat with quantum mechanic all mentioned residues because all residues with insertion code are contained in the range Individual selection qm_residues=\"A/5,6:B,6:C,7 Will treat with quantum mechanic all mentioned residues except the residues A:6:A and A:6:D Multiple chain selection qm_residues=\"A/5-10,100 B/34,56 Will treat with quantum mechanic residues 3 through 10, 100 from chain A and residues 34 and 56 from Chain B. qm_residues=\"A/5-6B,6D-7 Will end in error. qm_theory Which semi-empirical Hamiltonian should be used for the quantum calculation. Options are PM3, AM1, MNDO, PDDG-PM3, PM3PDDG, PDDG-MNDO, PDDGMNDO, PM3-CARB1, PM3CARB1, DFTB, SCC-DFTB, RM1, PM6, PM3-ZnB, PM3-MAIS, PM3ZNB, MNDO/D, MNDOD. The dispersion correction can be switched on for AM1 and PM6 by choosing AM1-D* and PM6-D, respectively. The dispersion and hydrogen bond correction will be applied for AM1-DH+ and PM6-DH+. Danger No default, this must be specified if QM/MM calculations are going to be performed. qmcharge_com (Default = 0) The charge of the quantum section for the complex. qmcharge_lig (Default = 0) The charge of the quantum section of the ligand. qmcharge_rec (Default = 0) The charge of the quantum section for the receptor. qmcut (Default = 9999.0) The cutoff for the qm/mm charge interactions.","title":"&amp;gb namelist variables"},{"location":"input_file/#pb-namelist-variables","text":"Note PB calculations can be performed either with mmpbsa_py_energy or sander . Of note, mmpbsa_py_energy works with a lower number of variables compared to sander . Nevertheless, mmpbsa_py_energy will suffice for most routine applications of PB. mmpbsa_py_energy variables: inp , smoothopt , radiopt , npbopt , solvopt , maxitn (linit) , nfocus , fscale , epsin (indi) , epsout (exdi) , istrng , dprob (prbrad) , iprob , accept , fillratio , space (1/scale) , bcopt , eneopt , cutnb , sprob , cavity_surften , cavity_offset On the other hand, sander offers access to all pbsa functionalities. sander variables: ntb , cut , nsnb , imin , maxcyc , ipb , inp , ioutfm , ntx , epsin (indi) , epsout (exdi) , istrng , radiopt , sprob , dprob (prbrad) , space (1/scale) , maxitn (linit) , cavity_surften , cavity_offset , fillratio , epsmem (emen) , membraneopt (memopt) , sasopt , mthick , maxarcdot , solvopt , nfocus , bcopt , eneopt , frcopt , cutfd , cutnb , mctrdz , poretype , npbverb , npbopt , pbtemp0 , iprob , arcres , mprob , accept , nbuffer , npbgrid , scalec , nsnba , phiout , phiform , decompopt , use_rmin , vprob , rhow_effect , use_sav , maxsph Hereafter, a selected group of variables is presented, which should suffice for most PB calculations. The default values for these parameters are appropriate for most calculations on solvated molecular systems. Also note that the default options may have changed over time. A more thorough description of all the options can be found here . For a detailed discussion of all related options on the quality of the MM/PB(GB)SA calculations, please check this publication . npbopt (Default = 0) Option to select the linear, or the full nonlinear PB equation. 0: Linear PB equation is solved 1: Nonlinear PB equation is solved Note While the linear PB equation will suffice for most calculations, the nonlinear PB equation is recommended for highly charged systems. It is supported in both mmpbsa_py_energy and sander . Parameters such as eneopt or cutnb should be adjusted accordingly when using the nonlinear PB equation. Check the following threads on how to proceed in mmbsa_py_energy or sander when using the nonlinear PB equation. Last but not least, take into account that using nonlinear PB equation can significantly increase the calculation time required for PB calculation. inp (Default = 2) Option to select different methods to compute non-polar solvation free energy. 0: No non-polar solvation free energy is computed 1: The total non-polar solvation free energy is modeled as a single term linearly proportional to the solvent accessible surface area, as in the PARSE parameter set, that is, if INP = 1, USE_SAV must be equal to 0. 2: The total non-polar solvation free energy is modeled as two terms: the cavity term and the dispersion term. The dispersion term is computed with a surface-based integration method closely related to the PCM solvent for quantum chemical programs. Under this framework, the cavity term is still computed as a term linearly proportional to the molecular solvent-accessible-surface area (SASA) or the molecular volume enclosed by SASA. cavity_offset (Default = -0.5692) Offset value used to correct non-polar free energy contribution. Note This is not used for APBS cavity_surften (Default = 0.0378 [ kcal/mol \u00c5 2 ] ) Surface tension. Unit conversion to kJ done automatically for APBS . exdi (Default = 80.0) External dielectric constant. This corresponds to epsout in pbsa . indi (Default = 1.0) Internal dielectric constant. This corresponds to epsin in pbsa . fillratio (Default = 4.0) The ratio between the longest dimension of the rectangular finite-difference grid and that of the solute. scale (Default = 2.0) Resolution of the Poisson Boltzmann grid. It is equal to the reciprocal of the grid spacing ( space in pbsa ). istrng (Default = 0.0) Ionic strength in Molarity. It is converted to mM for PBSA and kept as M for APBS . linit (Default = 1000) Maximum number of iterations of the linear Poisson Boltzmann equation to try. This corresponds to maxitn in pbsa . prbrad (Default = 1.4) Solvent probe radius in Angstroms. Allowed values are 1.4 and 1.6. This corresponds to dprob in pbsa . radiopt (Default = 1) The option to set up atomic radii according to: 0: the prmtop, or 1: pre-computed values Warning radiopt=0 is recommended which means using radii from the prmtop file for both the PB calculation and for the NP. Check this thread and See Amber manual for more complete description. sander_apbs (Default = 0) Option to use APBS for PB calculation instead of the built-in PBSA solver. This will work only through the iAPBS interface built into sander.APBS . Instructions for this can be found online at the iAPBS/APBS websites. 0: Don\u2019t use APBS 1: Use sander.APBS memopt (Default = 0) Turn on membrane protein support. This corresponds to membraneopt in pbsa . emem (Default = 1.0) Membrane dielectric constant. This corresponds to epsmem in pbsa . mthick (Default = 40.0) Membrane thickness. mctrdz (Default=0.0, use protein center as the membrane center) Absolute membrane center in the z-direction. poretype (Default=1) Turn on the automatic membrane channel/pore finding method.","title":"&amp;pb namelist variables"},{"location":"input_file/#alanine_scanning-namelist-variables","text":"mutant_only (Default = 0) Option to perform specified calculations only for the mutants. 0: Do mutant and original 1: Do mutant only Note Note that all calculation details are controlled in the other namelists, though for alanine scanning to be performed, the namelist must be included (blank if desired) mutant (Default = \"ALA\") Defines the residue by which it is going to mutate. Allowed values are: \"ALA\" or \"A\" for Alanine scanning and \"GLY\" or \"G\" for Glycine scanning. Changed in v1.3.0: Change mol (receptor or ligand) by mutant aminoacid (ALA or GLY) mutant_res (Default = None. Most be defined) Define the specific residue that is going to be mutated. Use the following format CHAIN:RESNUM (eg: 'A:350') or CHAIN:RESNUM:INSERTION_CODE if applicable (eg: \"A:27:B\"). Important Only one residue for mutation is supported! We recommend using the reference structure (-cr) to ensure the perfect match between the selected residue in the defined structure or topology This option allow gmx_MMPBSA to do the mutation. This way the user does not have to provide the mutant topology Changed in v1.4.0: Allow mutation in antibodies since it support insertion code notation cas_intdiel (Default = 0) The dielectric constant ( intdiel (GB)/ indi (PB)) will be modified depending on the nature of the residue to be mutated. 0: Don\u2019t 1: Adaptative intdiel assignation Important Works with the GB and PB calculations It is ignored when intdiel (GB)/ indi (PB) has been explicitly defined, that is, it is ignored if intdiel != 1.0 / indi != 1.0 (default values) Dielectric constant values has been assigned according to Yan et al., 2017 New in v1.4.2 intdiel_nonpolar (Default = 1) Define the intdiel (GB)/ indi (PB) value for nonpolar residues ( PHE , TRP , VAL , ILE , LEU , MET , PRO , CYX , ALA , GLY , PRO ) New in v1.4.2 intdiel_polar (Default = 3) Define the intdiel (GB)/ indi (PB) value for polar residues ( TYR , SER , THR , CYM , CYS , HIE , HID , ASN , GLN , ASH , GLH , LYN ) New in v1.4.2 intdiel_positive (Default = 5) Define the intdiel (GB)/ indi (PB) value for positive charged residues ( LYS , ARG , HIP ) New in v1.4.2 intdiel_negative (Default = 5) Define the intdiel (GB)/ indi (PB) value for negative charged residues ( GLU , ASP ) New in v1.4.2","title":"&amp;alanine_scanning namelist variables"},{"location":"input_file/#nmode-namelist-variables","text":"dielc (Default = 1.0) Distance-dependent dielectric constant drms (Default = 0.001) Convergence criteria for minimized energy gradient. maxcyc (Default = 10000) Maximum number of minimization cycles to use per snapshot in sander. nminterval 2 (Default = 1) Offset from which to choose frames to perform nmode calculations on nmendframe 2 (Default = 1000000) Frame number to stop performing nmode calculations on nmode_igb (Default = 1) Value for Generalized Born model to be used in calculations. Options are: 0: Vacuum 1: HCT GB model nmode_istrng (Default = 0.0) Ionic strength to use in nmode calculations. Units are Molarity. Non-zero values are ignored if nmode_igb is 0 above. nmstartframe 2 Frame number to begin performing nmode calculations on","title":"&amp;nmode namelist variables"},{"location":"input_file/#decomp-namelist-variables","text":"csv_format (Default = 1 [CSV-formatted output file]) Print the decomposition output in a Comma-Separated-Variable (CSV) file. CSV files open natively in most spreadsheets. * If set to 1, this variable will cause the data to be written out in a CSV file, and standard error of the mean will be calculated and included for all data. * If set to 0, the standard, ASCII format will be used for the output file. dec_verbose (Default = 0) Set the level of output to print in the decomp_output file. 0: DELTA energy, total contribution only 1: DELTA energy, total, sidechain, and backbone contributions 2: Complex, Receptor, Ligand, and DELTA energies, total contribution only 3: Complex, Receptor, Ligand, and DELTA energies, total, sidechain, and backbone contributions Note If the values 0 or 2 are chosen, only the Total contributions are required, so only those will be printed to the mdout files to cut down on the size of the mdout files and the time required to parse them. idecomp Energy decomposition scheme to use: 1: Per-residue decomp with 1-4 terms added to internal potential terms 2: Per-residue decomp with 1-4 EEL added to EEL and 1-4 VDW added to VDW potential terms. 3: Pairwise decomp with 1-4 terms added to internal potential terms 4: Pairwise decomp with 1-4 EEL added to EEL and 1-4 VDW added to VDW potential terms Warning No default. This must be specified!. print_res (Default = \"within 6\") Select residues from the complex to print. The default selection should be sufficient in most cases, however we have added several additional notations By Distance Amino acid selection All Notation: [ within distance ] within corresponds to the keyword and distance to the maximum distance criterion in Angstroms necessary to select the residues from both the receptor and the ligand Example print_res=\"within 6\" Will print all residues within 6 Angstroms between receptor and ligand including both. Notation: [ CHAIN /( RESNUM or RESNUM-RESNUM ) ] Print residues individual or ranges. This notation also supports insertion codes, in which case you must define them individually Example print_res=\"A/1,3-10,15,100 B/25\" This will print Chain A residues 1, 3 through 10, 15, and 100 along with chain B residue 25 from the complex topology file and the corresponding residues in either the ligand and/or receptor topology files. Danger make sure to include at least one residue from both the receptor and ligand in the print_res mask of the &decomp section. Check http://archive.ambermd.org/201308/0075.html Suppost that we can have the following sequence where chain A is the receptor and B is the ligand: A:LEU:5, A:GLY:6:A, A:THR:6:B, A:SER:6:C A:ASP:6D, A:ILE:7 , B:25 Supported notation Wrong notation Ranges selection print_res=\"A/5-7 B/25 Will print all mentioned residues because all residues with insertion code are contained in the range Individual selection print_res=\"A/5,6:B,6:C,7 B/25 Will print all mentioned residues except the residues A:6:A and A:6:D print_res=\"A/5-6B,6D-7 Will end in error. Notation: all will print all residues. This option is often not recommended since most residues contribution is zero and it is just going to be a waste of time and computational resources. Danger Using idecomp=3 or 4 (pairwise) with a very large number of printed residues and a large number of frames can quickly create very, very large temporary mdout files. Large print selections also demand a large amount of memory to parse the mdout files and write decomposition output file (~500 MB for just 250 residues, since that\u2019s 62500 pairs!) It is not unusual for the output file to take a significant amount of time to print if you have a lot of data. This is most applicable to pairwise decomp, since the amount of data scales as O(N 2 ). Important We recommend using the reference structure (-cr) to ensure the perfect match between the selected residue in the defined structure or topology Changed in v1.4.0: Improve residue selection","title":"&amp;decomp namelist variables"},{"location":"input_file/#rism-namelist-variables","text":"Warning 3D-RISM calculations are performed with the rism3d.snglpnt program built with AmberTools, written by Tyler Luchko. It is the most expensive, yet most statistical mechanically rigorous solvation model. See RISM chapter for a thorough description of options and theory. A list of references can be found there, too. We have included more variables in 3D-RISM calculations than the ones available in the MMPBSA.py original code. That way, users can be more in control and tackle various issues (e.g., convergence problems). 3D-RISM variables and their default values: closureorder= 1 , asympcorr= 1 , buffer= 14.0 , solvcut= None (If -1 or no value is specified then the buffer distance is used) , grdspc= 0.5,0.5,0.5 , ng= -1,-1,-1 , solvbox= -1,-1,-1 , tolerance= 0.00001 (1.0e-5) , mdiis_del= 0.7 , mdiis_restart= 10.0 , mdiis_nvec= 5 , maxstep= 10000 , npropagate= 5 , centering= 1 , polarDecomp= 0 , entropicDecomp= 0 , gf= 0 , pc+= 0 , uccoeff= 0.0,0.0,0.0,0.0 , rism_verbose= 0 , treeDCF= 1 , treeTCF= 1 , treeCoulomb= 0 , treeDCFOrder= 2 , treeTCFOrder= 2 , treeCoulombOrder= 2 , treeDCFN0= 500 , treeTCFN0= 500 , treeCoulombN0= 500 , treeDCFMAC= 0.1 , treeTCFMAC= 0.1 , treeCoulombMAC= 0.1 , asympKSpaceTolerance= -1.0 , ljTolerance= -1.0 One advantage of 3D-RISM is that an arbitrary solvent can be chosen; you just need to change the xvvfile specified on the command line (see 34.3.2 ). buffer (Default = 14 \u00c5) Minimum distance between solute and edge of solvation box. Specify this with grdspc below. Mutually exclusive with ng and solvbox. Set buffer < 0 if you wish to use ng and solvbox . closure (Default = \"kh\") The approximation to the closure relation. Allowed choices are kh (Kovalenko-Hirata), hnc (Hypernetted- chain), or psen (Partial Series Expansion of order-n) where \"n\" is a positive integer ( e.g. , \"pse3\"). Deprecated closureorder (Default = 1) The order at which the PSE-n closure is truncated if closure is specified as \"pse\" or \"psen\" (no integers). grdspc (Default = 0.5 \u00c5) Grid spacing of the solvation box. Specify this with buffer above. Mutually exclusive with ng and solvbox . ng Number of grid points to use in the x, y, and z directions. Used only if buffer < 0. Mutually exclusive with buffer and grdspc above, and paired with solvbox below. Warning No default, this must be set if buffer < 0. Define like ng=1000,1000,1000 solvbox Length of the solvation box in the x, y, and z dimensions. Used only if buffer < 0. Mutually exclusive with buffer and grdspc above, and paired with ng above. Warning No default, this must be set if buffer < 0. Define like solvbox=20,20,20 polardecomp (Default = 0) Decompose the solvation free energy into polar and non-polar contributions. Note that this will increase computation time by roughly 80%. 0: Don\u2019t decompose solvation free energy. 1: Decompose solvation free energy. rism_verbose (Default = 0) Level of output in temporary RISM output files. May be helpful for debugging or following convergence. 0: just print the final result 1: additionally prints the total number of iterations for each solution 2: additionally prints the residual for each iteration and details of the MDIIS solver (useful for debugging and convergence analyses) solvcut (Default = buffer ) Cutoff used for solute-solvent interactions. The default is the value of buffer. Therefore, if you set buffer < 0 and specify ng and solvbox instead, you must set solvcut to a nonzero value, or the program will quit in error. thermo (Default = \"std\") Which thermodynamic equation you want to use to calculate solvation properties. Options are \"std\", \"gf\", or \"both\" (case-INsensitive). \"std\" uses the standard closure relation, \"gf\" uses the Gaussian Fluctuation approximation, and \"both\" will print out separate sections for both. Note Note that all data are printed out for each RISM simulation, so no choice is any more computationally demanding than another. tolerance (Default = 1e-5) Upper bound of the precision requirement used to determine convergence of the self-consistent solution. This has a strong effect on the cost of 3D-RISM calculations (smaller value for tolerance -> more computation).","title":"&amp;rism namelist variables"},{"location":"input_file/#generation","text":"The input file can be created using gmx_MMPBSA selecting the calculations you wish to perform. Command-line gmx_MMPBSA --create_input args Example: GB calculation PB calculation GB, PB and Decomposition calculation All calculations gmx_MMPBSA --create_input gb gmx_MMPBSA --create_input pb gmx_MMPBSA --create_input gb pb decomp gmx_MMPBSA --create_input or gmx_MMPBSA --create_input all Danger Note that several variables must be explicitly defined New in v1.5.0","title":"Generation"},{"location":"input_file/#format","text":"All of the input variables are described below according to their respective namelists. Integers and floating point variables should be typed as-is while strings should be put in either single- or double-quotes. All variables should be set with variable = value and separated by commas is they appear in the same line. If the variables appear in different lines, the comma is no longer needed. See several examples below. As you will see, several calculations can be performed in the same run ( i.e. &gb and &pb , &gb and &alanine_scanning , &pb and &decomp , etc). As we have mentioned, the input file can be generated using the create_input option of gmx_MMPBSA. This style, while retaining the same Amber format (derived from Fortran), is aesthetically more familiar to the GROMACS style (*.mdp). However, it maintains the same essence, so it could be defined in any of the two format styles or even combined. See the formats below: New format style Old format style New format style Input file example # General namelist variables &general # System name sys_name = \"\" # First frame to analyze startframe = 1 # Last frame to analyze endframe = 9999999 ... # How many energy terms to print in the final output verbose = 1 / # Generalized-Born namelist variables &gb # GB model to use igb = 5 ... # Solvent probe radius for surface area calc probe = 1.4 / Old format style Input file example # General namelist variables &general sys_name = \"\", startframe = 1, endframe = 9999999 ... verbose = 1 / # Generalized-Born namelist variables &gb igb = 5, ... probe = 1.4 /","title":"Format"},{"location":"input_file/#sample-input-files","text":"Tip You can refer to the examples to understand the input file in a practical way.","title":"Sample input files"},{"location":"input_file/#gb-and-pb","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Sample input file for GB and PB calculation building the Amber topologies from structures. Please refer to the section \"How gmx_MMPBSA works\" &general startframe=5, endframe=100, interval=5, verbose=2, protein_forcefield=\"oldff/leaprc.ff99SB\", ligand_forcefield=\"leaprc.gaff\" / &gb igb=5, saltcon=0.150, / &pb istrng=0.15, fillratio=4.0 /","title":"GB and PB"},{"location":"input_file/#alanine-scanning","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 Sample input file for Alanine scanning &general startframe=5, endframe=21, verbose=2, interval=1, protein_forcefield=\"oldff/leaprc.ff99SB\", PBRadii=4 / &gb igb=8, saltcon=0.150, intdiel=10 / &alanine_scanning mutant='ALA', mutant_res='B:12' /","title":"Alanine scanning"},{"location":"input_file/#entropy","text":"1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 Sample input file for entropy calculations &general startframe=5, endframe=21, verbose=2, interval=1, # `entropy` variable control whether to perform a quasi-harmonic entropy (QH) # or the Interaction Entropy (IE) # (https://pubs.acs.org/doi/abs/10.1021/jacs.6b02682) approximation protein_forcefield=\"oldff/leaprc.ff99SB\", entropy=2, entropy_seg=25, temperature=298 / &gb igb=2, saltcon=0.150, / uncomment the next 4 lines for normal mode calculations #&nmode #nmstartframe=5, nmendframe=21, nminterval=2, #maxcyc=50000, drms=0.0001, #/","title":"Entropy"},{"location":"input_file/#decomposition-analysis","text":"Sample input file with decomposition analysis Make sure to include at least one residue from both the receptor and ligand in the print_res mask of the &decomp section. http://archive.ambermd.org/201308/0075.html. This is automally guaranteed if use \"within\" keyword. &general startframe=5, endframe=21, interval=1, / &gb igb=5, saltcon=0.150, / &decomp idecomp=2, dec_verbose=3, # This will print all residues that are less than 4 angstroms between # the receptor and the ligand print_res=\"within 4\" /","title":"Decomposition analysis"},{"location":"input_file/#qmmmgbsa","text":"Sample input file for QM/MMGBSA &general startframe=5, endframe=100, interval=5, / &gb igb=5, saltcon=0.100, ifqnt=1, qmcharge_com=0, qm_residues=\"B/240-251\", qm_theory=\"PM3\" /","title":"QM/MMGBSA"},{"location":"input_file/#mm3d-rism","text":"Sample input file for 3D-RISM &general startframe=20, endframe=100, interval=5, / &rism polardecomp=1, thermo=\"gf\" /","title":"MM/3D-RISM"},{"location":"input_file/#mmpbsa-with-membrane-proteins","text":"Sample input file for MMPBSA with membrane proteins &general startframe=1, endframe=100, interval=1, debug_printlevel=2, use_sander=1, / &pb radiopt=0, indi=20.0, istrng=0.150, fillratio=1.25, ipb=1, nfocus=1, bcopt=10, eneopt=1, cutfd=7.0, cutnb=99.0, npbverb=1, solvopt=2, inp=2, memopt=1, emem=7.0, mctrdz=-10.383, mthick=36.086, poretype=1, maxarcdot=15000 / Info Comments are allowed by placing a # at the beginning of the line (whites-space are ignored). Variable initialization may span multiple lines. In-line comments ( i.e. , putting a # for a comment after a variable is initialized in the same line) is not allowed and will result in an input error. Variable declarations must be comma-delimited, though all whitespace is ignored. Finally, all lines between namelists are ignored, so comments can be added before each namelist without using #. The chain ID is assigned according to two criteria: terminal amino acids and residue numbering . If both criteria or residue numbering changes are present, we assign a new chain ID. If there are terminal amino acids but the numbering of the residue continues, we do not change the ID of the chain. \u21a9 \u21a9 These variables will choose a subset of the frames chosen from the variables in the &general namelist. Thus, the \"trajectory\" from which snapshots will be chosen for nmode calculations will be the collection of snapshots upon which the other calculations were performed. \u21a9 \u21a9 \u21a9","title":"MMPBSA with membrane proteins"},{"location":"installation/","text":"Installing gmx_MMPBSA \u00b6 Requirements \u00b6 gmx_MMPBSA requires AmberTools20 or 21 to be installed in your machine with Python3 , and the shell environment correctly set up for Amber. The AmberTools suite is free of charge . You can check Amber web page for a detailed installation guide. Of note, you can have more than one AmberTools installed in your machine. In case AmberTools20/21 is not the default Amber in your computer, just make sure to source AmberTools20/21 before installing/updating/running gmx_MMPBSA . gmx_MMPBSA also requires GROMACS (series 4.x.x or 5.x.x or 20xx.x) to be installed in your computer, and the shell environment correctly set up for GROMACS. gmx_MMPBSA has been tested with GROMACS 4.6.7, 5.1.2, 2018.3, and 2020.4, although it should run smoothly with any GROMACS present in the PATH and that is compatible with the files you are using. Dependencies \u00b6 Dependency gmx_MMPBSA gmx_MMPBSA_ana gmx_MMPBSA_test Python3 AmberTools20/21 PyQt5 Matplotlib Pandas Seaborn Scipy mpi4py openmpi-bin libopenmpi-dev openssh-client Git -> Required -- -> Optional, but recommended -- -> Optional Install Dependencies MPI PyQt5 Other Python Packages Make sure that you install the OpenMPI library sudo apt install openmpi-bin libopenmpi-dev openssh-client mpi4py is installed with gmx_MMPBSA gmx_MMPBSA_ana requires PyQt5 which is not installed automatically. That way, gmx_MMPBSA_ana cannot be opened in HPC. amber.python -m pip install PyQt5 Warning Note that if you don't install PyQt5 you won't be able to open gmx_MMPBSA_ana Valid for versions > 1.4.0 matplotlib , pandas , ( mpi4py ), seaborn and scipy are installed automatically, so the user does not have to worry about installing them Installation \u00b6 stable You can install gmx_MMPBSA from the stable version on PYPI : amber.python -m pip install gmx_MMPBSA Danger The latest version of miniconda/anaconda seems to have a problem with pip . This is because, when conda is updated, the latest version of setuptools (v.57.x) is installed, which is incompatible with pip (21.2.4), so the latter was removed. If you find that amber.pip , amber.python -m pip or python -m pip (with conda environment active) don't work, you must install it from conda as follows: conda install pip or amber.conda install pip Update \u00b6 If you already have installed a previous gmx_MMPBSA version, you can update it as follows: stable stable version (recommended): amber.python -m pip install gmx_MMPBSA --upgrade Troubleshooting after installation \u00b6 Once the installation is completed, the following warning may appear: WARNING: The scripts gmx_MMPBSA, gmx_MMPBSA_ana and gmx_MMPBSA_test are installed in '/home/user/path_to_amber_install/amber20/miniconda/bin' which is not on PATH. This warning is because pip installs the executables ( gmx_MMPBSA , gmx_MMPBSA_ana and gmx_MMPBSA_test ) in installation_path/amber20/miniconda/bin . You have two options to solve this: Add this folder (*/amber20/miniconda/bin) to PATH: export PATH=\"/path_to_amber_install/amber20/miniconda/bin:$PATH\" Tip This option is more permanent and is recommended if you don't want to activate and deactivate the conda environment Make sure to update path_to_amber_install in the PATH variable Initializing the environment of conda amber: amber.conda init bash You can deactivate like this: conda deactivate Note After using one of the above options, you should be able to run gmx_MMPBSA , gmx_MMPBSA_ana and gmx_MMPBSA_test through the terminal If when running gmx_MMPBSA , you get an error like this: ModuleNotFoundError: No module named 'parmed' please see the following issue to see the solution Autocompletion script \u00b6 Since gmx_MMPBSA has many flags, we believe that this autocompletion can significantly improve productivity, be more user-friendly and reduce the number of unforced errors. That is why we created this script, which manages the autocompletion of the gmx_MMPBSA , gmx_MMPBSA_ana and gmx_MMPBSA_test . Execution: Enter the following command in the terminal: source /path/to/ambertools/lib/python3.x/site-packages/GMXMMPBSA/GMXMMPBSA.sh Tip If you want it to be activated automatically, add that command to your .bashrc Warning This script requires that gmx_MMPBSA , gmx_MMPBSA_ana and gmx_MMPBSA_test be accessible in PATH If the command-line above end in error, please make sure the file has executed permissions. On Ubuntu, Debian, Linux Mint or related: GUI: Right-click on GMXMMPBSA.sh file > Properties > Permissions > Mark the checkbox \"Allow to execute the file as a program\" Terminal: chmod 755 /path/to/ambertools/lib/python3.x/site-packages/GMXMMPBSA/GMXMMPBSA.sh Once you make the source of GMXMMPBSA.sh you can check its operation as follows: All you have to do is enter the name of the program in the terminal and press the tab key twice: gmx_MMPBSA <tab> <tab> Testing the operation of gmx_MMPBSA \u00b6 After preparing everything to run gmx_MMPBSA , it only remains to check its correct operation. To know how to do it, consult the documentation of gmx_MMPBSA_test","title":"Installation"},{"location":"installation/#installing-gmx_mmpbsa","text":"","title":"Installing gmx_MMPBSA"},{"location":"installation/#requirements","text":"gmx_MMPBSA requires AmberTools20 or 21 to be installed in your machine with Python3 , and the shell environment correctly set up for Amber. The AmberTools suite is free of charge . You can check Amber web page for a detailed installation guide. Of note, you can have more than one AmberTools installed in your machine. In case AmberTools20/21 is not the default Amber in your computer, just make sure to source AmberTools20/21 before installing/updating/running gmx_MMPBSA . gmx_MMPBSA also requires GROMACS (series 4.x.x or 5.x.x or 20xx.x) to be installed in your computer, and the shell environment correctly set up for GROMACS. gmx_MMPBSA has been tested with GROMACS 4.6.7, 5.1.2, 2018.3, and 2020.4, although it should run smoothly with any GROMACS present in the PATH and that is compatible with the files you are using.","title":"Requirements"},{"location":"installation/#dependencies","text":"Dependency gmx_MMPBSA gmx_MMPBSA_ana gmx_MMPBSA_test Python3 AmberTools20/21 PyQt5 Matplotlib Pandas Seaborn Scipy mpi4py openmpi-bin libopenmpi-dev openssh-client Git -> Required -- -> Optional, but recommended -- -> Optional Install Dependencies MPI PyQt5 Other Python Packages Make sure that you install the OpenMPI library sudo apt install openmpi-bin libopenmpi-dev openssh-client mpi4py is installed with gmx_MMPBSA gmx_MMPBSA_ana requires PyQt5 which is not installed automatically. That way, gmx_MMPBSA_ana cannot be opened in HPC. amber.python -m pip install PyQt5 Warning Note that if you don't install PyQt5 you won't be able to open gmx_MMPBSA_ana Valid for versions > 1.4.0 matplotlib , pandas , ( mpi4py ), seaborn and scipy are installed automatically, so the user does not have to worry about installing them","title":"Dependencies"},{"location":"installation/#installation","text":"stable You can install gmx_MMPBSA from the stable version on PYPI : amber.python -m pip install gmx_MMPBSA Danger The latest version of miniconda/anaconda seems to have a problem with pip . This is because, when conda is updated, the latest version of setuptools (v.57.x) is installed, which is incompatible with pip (21.2.4), so the latter was removed. If you find that amber.pip , amber.python -m pip or python -m pip (with conda environment active) don't work, you must install it from conda as follows: conda install pip or amber.conda install pip","title":"Installation"},{"location":"installation/#update","text":"If you already have installed a previous gmx_MMPBSA version, you can update it as follows: stable stable version (recommended): amber.python -m pip install gmx_MMPBSA --upgrade","title":"Update"},{"location":"installation/#troubleshooting-after-installation","text":"Once the installation is completed, the following warning may appear: WARNING: The scripts gmx_MMPBSA, gmx_MMPBSA_ana and gmx_MMPBSA_test are installed in '/home/user/path_to_amber_install/amber20/miniconda/bin' which is not on PATH. This warning is because pip installs the executables ( gmx_MMPBSA , gmx_MMPBSA_ana and gmx_MMPBSA_test ) in installation_path/amber20/miniconda/bin . You have two options to solve this: Add this folder (*/amber20/miniconda/bin) to PATH: export PATH=\"/path_to_amber_install/amber20/miniconda/bin:$PATH\" Tip This option is more permanent and is recommended if you don't want to activate and deactivate the conda environment Make sure to update path_to_amber_install in the PATH variable Initializing the environment of conda amber: amber.conda init bash You can deactivate like this: conda deactivate Note After using one of the above options, you should be able to run gmx_MMPBSA , gmx_MMPBSA_ana and gmx_MMPBSA_test through the terminal If when running gmx_MMPBSA , you get an error like this: ModuleNotFoundError: No module named 'parmed' please see the following issue to see the solution","title":"Troubleshooting after installation"},{"location":"installation/#autocompletion-script","text":"Since gmx_MMPBSA has many flags, we believe that this autocompletion can significantly improve productivity, be more user-friendly and reduce the number of unforced errors. That is why we created this script, which manages the autocompletion of the gmx_MMPBSA , gmx_MMPBSA_ana and gmx_MMPBSA_test . Execution: Enter the following command in the terminal: source /path/to/ambertools/lib/python3.x/site-packages/GMXMMPBSA/GMXMMPBSA.sh Tip If you want it to be activated automatically, add that command to your .bashrc Warning This script requires that gmx_MMPBSA , gmx_MMPBSA_ana and gmx_MMPBSA_test be accessible in PATH If the command-line above end in error, please make sure the file has executed permissions. On Ubuntu, Debian, Linux Mint or related: GUI: Right-click on GMXMMPBSA.sh file > Properties > Permissions > Mark the checkbox \"Allow to execute the file as a program\" Terminal: chmod 755 /path/to/ambertools/lib/python3.x/site-packages/GMXMMPBSA/GMXMMPBSA.sh Once you make the source of GMXMMPBSA.sh you can check its operation as follows: All you have to do is enter the name of the program in the terminal and press the tab key twice: gmx_MMPBSA <tab> <tab>","title":"Autocompletion script"},{"location":"installation/#testing-the-operation-of-gmx_mmpbsa","text":"After preparing everything to run gmx_MMPBSA , it only remains to check its correct operation. To know how to do it, consult the documentation of gmx_MMPBSA_test","title":"Testing the operation of gmx_MMPBSA"},{"location":"introduction/","text":"Introduction \u00b6 MM/PB(GB)SA method can be used for calculating binding free energies of non covalently bound complexes. Figure 1. Thermodynamic cycle for binding free energy calculations The free binding energy for a complex can be estimated as follows: \u2206\ud835\udc3a \ud835\udc4f\ud835\udc56\ud835\udc5b\ud835\udc51 = \u2329\ud835\udc3a \ud835\udc36\ud835\udc42\ud835\udc40 \u232a\u2212\u2329\ud835\udc3a \ud835\udc45\ud835\udc38\ud835\udc36 \u232a\u2212\u2329\ud835\udc3a \ud835\udc3f\ud835\udc3c\ud835\udc3a \u232a (1) where each term to the right in the equation is given by: \u2329\ud835\udc3a \ud835\udc65 \u232a = \u2329\ud835\udc38 \ud835\udc40\ud835\udc40 \u232a + \u2329\ud835\udc3a \ud835\udc60\ud835\udc5c\ud835\udc59 \u232a \u2212 \u2329\ud835\udc47\ud835\udc46\u232a (2) In turn, \u2206\ud835\udc3a \ud835\udc4f\ud835\udc56\ud835\udc5b\ud835\udc51 can also be represented as: \u2206\ud835\udc3a \ud835\udc4f\ud835\udc56\ud835\udc5b\ud835\udc51 = \u2206\ud835\udc3b \u2212 \ud835\udc47\u2206\ud835\udc46 (3) where \u2206\ud835\udc3b corresponds to the enthalpy of binding and \u2212\ud835\udc47\u2206\ud835\udc46 to the conformational entropy after ligand binding. When the entropic term is dismissed, the computed value is the effective free energy, which is usually sufficient for comparing relative binding free energies of related ligands. The \u2206\ud835\udc3b can be decomposed into different terms: \u2206\ud835\udc3b = \u2206\ud835\udc38 \ud835\udc40\ud835\udc40 + \u2206\ud835\udc3a \ud835\udc60\ud835\udc5c\ud835\udc59 (4) where: \u2206\ud835\udc38 \ud835\udc40\ud835\udc40 = \u2206\ud835\udc38 \ud835\udc4f\ud835\udc5c\ud835\udc5b\ud835\udc51\ud835\udc52\ud835\udc51 + \u2206\ud835\udc38 \ud835\udc5b\ud835\udc5c\ud835\udc5b\ud835\udc4f\ud835\udc5c\ud835\udc5b\ud835\udc51\ud835\udc52\ud835\udc51 = (\u2206\ud835\udc38 \ud835\udc4f\ud835\udc5c\ud835\udc5b\ud835\udc51 + \u2206\ud835\udc38 \ud835\udc4e\ud835\udc5b\ud835\udc54\ud835\udc59\ud835\udc52 + \u2206\ud835\udc38 \ud835\udc51\ud835\udc56\u210e\ud835\udc52\ud835\udc51\ud835\udc5f\ud835\udc4e\ud835\udc59 ) + (\u2206\ud835\udc38 \ud835\udc52\ud835\udc59\ud835\udc52 + \u2206\ud835\udc38 \ud835\udc63\ud835\udc51\ud835\udc4a ) (5) The gas phase free energy contributions (\u2206\ud835\udc38 \ud835\udc40\ud835\udc40 ) are calculated by sander within the AmberTools package according to the force field used in the MD simulation. The \u2206\ud835\udc3a \ud835\udc60\ud835\udc5c\ud835\udc59 is given by: \u2206\ud835\udc3a \ud835\udc60\ud835\udc5c\ud835\udc59 = \u2206\ud835\udc3a \ud835\udc5d\ud835\udc5c\ud835\udc59 + \u2206\ud835\udc3a \ud835\udc5b\ud835\udc5c\ud835\udc5b\u2212\ud835\udc5d\ud835\udc5c\ud835\udc59 = \u2206\ud835\udc3a \ud835\udc43\ud835\udc35/\ud835\udc3a\ud835\udc35 + \u2206\ud835\udc3a \ud835\udc5b\ud835\udc5c\ud835\udc5b\u2212\ud835\udc5d\ud835\udc5c\ud835\udc59 (6) where: \u2206\ud835\udc3a \ud835\udc5b\ud835\udc5c\ud835\udc5b\u2212\ud835\udc5d\ud835\udc5c\ud835\udc59\ud835\udc4e\ud835\udc5f = \ud835\udc41\ud835\udc43 \ud835\udc47\ud835\udc38\ud835\udc41\ud835\udc46\ud835\udc3c\ud835\udc42\ud835\udc41 \u2217 \u2206\ud835\udc46\ud835\udc34\ud835\udc46\ud835\udc34 + \ud835\udc41\ud835\udc43 \ud835\udc42\ud835\udc39\ud835\udc39\ud835\udc46\ud835\udc38\ud835\udc47 (7) or, \u2206\ud835\udc3a \ud835\udc5b\ud835\udc5c\ud835\udc5b\u2212\ud835\udc5d\ud835\udc5c\ud835\udc59 = \u2206\ud835\udc3a \ud835\udc51\ud835\udc56\ud835\udc60\ud835\udc5d + \u2206\ud835\udc3a \ud835\udc50\ud835\udc4e\ud835\udc63\ud835\udc56\ud835\udc61\ud835\udc66 = \u2206\ud835\udc3a \ud835\udc51\ud835\udc56\ud835\udc60\ud835\udc5d + (\ud835\udc36\ud835\udc34\ud835\udc49\ud835\udc3c\ud835\udc47\ud835\udc4c \ud835\udc47\ud835\udc38\ud835\udc41\ud835\udc46\ud835\udc3c\ud835\udc42\ud835\udc41 \u2217 \u2206\ud835\udc46\ud835\udc34\ud835\udc46\ud835\udc34 + \ud835\udc36\ud835\udc34\ud835\udc49\ud835\udc3c\ud835\udc47\ud835\udc4c \ud835\udc42\ud835\udc39\ud835\udc39\ud835\udc46\ud835\udc38\ud835\udc47 ) (8) In the above equations, \u2206\ud835\udc38 \ud835\udc40\ud835\udc40 corresponds to the molecular mechanical energy changes in the gas phase. \u2206\ud835\udc38 \ud835\udc40\ud835\udc40 includes \u2206\ud835\udc38 \ud835\udc4f\ud835\udc5c\ud835\udc5b\ud835\udc51\ud835\udc52\ud835\udc51 , also known as internal energy, and \u2206\ud835\udc38 \ud835\udc5b\ud835\udc5c\ud835\udc5b\ud835\udc4f\ud835\udc5c\ud835\udc5b\ud835\udc51\ud835\udc52\ud835\udc51 , corresponding to the van der Waals and electrostatic contributions. The solvation energy is determined differently, depending on the method employed. In the 3D-RISM model, both components -polar and non polar- of the solvation energy are calculated. However, the PB and GB models estimate only the polar component of the solvation. The non polar component is usually assumed to be proportional to the molecule's total solvent accessible surface area (SASA), with a proportionality constant derived from experimental solvation energies of small non polar molecules (eq. 7). Alternatively, a modern approach that separates non-polar solvation free energies into cavity and dispersion terms can be used. In this approach, SASA is used to correlate the cavity term only, while a surface-integration method is employed to compute the dispersion term (eq. 8). Furthermore, the entropic component is usually calculated by normal modes analysis (NMODE). The translational and rotational entropies can be estimated using standard statistical mechanical formulas. Nevertheless, calculating vibrational entropy using normal modes is computationally expensive because it requires expanding the internal coordinate covariance matrix for all degrees of freedom for a set of minimized structures. Conversely, the Quasi-harmonic (QH) approximation is less computationally expensive, although it requires a considerable number of frames to converge. Recently, other alternatives have been developed, such as NMODE in truncated systems, which considerably reduces the computational cost. Interaction Entropy (IE) is another novel method that calculates the entropic component of the binding free energy directly from MD simulations without any extra computational cost. This method is numerically reliable, more computationally efficient, and superior to the standard NMODE approach, as shown in an extensive study of over a dozen randomly selected protein-ligand binding systems. Typically, two approaches are used for MM/PB(GB)SA calculations, known as Single Trajectory Protocol (STP) and Multiple Trajectory Protocol (MTP). In STP, both the receptor and the ligand trajectories are extracted from that of the complex. This approach is valid when the bound and unbound states of the receptor, and the ligand are similar. It is computationally less expensive than the MTP approach since only a simulation of the complex is required. Additionally, the potential internal terms ( e.g. , bonds, angles, and dihedrals) cancel exactly in STP since these terms are the same in both bound and unbound states. On the other hand, the MTP is a more realistic approach because it considers multiple trajectories ( i.e. , complex, receptor, and ligand). However, significant conformational changes can lead to numerous errors. In practice, a detailed study of the system is required to select the approach to be used. Literature \u00b6 Further information can be found in Amber manual : MMPBSA.py The Generalized Born/Surface Area Model PBSA Reference Interaction Site Model Generalized Born (GB) for QM/MM calculations and the foundational papers: Srinivasan J. et al., 1998 Kollman P. A. et al., 2000 Gohlke H., Case D. A. 2004 as well as some reviews: Genheden S., Ryde U. 2015 Wang et. al., 2018 Wang et. al., 2019","title":"Introduction"},{"location":"introduction/#introduction","text":"MM/PB(GB)SA method can be used for calculating binding free energies of non covalently bound complexes. Figure 1. Thermodynamic cycle for binding free energy calculations The free binding energy for a complex can be estimated as follows: \u2206\ud835\udc3a \ud835\udc4f\ud835\udc56\ud835\udc5b\ud835\udc51 = \u2329\ud835\udc3a \ud835\udc36\ud835\udc42\ud835\udc40 \u232a\u2212\u2329\ud835\udc3a \ud835\udc45\ud835\udc38\ud835\udc36 \u232a\u2212\u2329\ud835\udc3a \ud835\udc3f\ud835\udc3c\ud835\udc3a \u232a (1) where each term to the right in the equation is given by: \u2329\ud835\udc3a \ud835\udc65 \u232a = \u2329\ud835\udc38 \ud835\udc40\ud835\udc40 \u232a + \u2329\ud835\udc3a \ud835\udc60\ud835\udc5c\ud835\udc59 \u232a \u2212 \u2329\ud835\udc47\ud835\udc46\u232a (2) In turn, \u2206\ud835\udc3a \ud835\udc4f\ud835\udc56\ud835\udc5b\ud835\udc51 can also be represented as: \u2206\ud835\udc3a \ud835\udc4f\ud835\udc56\ud835\udc5b\ud835\udc51 = \u2206\ud835\udc3b \u2212 \ud835\udc47\u2206\ud835\udc46 (3) where \u2206\ud835\udc3b corresponds to the enthalpy of binding and \u2212\ud835\udc47\u2206\ud835\udc46 to the conformational entropy after ligand binding. When the entropic term is dismissed, the computed value is the effective free energy, which is usually sufficient for comparing relative binding free energies of related ligands. The \u2206\ud835\udc3b can be decomposed into different terms: \u2206\ud835\udc3b = \u2206\ud835\udc38 \ud835\udc40\ud835\udc40 + \u2206\ud835\udc3a \ud835\udc60\ud835\udc5c\ud835\udc59 (4) where: \u2206\ud835\udc38 \ud835\udc40\ud835\udc40 = \u2206\ud835\udc38 \ud835\udc4f\ud835\udc5c\ud835\udc5b\ud835\udc51\ud835\udc52\ud835\udc51 + \u2206\ud835\udc38 \ud835\udc5b\ud835\udc5c\ud835\udc5b\ud835\udc4f\ud835\udc5c\ud835\udc5b\ud835\udc51\ud835\udc52\ud835\udc51 = (\u2206\ud835\udc38 \ud835\udc4f\ud835\udc5c\ud835\udc5b\ud835\udc51 + \u2206\ud835\udc38 \ud835\udc4e\ud835\udc5b\ud835\udc54\ud835\udc59\ud835\udc52 + \u2206\ud835\udc38 \ud835\udc51\ud835\udc56\u210e\ud835\udc52\ud835\udc51\ud835\udc5f\ud835\udc4e\ud835\udc59 ) + (\u2206\ud835\udc38 \ud835\udc52\ud835\udc59\ud835\udc52 + \u2206\ud835\udc38 \ud835\udc63\ud835\udc51\ud835\udc4a ) (5) The gas phase free energy contributions (\u2206\ud835\udc38 \ud835\udc40\ud835\udc40 ) are calculated by sander within the AmberTools package according to the force field used in the MD simulation. The \u2206\ud835\udc3a \ud835\udc60\ud835\udc5c\ud835\udc59 is given by: \u2206\ud835\udc3a \ud835\udc60\ud835\udc5c\ud835\udc59 = \u2206\ud835\udc3a \ud835\udc5d\ud835\udc5c\ud835\udc59 + \u2206\ud835\udc3a \ud835\udc5b\ud835\udc5c\ud835\udc5b\u2212\ud835\udc5d\ud835\udc5c\ud835\udc59 = \u2206\ud835\udc3a \ud835\udc43\ud835\udc35/\ud835\udc3a\ud835\udc35 + \u2206\ud835\udc3a \ud835\udc5b\ud835\udc5c\ud835\udc5b\u2212\ud835\udc5d\ud835\udc5c\ud835\udc59 (6) where: \u2206\ud835\udc3a \ud835\udc5b\ud835\udc5c\ud835\udc5b\u2212\ud835\udc5d\ud835\udc5c\ud835\udc59\ud835\udc4e\ud835\udc5f = \ud835\udc41\ud835\udc43 \ud835\udc47\ud835\udc38\ud835\udc41\ud835\udc46\ud835\udc3c\ud835\udc42\ud835\udc41 \u2217 \u2206\ud835\udc46\ud835\udc34\ud835\udc46\ud835\udc34 + \ud835\udc41\ud835\udc43 \ud835\udc42\ud835\udc39\ud835\udc39\ud835\udc46\ud835\udc38\ud835\udc47 (7) or, \u2206\ud835\udc3a \ud835\udc5b\ud835\udc5c\ud835\udc5b\u2212\ud835\udc5d\ud835\udc5c\ud835\udc59 = \u2206\ud835\udc3a \ud835\udc51\ud835\udc56\ud835\udc60\ud835\udc5d + \u2206\ud835\udc3a \ud835\udc50\ud835\udc4e\ud835\udc63\ud835\udc56\ud835\udc61\ud835\udc66 = \u2206\ud835\udc3a \ud835\udc51\ud835\udc56\ud835\udc60\ud835\udc5d + (\ud835\udc36\ud835\udc34\ud835\udc49\ud835\udc3c\ud835\udc47\ud835\udc4c \ud835\udc47\ud835\udc38\ud835\udc41\ud835\udc46\ud835\udc3c\ud835\udc42\ud835\udc41 \u2217 \u2206\ud835\udc46\ud835\udc34\ud835\udc46\ud835\udc34 + \ud835\udc36\ud835\udc34\ud835\udc49\ud835\udc3c\ud835\udc47\ud835\udc4c \ud835\udc42\ud835\udc39\ud835\udc39\ud835\udc46\ud835\udc38\ud835\udc47 ) (8) In the above equations, \u2206\ud835\udc38 \ud835\udc40\ud835\udc40 corresponds to the molecular mechanical energy changes in the gas phase. \u2206\ud835\udc38 \ud835\udc40\ud835\udc40 includes \u2206\ud835\udc38 \ud835\udc4f\ud835\udc5c\ud835\udc5b\ud835\udc51\ud835\udc52\ud835\udc51 , also known as internal energy, and \u2206\ud835\udc38 \ud835\udc5b\ud835\udc5c\ud835\udc5b\ud835\udc4f\ud835\udc5c\ud835\udc5b\ud835\udc51\ud835\udc52\ud835\udc51 , corresponding to the van der Waals and electrostatic contributions. The solvation energy is determined differently, depending on the method employed. In the 3D-RISM model, both components -polar and non polar- of the solvation energy are calculated. However, the PB and GB models estimate only the polar component of the solvation. The non polar component is usually assumed to be proportional to the molecule's total solvent accessible surface area (SASA), with a proportionality constant derived from experimental solvation energies of small non polar molecules (eq. 7). Alternatively, a modern approach that separates non-polar solvation free energies into cavity and dispersion terms can be used. In this approach, SASA is used to correlate the cavity term only, while a surface-integration method is employed to compute the dispersion term (eq. 8). Furthermore, the entropic component is usually calculated by normal modes analysis (NMODE). The translational and rotational entropies can be estimated using standard statistical mechanical formulas. Nevertheless, calculating vibrational entropy using normal modes is computationally expensive because it requires expanding the internal coordinate covariance matrix for all degrees of freedom for a set of minimized structures. Conversely, the Quasi-harmonic (QH) approximation is less computationally expensive, although it requires a considerable number of frames to converge. Recently, other alternatives have been developed, such as NMODE in truncated systems, which considerably reduces the computational cost. Interaction Entropy (IE) is another novel method that calculates the entropic component of the binding free energy directly from MD simulations without any extra computational cost. This method is numerically reliable, more computationally efficient, and superior to the standard NMODE approach, as shown in an extensive study of over a dozen randomly selected protein-ligand binding systems. Typically, two approaches are used for MM/PB(GB)SA calculations, known as Single Trajectory Protocol (STP) and Multiple Trajectory Protocol (MTP). In STP, both the receptor and the ligand trajectories are extracted from that of the complex. This approach is valid when the bound and unbound states of the receptor, and the ligand are similar. It is computationally less expensive than the MTP approach since only a simulation of the complex is required. Additionally, the potential internal terms ( e.g. , bonds, angles, and dihedrals) cancel exactly in STP since these terms are the same in both bound and unbound states. On the other hand, the MTP is a more realistic approach because it considers multiple trajectories ( i.e. , complex, receptor, and ligand). However, significant conformational changes can lead to numerous errors. In practice, a detailed study of the system is required to select the approach to be used.","title":"Introduction"},{"location":"introduction/#literature","text":"Further information can be found in Amber manual : MMPBSA.py The Generalized Born/Surface Area Model PBSA Reference Interaction Site Model Generalized Born (GB) for QM/MM calculations and the foundational papers: Srinivasan J. et al., 1998 Kollman P. A. et al., 2000 Gohlke H., Case D. A. 2004 as well as some reviews: Genheden S., Ryde U. 2015 Wang et. al., 2018 Wang et. al., 2019","title":"Literature"},{"location":"output/","text":"Output Files \u00b6 The output file \u00b6 This is how a typical output file looks like: | Run on Wed Jun 16 02:53:07 2021 |---> Date of running | |Input file: |-------------------------------------------------------------- | |Sample input file for GB calculation | |#This input file is meant to show only that gmx_MMPBSA works. Although, we | |#tried to use the input files as recommended in the | |#Amber manual, some parameters have been changed to perform more expensive | |#calculations in a reasonable amount of time. Feel free to change the | |#parameters according to what is better for your system. | |&general | |startframe=301, endframe=1000, verbose=2, PBRadii=3, interval=7, |---> Input file (*.in) |/ | |&gb | |igb=2, saltcon=0.150, | |/ | |&pb | |istrng=0.15, fillratio=4.0, radiopt=0, | |/ | |-------------------------------------------------------------- |gmx_MMPBSA Version=v1.4.3+6.g25a02b8 based on MMPBSA.py v.16.0 |---> gmx_MMPBSA version used |Complex topology file: COM.prmtop | |Receptor topology file: REC.prmtop | |Ligand topology file: LIG.prmtop | |Initial mdcrd(s): COM_traj_0.xtc | | |Receptor mask: \":1-266\" | |Ligand mask: \":267\" |---> receptor and ligand information |Ligand residue name is \"MFU\" | | |Calculations performed using 100 complex frames. | |Poisson Boltzmann calculations performed using internal PBSA solver in sander. | | |---> general description of the |Generalized Born ESURF calculated using 'LCPO' surface areas | method used and units | | |All units are reported in kcal/mole. | ------------------------------------------------------------------------------- ------------------------------------------------------------------------------- GENERALIZED BORN: |---> results for GB calculation Complex: Energy Component Average Std. Dev. Std. Err. of Mean | ------------------------------------------------------------------------------- | BOND 759.4785 23.3077 2.3308 | ANGLE 1803.1508 30.8183 3.0818 | DIHED 3216.1217 18.5641 1.8564 | VDWAALS -2085.3102 15.8085 1.5808 | EEL -18735.2906 44.2758 4.4276 | 1-4 VDW 873.7890 11.3567 1.1357 | 1-4 EEL 11088.2966 34.0205 3.4021 |---> Energetic components (complex) EGB -2349.7950 20.1898 2.0190 | ESURF 74.5964 0.4837 0.0484 | | G gas -3079.7641 46.8525 4.6852 | G solv -2275.1986 20.1875 2.0187 | | TOTAL -5354.9627 39.7488 3.9749 | Receptor: Energy Component Average Std. Dev. Std. Err. of Mean | ------------------------------------------------------------------------------- | BOND 752.3559 22.9770 2.2977 | ANGLE 1787.7219 30.5141 3.0514 | DIHED 3211.0390 18.6469 1.8647 | VDWAALS -2066.0693 15.3943 1.5394 | EEL -18584.3471 43.8360 4.3836 | 1-4 VDW 873.7890 11.3567 1.1357 | 1-4 EEL 11088.2966 34.0205 3.4021 |---> Energetic components (receptor) EGB -2365.3357 20.2920 2.0292 | ESURF 75.1071 0.4790 0.0479 | | G gas -2937.2141 46.8804 4.6880 | G solv -2290.2286 20.2874 2.0287 | | TOTAL -5227.4426 39.5203 3.9520 | Ligand: Energy Component Average Std. Dev. Std. Err. of Mean | ------------------------------------------------------------------------------- | BOND 7.1226 2.2202 0.2220 | ANGLE 15.4289 2.9490 0.2949 | DIHED 5.0827 0.5376 0.0538 | VDWAALS -1.9909 0.3267 0.0327 | EEL -96.9811 2.5449 0.2545 | EGB -25.3239 1.3225 0.1322 | ESURF 2.2611 0.0154 0.0015 |---> Energetic components (ligand) | G gas -71.3377 5.0695 0.5070 | G solv -23.0628 1.3164 0.1316 | | TOTAL -94.4005 4.4250 0.4425 | Differences (Complex - Receptor - Ligand): |---> Differences in Energetic components Energy Component Average Std. Dev. Std. Err. of Mean | ------------------------------------------------------------------------------- | BOND -0.0000 0.0000 0.0000 |---> bond potential term ANGLE -0.0000 0.0000 0.0000 |---> angle potential term DIHED 0.0000 0.0001 0.0000 |---> dihedral potential term VDWAALS -17.2500 2.4428 0.2443 |---> van der Waals contribution EEL -53.9624 4.2749 0.4275 |---> electrostatic contribution 1-4 VDW 0.0000 0.0000 0.0000 |---> van der Waals 1-4 contribution 1-4 EEL 0.0000 0.0000 0.0000 |---> electrostatic 1-4 contribution EGB 40.8646 2.0983 0.2098 |---> polar contribution to the solvation free energy ESURF -2.7718 0.0462 0.0046 |---> non-polar contribution to the solvation free energy | DELTA G gas -71.2123 3.3059 0.3306 |---> = BOND + ANGLE + DIHED + VDWAALS + EEL DELTA G solv 38.0928 2.1012 0.2101 |---> = EGB + ESURF | DELTA TOTAL -33.1195 2.1204 0.2120 |---> = DELTA G gas + DELTA G solv ------------------------------------------------------------------------------- ------------------------------------------------------------------------------- The header of the output file will contain information about the calculation. It will show a copy of the input file as well as the names of all files that were used in the calculation (topology files and coordinate file(s)). If the masks were not specified, it prints its best guess so that you can verify its accuracy, along with the residue name of the ligand (if it is only a single residue). The energy and entropy contributions are broken up into their components as they are in sander and nmode or ptraj . The contributions are further broken into G gas and G solv . The polar and non-polar contributions are EGB (or EPB ) and ESURF (or ECAVITY / ENPOLAR ), respectively for GB (or PB ) calculations. A single trajectory does not produce any differences between bond lengths, angles, or dihedrals between the complex and receptor/ligand structures. Thus, when subtracted they cancel completely. This includes the BOND , ANGLE , DIHED , and 1-4 interactions . If inconsistencies are found, these values are displayed and inconsistency warnings are printed. When this occurs the results are generally useless. Of course this does not hold for the multiple trajectory protocol, and so all energy components are printed in this case. Finally, all warnings generated during the calculation that do not result in fatal errors are printed after calculation details but before any results. Temporary Files \u00b6 Warning This section does not record all the temporary files that are currently generated. gmx_MMPBSA creates working files during the execution of the script beginning with the prefix _GMXMMPBSA_ . If gmx_MMPBSA does not finish successfully, several of these files may be helpful in diagnosing the problem. For that reason, every temporary file is described below. Note that not every temporary file is generated in every simulation. At the end of each description, the lowest value of the original \u201ckeep_files\u201d variable that will retain this file will be shown in parentheses. Nevertheless, in the current version, all the files are retained for plotting purposes. gmx_MMPBSA.log This file contains the output coming from gmx_MMPBSA . leap.log This file contains the output coming from tleap program. _GMXMMPBSA_gb.mdin Input file that controls the GB calculation done in sander. (2) _GMXMMPBSA_pb.mdin Input file that controls the PB calculation done in sander. (2) _GMXMMPBSA_gb_decomp_com.mdin Input file that controls the GB decomp calculation for the complex done in sander. (2) _GMXMMPBSA_gb_decomp_rec.mdin Input file that controls the GB decomp calculation for the receptor done in sander. (2) _GMXMMPBSA_gb_decomp_lig.mdin Input file that controls the GB decomp calculation for the ligand done in sander. (2) _GMXMMPBSA_pb_decomp_com.mdin Input file that controls the PB decomp calculation for the complex done in sander. (2) _GMXMMPBSA_pb_decomp_rec.mdin Input file that controls the PB decomp calculation for the receptor done in sander. (2) _GMXMMPBSA_pb_decomp_lig.mdin Input file that controls the PB decomp calculation for the ligand done in sander. (2) _GMXMMPBSA_gb_qmmm_com.mdin Input file that controls the GB QM/MM calculation for the complex done in sander. (2) _GMXMMPBSA_gb_qmmm_rec.mdin Input file that controls the GB QM/MM calculation for the receptor done in sander. (2) _GMXMMPBSA_gb_qmmm_lig.mdin Input file that controls the GB QM/MM calculation for the ligand done in sander. (2) _GMXMMPBSA_complex.mdcrd.# Trajectory file(s) that contains only those complex snapshots that will be processed by MMPBSA.py. (1) _GMXMMPBSA_ligand.mdcrd.# Trajectory file(s) that contains only those ligand snapshots that will be processed by MMPBSA.py. (1) _GMXMMPBSA_receptor.mdcrd.# Trajectory file(s) that contains only those receptor snapshots that will be processed by MMPBSA.py. (1) _GMXMMPBSA_complex_nc.# Same as _GMXMMPBSA_complex.mdcrd.#, except in the NetCDF format. (1) _GMXMMPBSA_receptor_nc.# Same as _GMXMMPBSA_receptor.mdcrd.#, except in the NetCDF format. (1) _GMXMMPBSA_ligand_nc.# Same as _GMXMMPBSA_ligand.mdcrd.#, except in the NetCDF format. (1) _GMXMMPBSA_dummycomplex.inpcrd Dummy inpcrd file generated by _GMXMMPBSA_complexinpcrd.in for use with imin=5 functionality in sander. (1) _GMXMMPBSA_dummyreceptor.inpcrd Same as above, but for the receptor. (1) _GMXMMPBSA_dummyligand.inpcrd Same as above, but for the ligand. (1) _GMXMMPBSA_complex.pdb Dummy PDB file of the complex required to set molecule up in nab programs _GMXMMPBSA_receptor.pdb Dummy PDB file of the receptor required to set molecule up in nab programs _GMXMMPBSA_ligand.pdb Dummy PDB file of the ligand required to set molecule up in nab programs _GMXMMPBSA_complex_nm.mdcrd.# Trajectory file(s) for each thread with snapshots used for normal mode calcula- tions on the complex. (1) _GMXMMPBSA_receptor_nm.mdcrd.# Trajectory file for each thread with snapshots used for normal mode calcula- tions on the receptor. (1) _GMXMMPBSA_ligand_nm.mdcrd.# Trajectory file for each thread with snapshots used for normal mode calculations on the ligand. (1) _GMXMMPBSA_ptrajentropy.in Input file that calculates the entropy via the quasi-harmonic approximation. This file is processed by ptraj. (2) _GMXMMPBSA_avgcomplex.pdb PDB file containing the average positions of all complex conformations processed by _GMXMMPBSA_cenptraj.in. It is used as the reference for the _GMXMMPBSA_ptrajentropy.in file above. (1) _GMXMMPBSA_complex_entropy.out File into which the entropy results from _GMXMMPBSA_ptrajentropy.in analysis on the complex are dumped. (1) _GMXMMPBSA_receptor_entropy.out Same as above, but for the receptor. (1) _GMXMMPBSA_ligand_entropy.out Same as above, but for the ligand. (1) _GMXMMPBSA_ptraj_entropy.out Output from running ptraj using _GMXMMPBSA_ptrajentropy.in. (1) _GMXMMPBSA_complex_gb.mdout.# sander output file containing energy components of all complex snapshots done in GB. (1) _GMXMMPBSA_receptor_gb.mdout.# sander output file containing energy components of all receptor snapshots done in GB. ( 1) _GMXMMPBSA_ligand_gb.mdout.# sander output file containing energy components of all ligand snapshots done in GB. (1) _GMXMMPBSA_complex_pb.mdout.# sander output file containing energy components of all complex snapshots done in PB. (1) _GMXMMPBSA_receptor_pb.mdout.# sander output file containing energy components of all receptor snapshots done in PB. ( 1) _GMXMMPBSA_ligand_pb.mdout.# sander output file containing energy components of all ligand snapshots done in PB. (1) _GMXMMPBSA_complex_rism.out.# rism3d.snglpnt output file containing energy components of all complex snap- shots done with 3D-RISM (1) _GMXMMPBSA_receptor_rism.out.# rism3d.snglpnt output file containing energy components of all receptor snap- shots done with 3D-RISM (1) _GMXMMPBSA_ligand_rism.out.# rism3d.snglpnt output file containing energy components of all ligand snapshots done with 3D-RISM (1) _GMXMMPBSA_pbsanderoutput.junk.# File containing the information dumped by sander.APBS to STDOUT. (1) _GMXMMPBSA_ligand_nm.out.# Output file from mmpbsa_py_nabnmode that contains the entropy data for the ligand for all snapshots. (1) _GMXMMPBSA_receptor_nm.out.# Output file from mmpbsa_py_nabnmode that contains the entropy data for the receptor for all snapshots. (1) _GMXMMPBSA_complex_nm.out.# Output file from mmpbsa_py_nabnmode that contains the entropy data for the com- plex for all snapshots. (1) _GMXMMPBSA_mutant_... These files are analogs of the files that only start with _GMXMMPBSA_ described above, but instead refer to the mutant system of alanine scanning calculations. _GMXMMPBSA_*out.# These files are thread-specific files. For serial simulations, only #=0 files are created. For parallel, #=0 through NUM_PROC - 1 are created.","title":"The output Files"},{"location":"output/#output-files","text":"","title":"Output Files"},{"location":"output/#the-output-file","text":"This is how a typical output file looks like: | Run on Wed Jun 16 02:53:07 2021 |---> Date of running | |Input file: |-------------------------------------------------------------- | |Sample input file for GB calculation | |#This input file is meant to show only that gmx_MMPBSA works. Although, we | |#tried to use the input files as recommended in the | |#Amber manual, some parameters have been changed to perform more expensive | |#calculations in a reasonable amount of time. Feel free to change the | |#parameters according to what is better for your system. | |&general | |startframe=301, endframe=1000, verbose=2, PBRadii=3, interval=7, |---> Input file (*.in) |/ | |&gb | |igb=2, saltcon=0.150, | |/ | |&pb | |istrng=0.15, fillratio=4.0, radiopt=0, | |/ | |-------------------------------------------------------------- |gmx_MMPBSA Version=v1.4.3+6.g25a02b8 based on MMPBSA.py v.16.0 |---> gmx_MMPBSA version used |Complex topology file: COM.prmtop | |Receptor topology file: REC.prmtop | |Ligand topology file: LIG.prmtop | |Initial mdcrd(s): COM_traj_0.xtc | | |Receptor mask: \":1-266\" | |Ligand mask: \":267\" |---> receptor and ligand information |Ligand residue name is \"MFU\" | | |Calculations performed using 100 complex frames. | |Poisson Boltzmann calculations performed using internal PBSA solver in sander. | | |---> general description of the |Generalized Born ESURF calculated using 'LCPO' surface areas | method used and units | | |All units are reported in kcal/mole. | ------------------------------------------------------------------------------- ------------------------------------------------------------------------------- GENERALIZED BORN: |---> results for GB calculation Complex: Energy Component Average Std. Dev. Std. Err. of Mean | ------------------------------------------------------------------------------- | BOND 759.4785 23.3077 2.3308 | ANGLE 1803.1508 30.8183 3.0818 | DIHED 3216.1217 18.5641 1.8564 | VDWAALS -2085.3102 15.8085 1.5808 | EEL -18735.2906 44.2758 4.4276 | 1-4 VDW 873.7890 11.3567 1.1357 | 1-4 EEL 11088.2966 34.0205 3.4021 |---> Energetic components (complex) EGB -2349.7950 20.1898 2.0190 | ESURF 74.5964 0.4837 0.0484 | | G gas -3079.7641 46.8525 4.6852 | G solv -2275.1986 20.1875 2.0187 | | TOTAL -5354.9627 39.7488 3.9749 | Receptor: Energy Component Average Std. Dev. Std. Err. of Mean | ------------------------------------------------------------------------------- | BOND 752.3559 22.9770 2.2977 | ANGLE 1787.7219 30.5141 3.0514 | DIHED 3211.0390 18.6469 1.8647 | VDWAALS -2066.0693 15.3943 1.5394 | EEL -18584.3471 43.8360 4.3836 | 1-4 VDW 873.7890 11.3567 1.1357 | 1-4 EEL 11088.2966 34.0205 3.4021 |---> Energetic components (receptor) EGB -2365.3357 20.2920 2.0292 | ESURF 75.1071 0.4790 0.0479 | | G gas -2937.2141 46.8804 4.6880 | G solv -2290.2286 20.2874 2.0287 | | TOTAL -5227.4426 39.5203 3.9520 | Ligand: Energy Component Average Std. Dev. Std. Err. of Mean | ------------------------------------------------------------------------------- | BOND 7.1226 2.2202 0.2220 | ANGLE 15.4289 2.9490 0.2949 | DIHED 5.0827 0.5376 0.0538 | VDWAALS -1.9909 0.3267 0.0327 | EEL -96.9811 2.5449 0.2545 | EGB -25.3239 1.3225 0.1322 | ESURF 2.2611 0.0154 0.0015 |---> Energetic components (ligand) | G gas -71.3377 5.0695 0.5070 | G solv -23.0628 1.3164 0.1316 | | TOTAL -94.4005 4.4250 0.4425 | Differences (Complex - Receptor - Ligand): |---> Differences in Energetic components Energy Component Average Std. Dev. Std. Err. of Mean | ------------------------------------------------------------------------------- | BOND -0.0000 0.0000 0.0000 |---> bond potential term ANGLE -0.0000 0.0000 0.0000 |---> angle potential term DIHED 0.0000 0.0001 0.0000 |---> dihedral potential term VDWAALS -17.2500 2.4428 0.2443 |---> van der Waals contribution EEL -53.9624 4.2749 0.4275 |---> electrostatic contribution 1-4 VDW 0.0000 0.0000 0.0000 |---> van der Waals 1-4 contribution 1-4 EEL 0.0000 0.0000 0.0000 |---> electrostatic 1-4 contribution EGB 40.8646 2.0983 0.2098 |---> polar contribution to the solvation free energy ESURF -2.7718 0.0462 0.0046 |---> non-polar contribution to the solvation free energy | DELTA G gas -71.2123 3.3059 0.3306 |---> = BOND + ANGLE + DIHED + VDWAALS + EEL DELTA G solv 38.0928 2.1012 0.2101 |---> = EGB + ESURF | DELTA TOTAL -33.1195 2.1204 0.2120 |---> = DELTA G gas + DELTA G solv ------------------------------------------------------------------------------- ------------------------------------------------------------------------------- The header of the output file will contain information about the calculation. It will show a copy of the input file as well as the names of all files that were used in the calculation (topology files and coordinate file(s)). If the masks were not specified, it prints its best guess so that you can verify its accuracy, along with the residue name of the ligand (if it is only a single residue). The energy and entropy contributions are broken up into their components as they are in sander and nmode or ptraj . The contributions are further broken into G gas and G solv . The polar and non-polar contributions are EGB (or EPB ) and ESURF (or ECAVITY / ENPOLAR ), respectively for GB (or PB ) calculations. A single trajectory does not produce any differences between bond lengths, angles, or dihedrals between the complex and receptor/ligand structures. Thus, when subtracted they cancel completely. This includes the BOND , ANGLE , DIHED , and 1-4 interactions . If inconsistencies are found, these values are displayed and inconsistency warnings are printed. When this occurs the results are generally useless. Of course this does not hold for the multiple trajectory protocol, and so all energy components are printed in this case. Finally, all warnings generated during the calculation that do not result in fatal errors are printed after calculation details but before any results.","title":"The output file"},{"location":"output/#temporary-files","text":"Warning This section does not record all the temporary files that are currently generated. gmx_MMPBSA creates working files during the execution of the script beginning with the prefix _GMXMMPBSA_ . If gmx_MMPBSA does not finish successfully, several of these files may be helpful in diagnosing the problem. For that reason, every temporary file is described below. Note that not every temporary file is generated in every simulation. At the end of each description, the lowest value of the original \u201ckeep_files\u201d variable that will retain this file will be shown in parentheses. Nevertheless, in the current version, all the files are retained for plotting purposes. gmx_MMPBSA.log This file contains the output coming from gmx_MMPBSA . leap.log This file contains the output coming from tleap program. _GMXMMPBSA_gb.mdin Input file that controls the GB calculation done in sander. (2) _GMXMMPBSA_pb.mdin Input file that controls the PB calculation done in sander. (2) _GMXMMPBSA_gb_decomp_com.mdin Input file that controls the GB decomp calculation for the complex done in sander. (2) _GMXMMPBSA_gb_decomp_rec.mdin Input file that controls the GB decomp calculation for the receptor done in sander. (2) _GMXMMPBSA_gb_decomp_lig.mdin Input file that controls the GB decomp calculation for the ligand done in sander. (2) _GMXMMPBSA_pb_decomp_com.mdin Input file that controls the PB decomp calculation for the complex done in sander. (2) _GMXMMPBSA_pb_decomp_rec.mdin Input file that controls the PB decomp calculation for the receptor done in sander. (2) _GMXMMPBSA_pb_decomp_lig.mdin Input file that controls the PB decomp calculation for the ligand done in sander. (2) _GMXMMPBSA_gb_qmmm_com.mdin Input file that controls the GB QM/MM calculation for the complex done in sander. (2) _GMXMMPBSA_gb_qmmm_rec.mdin Input file that controls the GB QM/MM calculation for the receptor done in sander. (2) _GMXMMPBSA_gb_qmmm_lig.mdin Input file that controls the GB QM/MM calculation for the ligand done in sander. (2) _GMXMMPBSA_complex.mdcrd.# Trajectory file(s) that contains only those complex snapshots that will be processed by MMPBSA.py. (1) _GMXMMPBSA_ligand.mdcrd.# Trajectory file(s) that contains only those ligand snapshots that will be processed by MMPBSA.py. (1) _GMXMMPBSA_receptor.mdcrd.# Trajectory file(s) that contains only those receptor snapshots that will be processed by MMPBSA.py. (1) _GMXMMPBSA_complex_nc.# Same as _GMXMMPBSA_complex.mdcrd.#, except in the NetCDF format. (1) _GMXMMPBSA_receptor_nc.# Same as _GMXMMPBSA_receptor.mdcrd.#, except in the NetCDF format. (1) _GMXMMPBSA_ligand_nc.# Same as _GMXMMPBSA_ligand.mdcrd.#, except in the NetCDF format. (1) _GMXMMPBSA_dummycomplex.inpcrd Dummy inpcrd file generated by _GMXMMPBSA_complexinpcrd.in for use with imin=5 functionality in sander. (1) _GMXMMPBSA_dummyreceptor.inpcrd Same as above, but for the receptor. (1) _GMXMMPBSA_dummyligand.inpcrd Same as above, but for the ligand. (1) _GMXMMPBSA_complex.pdb Dummy PDB file of the complex required to set molecule up in nab programs _GMXMMPBSA_receptor.pdb Dummy PDB file of the receptor required to set molecule up in nab programs _GMXMMPBSA_ligand.pdb Dummy PDB file of the ligand required to set molecule up in nab programs _GMXMMPBSA_complex_nm.mdcrd.# Trajectory file(s) for each thread with snapshots used for normal mode calcula- tions on the complex. (1) _GMXMMPBSA_receptor_nm.mdcrd.# Trajectory file for each thread with snapshots used for normal mode calcula- tions on the receptor. (1) _GMXMMPBSA_ligand_nm.mdcrd.# Trajectory file for each thread with snapshots used for normal mode calculations on the ligand. (1) _GMXMMPBSA_ptrajentropy.in Input file that calculates the entropy via the quasi-harmonic approximation. This file is processed by ptraj. (2) _GMXMMPBSA_avgcomplex.pdb PDB file containing the average positions of all complex conformations processed by _GMXMMPBSA_cenptraj.in. It is used as the reference for the _GMXMMPBSA_ptrajentropy.in file above. (1) _GMXMMPBSA_complex_entropy.out File into which the entropy results from _GMXMMPBSA_ptrajentropy.in analysis on the complex are dumped. (1) _GMXMMPBSA_receptor_entropy.out Same as above, but for the receptor. (1) _GMXMMPBSA_ligand_entropy.out Same as above, but for the ligand. (1) _GMXMMPBSA_ptraj_entropy.out Output from running ptraj using _GMXMMPBSA_ptrajentropy.in. (1) _GMXMMPBSA_complex_gb.mdout.# sander output file containing energy components of all complex snapshots done in GB. (1) _GMXMMPBSA_receptor_gb.mdout.# sander output file containing energy components of all receptor snapshots done in GB. ( 1) _GMXMMPBSA_ligand_gb.mdout.# sander output file containing energy components of all ligand snapshots done in GB. (1) _GMXMMPBSA_complex_pb.mdout.# sander output file containing energy components of all complex snapshots done in PB. (1) _GMXMMPBSA_receptor_pb.mdout.# sander output file containing energy components of all receptor snapshots done in PB. ( 1) _GMXMMPBSA_ligand_pb.mdout.# sander output file containing energy components of all ligand snapshots done in PB. (1) _GMXMMPBSA_complex_rism.out.# rism3d.snglpnt output file containing energy components of all complex snap- shots done with 3D-RISM (1) _GMXMMPBSA_receptor_rism.out.# rism3d.snglpnt output file containing energy components of all receptor snap- shots done with 3D-RISM (1) _GMXMMPBSA_ligand_rism.out.# rism3d.snglpnt output file containing energy components of all ligand snapshots done with 3D-RISM (1) _GMXMMPBSA_pbsanderoutput.junk.# File containing the information dumped by sander.APBS to STDOUT. (1) _GMXMMPBSA_ligand_nm.out.# Output file from mmpbsa_py_nabnmode that contains the entropy data for the ligand for all snapshots. (1) _GMXMMPBSA_receptor_nm.out.# Output file from mmpbsa_py_nabnmode that contains the entropy data for the receptor for all snapshots. (1) _GMXMMPBSA_complex_nm.out.# Output file from mmpbsa_py_nabnmode that contains the entropy data for the com- plex for all snapshots. (1) _GMXMMPBSA_mutant_... These files are analogs of the files that only start with _GMXMMPBSA_ described above, but instead refer to the mutant system of alanine scanning calculations. _GMXMMPBSA_*out.# These files are thread-specific files. For serial simulations, only #=0 files are created. For parallel, #=0 through NUM_PROC - 1 are created.","title":"Temporary Files"},{"location":"private_policy/","text":"Private Policy \u00b6 Effective date: May 13, 2021 Welcome to gmx_MMPBSA Documentation. We believe in protecting the privacy of our users, and readers. The short version \u00b6 We use Google Analytics as a third party tracking service. We only collect the usage data (may include information such as the pages of our Website that You visit, the time and date of Your visit, the time spent on those pages, unique device identifiers and other diagnostic data) through Google Analytics which helps us evaluate our users\u2019 use of gmx_MMPBSA Documentation. We do not share, sell, rent, or trade this information with third parties for their commercial purposes; and we only use it as this Privacy Policy describes. Our services \u00b6 gmx_MMPBSA Documentation is made up of: https://valdes-tresanco-ms.github.io/gmx_MMPBSA This is a website aimed at people that use gmx_MMPBSA. This Privacy Policy applies to this site in full without reservation. All use of gmx_MMPBSA Documentation is subject to this Privacy Policy. What information gmx_MMPBSA Documentation and why \u00b6 We use Google Analytics as a third party tracking service, but we don\u2019t use it to track you individually or collect your User Personal Information. We use Google Analytics to collect information about how our website performs and how our users, in general, navigate through and use gmx_MMPBSA Documentation. This helps us evaluate our users\u2019 use of gmx_MMPBSA Documentation; compile statistical reports on activity; and improve our content and website performance. Google Analytics gathers certain simple, non-personally identifying information over time, such as your IP address, browser type, internet service provider, referring and exit pages, time stamp, and similar data about your use of gmx_MMPBSA Documentation. We will not allow any third party to, use the Google Analytics tool to track our users individually; collect any User Personal Information other than IP address; or correlate your IP address with your identity. Google provides further information about its own privacy practices and offers a browser add-on to opt out of Google Analytics tracking. Why do we collect this? \u00b6 We collect this information to better understand how our website visitors use gmx_MMPBSA Documentation, and to monitor and protect the security of the website. What information gmx_MMPBSA Documentation does not collect \u00b6 We do not intentionally collect sensitive personal information, such as social security numbers, genetic data, health information, or religious information. How we share the information we collect \u00b6 We do not share, sell, rent, or trade User Personal Information with third parties for their commercial purposes. Contacting Us \u00b6 If you have any questions about this Privacy Policy, You can contact us: By email: mariosergiovaldes145@gmail.com","title":"Private Policy"},{"location":"private_policy/#private-policy","text":"Effective date: May 13, 2021 Welcome to gmx_MMPBSA Documentation. We believe in protecting the privacy of our users, and readers.","title":"Private Policy"},{"location":"private_policy/#the-short-version","text":"We use Google Analytics as a third party tracking service. We only collect the usage data (may include information such as the pages of our Website that You visit, the time and date of Your visit, the time spent on those pages, unique device identifiers and other diagnostic data) through Google Analytics which helps us evaluate our users\u2019 use of gmx_MMPBSA Documentation. We do not share, sell, rent, or trade this information with third parties for their commercial purposes; and we only use it as this Privacy Policy describes.","title":"The short version"},{"location":"private_policy/#our-services","text":"gmx_MMPBSA Documentation is made up of: https://valdes-tresanco-ms.github.io/gmx_MMPBSA This is a website aimed at people that use gmx_MMPBSA. This Privacy Policy applies to this site in full without reservation. All use of gmx_MMPBSA Documentation is subject to this Privacy Policy.","title":"Our services"},{"location":"private_policy/#what-information-gmx_mmpbsa-documentation-and-why","text":"We use Google Analytics as a third party tracking service, but we don\u2019t use it to track you individually or collect your User Personal Information. We use Google Analytics to collect information about how our website performs and how our users, in general, navigate through and use gmx_MMPBSA Documentation. This helps us evaluate our users\u2019 use of gmx_MMPBSA Documentation; compile statistical reports on activity; and improve our content and website performance. Google Analytics gathers certain simple, non-personally identifying information over time, such as your IP address, browser type, internet service provider, referring and exit pages, time stamp, and similar data about your use of gmx_MMPBSA Documentation. We will not allow any third party to, use the Google Analytics tool to track our users individually; collect any User Personal Information other than IP address; or correlate your IP address with your identity. Google provides further information about its own privacy practices and offers a browser add-on to opt out of Google Analytics tracking.","title":"What information gmx_MMPBSA Documentation and why"},{"location":"private_policy/#why-do-we-collect-this","text":"We collect this information to better understand how our website visitors use gmx_MMPBSA Documentation, and to monitor and protect the security of the website.","title":"Why do we collect this?"},{"location":"private_policy/#what-information-gmx_mmpbsa-documentation-does-not-collect","text":"We do not intentionally collect sensitive personal information, such as social security numbers, genetic data, health information, or religious information.","title":"What information gmx_MMPBSA Documentation does not collect"},{"location":"private_policy/#how-we-share-the-information-we-collect","text":"We do not share, sell, rent, or trade User Personal Information with third parties for their commercial purposes.","title":"How we share the information we collect"},{"location":"private_policy/#contacting-us","text":"If you have any questions about this Privacy Policy, You can contact us: By email: mariosergiovaldes145@gmail.com","title":"Contacting Us"},{"location":"summary/","text":"gmx_MMPBSA in a nutshell \u00b6 gmx_MMPBSA brings in all the MMPBSA.py functionalities to GROMACS users. In addition, other functionalities have been implemented that ease a number of calculations ( e.g. MM/PB(GB)SA with user-defined internal dielectric constant, interaction entropy and C2 entropy calculations). A GUI application is also incorporated that allows for visualizing the results and saving high-quality images. Types of calculations you can do \u00b6 There are many options available in gmx_MMPBSA . These are some calculations you can perform with gmx_MMPBSA : Normal binding free energies , with either PB, GB or 3D-RISM solvent models. Each can be done with either 1, 2, or 3 different trajectories. The complex trajectory must always be provided. Whichever trajectories of the receptor and/or ligand that are NOT specified will be extracted from the complex trajectory. This allows a 1-, 2-, or 3-trajectory analysis. All PB calculations and GB models can be performed with just AmberTools via the sander program. Calculations with 3D-RISM solvent model are performed with rism3d.snglpnt built with AmberTools. Stability calculations with any model solvent model ( i.e PB, GB or 3D-RISM). Alanine scanning with either PB or GB implicit solvent models. All trajectories will be mutated to match the mutated topology files, and whichever calculations that would be carried out for the normal systems are also carried out for the mutated systems. Note that only 1 mutation is allowed per simulation, and it must be to an alanine or glycine. If mutant_only is not set to 1, differences resulting from the mutations are calculated. Entropy corrections . An entropy term can be added to the free energies calculated above using either the quasi-harmonic, the normal mode, interaction entropy or C2 approximations. Calculations will be performed for the normal and mutated systems (alanine scanning) as requested. Normal mode calculations are done with the mmpbsa_py_nabnmode program included with AmberTools. Decomposition schemes . The energy terms will be decomposed according to the decomposition scheme outlined in the idecomp variable description. This should work with all the above, though entropy terms cannot be decomposed. QM/MMGBSA . This is a binding free energy (or stability calculation) using the Generalized Born solvent model allowing you to treat part of your system with a quantum mechanical Hamiltonian. Membrane Protein MMPBSA . Calculate the MMPBSA binding free energy for a ligand bound to a protein that is embedded into a membrane. In this case, the membrane is implemented as a slab-like region with a uniform or heterogeneous dielectric constant depth profile. gmx_MMPBSA a technical view \u00b6 gmx_MMPBSA is a python module that contains 3 applications: gmx_MMPBSA is the fundamental application and carries out all the calculations mentioned above gmx_MMPBSA_ana provides an intuitive way to analyze the data from gmx_MMPBSA calculations and save high-quality pictures gmx_MMPBSA_test is a tool designed to test if the installation was successful by running one or more available examples in gmx_MMPBSA.","title":"gmx_MMPBSA in a nutshell"},{"location":"summary/#gmx_mmpbsa-in-a-nutshell","text":"gmx_MMPBSA brings in all the MMPBSA.py functionalities to GROMACS users. In addition, other functionalities have been implemented that ease a number of calculations ( e.g. MM/PB(GB)SA with user-defined internal dielectric constant, interaction entropy and C2 entropy calculations). A GUI application is also incorporated that allows for visualizing the results and saving high-quality images.","title":"gmx_MMPBSA in a nutshell"},{"location":"summary/#types-of-calculations-you-can-do","text":"There are many options available in gmx_MMPBSA . These are some calculations you can perform with gmx_MMPBSA : Normal binding free energies , with either PB, GB or 3D-RISM solvent models. Each can be done with either 1, 2, or 3 different trajectories. The complex trajectory must always be provided. Whichever trajectories of the receptor and/or ligand that are NOT specified will be extracted from the complex trajectory. This allows a 1-, 2-, or 3-trajectory analysis. All PB calculations and GB models can be performed with just AmberTools via the sander program. Calculations with 3D-RISM solvent model are performed with rism3d.snglpnt built with AmberTools. Stability calculations with any model solvent model ( i.e PB, GB or 3D-RISM). Alanine scanning with either PB or GB implicit solvent models. All trajectories will be mutated to match the mutated topology files, and whichever calculations that would be carried out for the normal systems are also carried out for the mutated systems. Note that only 1 mutation is allowed per simulation, and it must be to an alanine or glycine. If mutant_only is not set to 1, differences resulting from the mutations are calculated. Entropy corrections . An entropy term can be added to the free energies calculated above using either the quasi-harmonic, the normal mode, interaction entropy or C2 approximations. Calculations will be performed for the normal and mutated systems (alanine scanning) as requested. Normal mode calculations are done with the mmpbsa_py_nabnmode program included with AmberTools. Decomposition schemes . The energy terms will be decomposed according to the decomposition scheme outlined in the idecomp variable description. This should work with all the above, though entropy terms cannot be decomposed. QM/MMGBSA . This is a binding free energy (or stability calculation) using the Generalized Born solvent model allowing you to treat part of your system with a quantum mechanical Hamiltonian. Membrane Protein MMPBSA . Calculate the MMPBSA binding free energy for a ligand bound to a protein that is embedded into a membrane. In this case, the membrane is implemented as a slab-like region with a uniform or heterogeneous dielectric constant depth profile.","title":"Types of calculations you can do"},{"location":"summary/#gmx_mmpbsa-a-technical-view","text":"gmx_MMPBSA is a python module that contains 3 applications: gmx_MMPBSA is the fundamental application and carries out all the calculations mentioned above gmx_MMPBSA_ana provides an intuitive way to analyze the data from gmx_MMPBSA calculations and save high-quality pictures gmx_MMPBSA_test is a tool designed to test if the installation was successful by running one or more available examples in gmx_MMPBSA.","title":"gmx_MMPBSA a technical view"},{"location":"support/","text":"Support \u00b6 Report an issue and Getting help \u00b6 You can review some of the answers to the questions that we consider most common here. If you find a bug or have any question, please consider opening an issue or post in our Google group Jetbrains \u00b6 This project is possible thanks to the Open Source license of the JetBrains programs. Acknowledgment \u00b6","title":"Support"},{"location":"support/#support","text":"","title":"Support"},{"location":"support/#report-an-issue-and-getting-help","text":"You can review some of the answers to the questions that we consider most common here. If you find a bug or have any question, please consider opening an issue or post in our Google group","title":"Report an issue and Getting help"},{"location":"support/#jetbrains","text":"This project is possible thanks to the Open Source license of the JetBrains programs.","title":"Jetbrains"},{"location":"support/#acknowledgment","text":"","title":"Acknowledgment"},{"location":"versus/","text":"Comparison of gmx_MMPBSA vs other programs \u00b6 This comparison is based on the documentation of the different programs Calculation features \u00b6 Feature g_mmpbsa GMXPBSA 2.1 MMPBSA.py 1 gmx_MMPBSA Normal binding free energies PB PB PB and GB PB and GB * GB models 1, 2, 5, 7 and 8 1, 2, 5, 7 and 8 Stability Alanine scanning 2 Entropy corrections 3 nmode and qh nmode, qh, and IE Decomposition schemes Per-Residues Per-Residues and Per-Wise Per-Residues and Per-Wise QM/MMGBSA MM/3D-RISM Membrane Protein MMPBSA Approximations ST ST and MT ST and MT ST and MT Analysis features \u00b6 Feature g_mmpbsa GMXPBSA 2.1 MMPBSA.py 1 gmx_MMPBSA API Analyzer Tool 4 * Multiple systems at same time * Correlation between systems * Per-residue energies to PDB * Interactive visualization ** 3D Molecular Visualization PyMOL ** Interactive Charts static image * Plotting tool internal tools API and graphics library 5 gmx_MMPBSA_ana * Energetic Terms charts \u0394G polar , \u0394G nonpolar , \u0394E MM and \u0394G bind All * Export data to CSV file ** Energy Summary ** Individual Energetic Terms Technical features \u00b6 Feature g_mmpbsa GMXPBSA 2.1 MMPBSA.py 1 gmx_MMPBSA GROMACS Version 4.x, 5.x and 2016+ 6 4.x, 5.x and 20xx.x 7 --- 4.x, 5.x and 20xx.x Externals programs APBS (1.2.x, 1.3.x or 1.4.x) APBS (1.x.x) 8 AmberTools20/21 AmberTools20/21 9 Parallel computation Depends on APBS Locally using APBS or in HPC divided in jobs Steps for: * Calculation and Summary Multiple Multiple One One * Analysis Multiple Multiple Multiple One MMPBSA.py is included in AMBER package \u21a9 \u21a9 \u21a9 Without documentation \u21a9 nmode = Normal modes approximation, qh = Quasic-Harmony approximation and IE = Interaction Entropy approximation \u21a9 We plan to extend gmx_MMPBSA compatibility to MMPBSA.py's results \u21a9 Currently there is a repository ( AmberUtils ) for analysing the results \u21a9 GROMACS 20xx.x is not officially supported. There is a Pull Request that offers a minimum compatibility with versions higher than 2016.x one, but still with limitations \u21a9 It is not clear whether it does support GROMACS versions 20xx.x or not, but we assume that it does since it is script-based \u21a9 It is not clear whether it does support APBS versions 3.x.x \u21a9 gmx_MMPBSA is compatible with AmberTools20 or AmberTools21 \u21a9","title":"gmx_MMPBSA vs other programs"},{"location":"versus/#comparison-of-gmx_mmpbsa-vs-other-programs","text":"This comparison is based on the documentation of the different programs","title":"Comparison of gmx_MMPBSA vs other programs"},{"location":"versus/#calculation-features","text":"Feature g_mmpbsa GMXPBSA 2.1 MMPBSA.py 1 gmx_MMPBSA Normal binding free energies PB PB PB and GB PB and GB * GB models 1, 2, 5, 7 and 8 1, 2, 5, 7 and 8 Stability Alanine scanning 2 Entropy corrections 3 nmode and qh nmode, qh, and IE Decomposition schemes Per-Residues Per-Residues and Per-Wise Per-Residues and Per-Wise QM/MMGBSA MM/3D-RISM Membrane Protein MMPBSA Approximations ST ST and MT ST and MT ST and MT","title":"Calculation features"},{"location":"versus/#analysis-features","text":"Feature g_mmpbsa GMXPBSA 2.1 MMPBSA.py 1 gmx_MMPBSA API Analyzer Tool 4 * Multiple systems at same time * Correlation between systems * Per-residue energies to PDB * Interactive visualization ** 3D Molecular Visualization PyMOL ** Interactive Charts static image * Plotting tool internal tools API and graphics library 5 gmx_MMPBSA_ana * Energetic Terms charts \u0394G polar , \u0394G nonpolar , \u0394E MM and \u0394G bind All * Export data to CSV file ** Energy Summary ** Individual Energetic Terms","title":"Analysis features"},{"location":"versus/#technical-features","text":"Feature g_mmpbsa GMXPBSA 2.1 MMPBSA.py 1 gmx_MMPBSA GROMACS Version 4.x, 5.x and 2016+ 6 4.x, 5.x and 20xx.x 7 --- 4.x, 5.x and 20xx.x Externals programs APBS (1.2.x, 1.3.x or 1.4.x) APBS (1.x.x) 8 AmberTools20/21 AmberTools20/21 9 Parallel computation Depends on APBS Locally using APBS or in HPC divided in jobs Steps for: * Calculation and Summary Multiple Multiple One One * Analysis Multiple Multiple Multiple One MMPBSA.py is included in AMBER package \u21a9 \u21a9 \u21a9 Without documentation \u21a9 nmode = Normal modes approximation, qh = Quasic-Harmony approximation and IE = Interaction Entropy approximation \u21a9 We plan to extend gmx_MMPBSA compatibility to MMPBSA.py's results \u21a9 Currently there is a repository ( AmberUtils ) for analysing the results \u21a9 GROMACS 20xx.x is not officially supported. There is a Pull Request that offers a minimum compatibility with versions higher than 2016.x one, but still with limitations \u21a9 It is not clear whether it does support GROMACS versions 20xx.x or not, but we assume that it does since it is script-based \u21a9 It is not clear whether it does support APBS versions 3.x.x \u21a9 gmx_MMPBSA is compatible with AmberTools20 or AmberTools21 \u21a9","title":"Technical features"},{"location":"Q%26A/","text":"Support \u00b6 Here you will find some of the most frequently asked questions and errors. Also, look at our Google group or the issues section to find out about specific cases and others. If you still have doubts or cannot solve the problem, please consider opening an issue or post it in our Google group","title":"Support"},{"location":"Q%26A/#support","text":"Here you will find some of the most frequently asked questions and errors. Also, look at our Google group or the issues section to find out about specific cases and others. If you still have doubts or cannot solve the problem, please consider opening an issue or post it in our Google group","title":"Support"},{"location":"Q%26A/OS_issues/","text":"Operative System compatibility issues \u00b6 Here we describe a series of more frequent reported problems related mainly to compatibility issues and supported OS and their possible solutions. gmx_MMPBSA fail in macOS < BigSur Solution: \u00b6 We have only tested gmx_MMPBSA on macOS BigSur and it works fine. Since a problem related to a version lower than BigSur was reported, we assume that it is not compatible. Please check this thread gmx_MMPBSA_ana fails in non-native Linux distribution ( i.e. , Windows Subsystem for Linux (WSL), Debian, Centos or HPC) Solution: \u00b6 I am using Windows Subsystem for Linux (WSL) The WSL has no graphics drivers, thus it is impossible to run native Linux graphics applications. Therefore, there is currently no way to run gmx_MMPBSA_ana in such an environment. I am using Debian or Centos as OS Since Debian and Centos are Linux distributions for servers, their main focus is stability, which is why they keep old versions of most libraries. In addition, its GUI is very basic, as it is generally not widely used. gmx_MMPBSA_ana uses the latest PyQt5 version which requires updated graphics libraries. That is why we recommend the use of more desktop-focused distributions such as Ubuntu, Linux Mint, Fedora, OpenSuse, Majaro, etc. I am running gmx_MMPBSA on HPC By default, HPCs have the GUI disabled, therefore any application that depends on the graphics libraries will end in error. gmx_MMPBSA has the -nogui option to avoid this type of errors since it prevents gmx_MMBSA_ana from being executed at the end of the calculations. Therefore, just add -nogui at the end of the command line and it should be good to go. Error with qt.qpa.plugin I get an error related to Qt plugins If you get the following or similar error: qt.qpa.plugin: Could not load the Qt platform plugin \"xcb\" in \"\" even though it was found. Solution: \u00b6 A possible solution may be to reinstall these libraries sudo apt install --reinstall libxcb-xinerama0","title":"OS issues"},{"location":"Q%26A/OS_issues/#operative-system-compatibility-issues","text":"Here we describe a series of more frequent reported problems related mainly to compatibility issues and supported OS and their possible solutions. gmx_MMPBSA fail in macOS < BigSur","title":"Operative System compatibility issues"},{"location":"Q%26A/OS_issues/#solution","text":"We have only tested gmx_MMPBSA on macOS BigSur and it works fine. Since a problem related to a version lower than BigSur was reported, we assume that it is not compatible. Please check this thread gmx_MMPBSA_ana fails in non-native Linux distribution ( i.e. , Windows Subsystem for Linux (WSL), Debian, Centos or HPC)","title":"Solution:"},{"location":"Q%26A/OS_issues/#solution_1","text":"I am using Windows Subsystem for Linux (WSL) The WSL has no graphics drivers, thus it is impossible to run native Linux graphics applications. Therefore, there is currently no way to run gmx_MMPBSA_ana in such an environment. I am using Debian or Centos as OS Since Debian and Centos are Linux distributions for servers, their main focus is stability, which is why they keep old versions of most libraries. In addition, its GUI is very basic, as it is generally not widely used. gmx_MMPBSA_ana uses the latest PyQt5 version which requires updated graphics libraries. That is why we recommend the use of more desktop-focused distributions such as Ubuntu, Linux Mint, Fedora, OpenSuse, Majaro, etc. I am running gmx_MMPBSA on HPC By default, HPCs have the GUI disabled, therefore any application that depends on the graphics libraries will end in error. gmx_MMPBSA has the -nogui option to avoid this type of errors since it prevents gmx_MMBSA_ana from being executed at the end of the calculations. Therefore, just add -nogui at the end of the command line and it should be good to go. Error with qt.qpa.plugin I get an error related to Qt plugins If you get the following or similar error: qt.qpa.plugin: Could not load the Qt platform plugin \"xcb\" in \"\" even though it was found.","title":"Solution:"},{"location":"Q%26A/OS_issues/#solution_2","text":"A possible solution may be to reinstall these libraries sudo apt install --reinstall libxcb-xinerama0","title":"Solution:"},{"location":"Q%26A/calculations/","text":"gmx_MMPBSA Calculations \u00b6 Here we describe a series of frequent issues related to calculations and their possible solutions. Note Most of the errors noted here are the result of inconsistent input files. Please read the documentation and make sure your files are consistent. ValueError: could not convert string to float: '*************' This error has two possible causes: The structure defined in -cs , -ps , or -ls options is inconsistent, or the trajectory has not been fitted (remove PBC) properly. This is the most common error. Many times it is because the system under study is longer than some edges of the box. Possible solutions: \u00b6 Check for structure consistency Visualize the structure contained in the structure input file given in the -cs , -rs , or -ls options and make sure it is consistent (as shown in Fig 1, right panel). On the other hand, if the structure is \"broken\" (as shown in Fig 1, left panel) this will generate inconsistent results. Generate the structure from tpr file gmx editconf -f md.tpr -o md.pdb Figure 1. Vizualization of two different input structures files. Left: \"Broken\" structure; Right: Centered structure Make sure you have fitted the trajectory Visualize the trajectory given in the -ct , -rt , or -lt options and make sure the PBC has been removed (as shown in Fig 2, right panel). On the other hand, if the trajectory has not been fitted (as shown in Fig 2, left panel) this will generate inconsistent results. Steps: Generate a group that contains both molecules gmx make_ndx -n index.ndx >1 | 12 >q Assuming 1 is the receptor and 12 is the ligand. This creates a new group (number 20 in this example) remove the PBC gmx trjconv -s md.tpr -f md.xtc -o md_noPBC.xtc -pbc mol -center -n -ur compact center: 20 (created group) output: 0 remove the rotation and translation with respect to the reference structure (optional) gmx trjconv -s md.tpr -f md_noPBC.xtc -o md_fit.xtc -n -fit rot+trans fit: 20 (created group) output: 0 Visualization Make sure that the trajectory is consistent (as shown in Fig 2, right panel) Figure 2. Vizualization of two different input trajectory files. Left: Trajectory with PBC; Right: Trajectory centered, fitted and with PBC removed. You are trying to calculate the energetic contribution of a very large group. Technically, the energy value should not exceed 7 digits, so if you get a value higher than this, this error will occur. Although gmx_MMPBSA can handle very large systems as described in example Ribosomal50S_Mycalamide_A , it cannot determine certain energetic terms. This is a limitation of Sander when writing the output file. Possible solutions: \u00b6 The error could be solved by recompiling Sander with some modifications in the output function. However, this is not recommended since the error can be large. Another possible solution could be modifying the parameters of the calculation (solvent model, internal dielectric constant) or just performing the calculation for a part of the system (sub-system). I get high values for the solvation energy when using PB model When using PB model, inp=2 is used as default to calculate total non-polar solvation free energy, that is, the total non-polar solvation free energy will be modeled as two terms: the cavity term and the dispersion term. The dispersion term is computed with a surface-based integration method closely related to the PCM solvent for quantum chemical programs. Under this framework, the cavity term is still computed as a term linearly proportional to the molecular solvent-accessible-surface area (SASA) or the molecular volume enclosed by SASA. Possible solutions: \u00b6 You may want to try inp=1 and avoid the EDISPER contribution. This way, the total non-polar solvation free energy will be modeled as a single term linearly proportional to the solvent-accessible surface area. Just add inp=1 in the &pb namelist variables in the input file. See example below: &general startframe=5, endframe=100, interval=5, verbose=2, forcefields=\"oldff/leaprc.ff99SB,leaprc.gaff\" / &pb istrng=0.15, fillratio=4.0, inp=1 / Check this publication and see the drawbacks of modeling the total non-polar solvation free energy with two terms, i.e. , the cavity term and the dispersion term. Sometimes there are imbalances in the cancellation of error between the two components and this can produce unrealistic non-polar energy values. NMODE calculation finish in error The only error reported is probably related to RAM saturation. NMODE calculations require a considerable amount of RAM depending on the number of atoms in your system. The amount of total RAM consumed during the calculation will be: RAM for 1 frame * number of threads","title":"Calculations"},{"location":"Q%26A/calculations/#gmx_mmpbsa-calculations","text":"Here we describe a series of frequent issues related to calculations and their possible solutions. Note Most of the errors noted here are the result of inconsistent input files. Please read the documentation and make sure your files are consistent. ValueError: could not convert string to float: '*************' This error has two possible causes: The structure defined in -cs , -ps , or -ls options is inconsistent, or the trajectory has not been fitted (remove PBC) properly. This is the most common error. Many times it is because the system under study is longer than some edges of the box.","title":"gmx_MMPBSA Calculations"},{"location":"Q%26A/calculations/#possible-solutions","text":"Check for structure consistency Visualize the structure contained in the structure input file given in the -cs , -rs , or -ls options and make sure it is consistent (as shown in Fig 1, right panel). On the other hand, if the structure is \"broken\" (as shown in Fig 1, left panel) this will generate inconsistent results. Generate the structure from tpr file gmx editconf -f md.tpr -o md.pdb Figure 1. Vizualization of two different input structures files. Left: \"Broken\" structure; Right: Centered structure Make sure you have fitted the trajectory Visualize the trajectory given in the -ct , -rt , or -lt options and make sure the PBC has been removed (as shown in Fig 2, right panel). On the other hand, if the trajectory has not been fitted (as shown in Fig 2, left panel) this will generate inconsistent results. Steps: Generate a group that contains both molecules gmx make_ndx -n index.ndx >1 | 12 >q Assuming 1 is the receptor and 12 is the ligand. This creates a new group (number 20 in this example) remove the PBC gmx trjconv -s md.tpr -f md.xtc -o md_noPBC.xtc -pbc mol -center -n -ur compact center: 20 (created group) output: 0 remove the rotation and translation with respect to the reference structure (optional) gmx trjconv -s md.tpr -f md_noPBC.xtc -o md_fit.xtc -n -fit rot+trans fit: 20 (created group) output: 0 Visualization Make sure that the trajectory is consistent (as shown in Fig 2, right panel) Figure 2. Vizualization of two different input trajectory files. Left: Trajectory with PBC; Right: Trajectory centered, fitted and with PBC removed. You are trying to calculate the energetic contribution of a very large group. Technically, the energy value should not exceed 7 digits, so if you get a value higher than this, this error will occur. Although gmx_MMPBSA can handle very large systems as described in example Ribosomal50S_Mycalamide_A , it cannot determine certain energetic terms. This is a limitation of Sander when writing the output file.","title":"Possible solutions:"},{"location":"Q%26A/calculations/#possible-solutions_1","text":"The error could be solved by recompiling Sander with some modifications in the output function. However, this is not recommended since the error can be large. Another possible solution could be modifying the parameters of the calculation (solvent model, internal dielectric constant) or just performing the calculation for a part of the system (sub-system). I get high values for the solvation energy when using PB model When using PB model, inp=2 is used as default to calculate total non-polar solvation free energy, that is, the total non-polar solvation free energy will be modeled as two terms: the cavity term and the dispersion term. The dispersion term is computed with a surface-based integration method closely related to the PCM solvent for quantum chemical programs. Under this framework, the cavity term is still computed as a term linearly proportional to the molecular solvent-accessible-surface area (SASA) or the molecular volume enclosed by SASA.","title":"Possible solutions:"},{"location":"Q%26A/calculations/#possible-solutions_2","text":"You may want to try inp=1 and avoid the EDISPER contribution. This way, the total non-polar solvation free energy will be modeled as a single term linearly proportional to the solvent-accessible surface area. Just add inp=1 in the &pb namelist variables in the input file. See example below: &general startframe=5, endframe=100, interval=5, verbose=2, forcefields=\"oldff/leaprc.ff99SB,leaprc.gaff\" / &pb istrng=0.15, fillratio=4.0, inp=1 / Check this publication and see the drawbacks of modeling the total non-polar solvation free energy with two terms, i.e. , the cavity term and the dispersion term. Sometimes there are imbalances in the cancellation of error between the two components and this can produce unrealistic non-polar energy values. NMODE calculation finish in error The only error reported is probably related to RAM saturation. NMODE calculations require a considerable amount of RAM depending on the number of atoms in your system. The amount of total RAM consumed during the calculation will be: RAM for 1 frame * number of threads","title":"Possible solutions:"},{"location":"Q%26A/installation/","text":"Installation \u00b6 Here we describe a series of more frequent reported problems related mainly to the installation process and their possible solutions. I don't find amber.python executable Solution: \u00b6 Make sure that you have installed Ambertools20 and sourced the amber.sh(zch) file If you installed Ambertools20 from conda, use that python executable I get an error related to MPI when I try to install gmx_MMPBSA If you get an error like this: error: Cannot compile MPI programs. Check your configuration!!! Solution: \u00b6 Please try installing/reinstalling the OpenMPI library like this: sudo apt install openmpi-bin libopenmpi-dev openssh-client or this way sudo apt install --reinstall openmpi-bin libopenmpi-dev openssh-client I don't find the gmx_MMPBSA executable Solution: \u00b6 Make sure that you have installed gmx_MMPBSA ( See here ) Check if the miniconda bin folder are in the PATH ( See here ) Check if the gmx_MMPBSA application has permission to run as a program When I run gmx_MMPBSA I get this error ModuleNotFoundError: No module named 'parmed' Solution: \u00b6 Please see this issue to see the solution","title":"Installation"},{"location":"Q%26A/installation/#installation","text":"Here we describe a series of more frequent reported problems related mainly to the installation process and their possible solutions. I don't find amber.python executable","title":"Installation"},{"location":"Q%26A/installation/#solution","text":"Make sure that you have installed Ambertools20 and sourced the amber.sh(zch) file If you installed Ambertools20 from conda, use that python executable I get an error related to MPI when I try to install gmx_MMPBSA If you get an error like this: error: Cannot compile MPI programs. Check your configuration!!!","title":"Solution:"},{"location":"Q%26A/installation/#solution_1","text":"Please try installing/reinstalling the OpenMPI library like this: sudo apt install openmpi-bin libopenmpi-dev openssh-client or this way sudo apt install --reinstall openmpi-bin libopenmpi-dev openssh-client I don't find the gmx_MMPBSA executable","title":"Solution:"},{"location":"Q%26A/installation/#solution_2","text":"Make sure that you have installed gmx_MMPBSA ( See here ) Check if the miniconda bin folder are in the PATH ( See here ) Check if the gmx_MMPBSA application has permission to run as a program When I run gmx_MMPBSA I get this error ModuleNotFoundError: No module named 'parmed'","title":"Solution:"},{"location":"Q%26A/installation/#solution_3","text":"Please see this issue to see the solution","title":"Solution:"},{"location":"examples/","text":"Here you can find a representation of almost all the types of calculations and analyses that you can perform with gmx_MMPBSA . Although each example focuses on specific cases, you can use gmx_MMPBSA on systems that combine a number of different components ( i.e. metalloprotein-ligand complex, Protein-DNA-ligand, etc.). In addition, several types of calculations ( e.g. GB, Alanine scanning and Per-residue decomposition; PB, Interaction Entropy, and Per-wise decomposition) can be also performed in the same run for a specific system. Systems \u00b6 Protein-protein 1 2 3 Protein-ligand 1 2 Protein-DNA 1 2 3 Protein-glycan 1 2 3 MMPBSA with membrane proteins 1 2 Metalloprotein-peptide 1 2 Multicomponent system (Protein-DNA-RNA-Ions-Ligand) 1 2 3 COVID-19 related proteins Main protease Papain-like protease S1-ACE2 complex S1 RBD with antibody CHARMMff support \u00b6 Protein-Ligand 1 2 Protein-Ligand complex embedded in membrane 1 Mycalamide A Bound to the Large Ribosomal Subunit Protein-Ligand with LPH atoms Analysis \u00b6 Single Trajectory Protocol 1 2 3 Multiple Trajectory Protocol 1 Binding free energy calculations Binding free energy calculation with GB Binding free energy calculation with linear PB (LPBE) Binding free energy calculation with NonLinear PB (non-LPBE) Binding free energy calculation with 3D-RISM model 1 Alanine scanning 1 2 3 Decomposition analysis 1 2 3 Entropy Interaction Entropy calculations 1 2 3 NMODE Entropy calculations 1 C2 Entropy calculations Stability calculations 1 2 3 QM/MMGBSA calculations It is part of the All set defined with -t 0 in gmx_MMPBSA_test \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 It is part of the Minimal set defined with -t 1 in gmx_MMPBSA_test \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 It is part of the Fast set defined with -t 2 in gmx_MMPBSA_test \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9","title":"Examples"},{"location":"examples/#systems","text":"Protein-protein 1 2 3 Protein-ligand 1 2 Protein-DNA 1 2 3 Protein-glycan 1 2 3 MMPBSA with membrane proteins 1 2 Metalloprotein-peptide 1 2 Multicomponent system (Protein-DNA-RNA-Ions-Ligand) 1 2 3 COVID-19 related proteins Main protease Papain-like protease S1-ACE2 complex S1 RBD with antibody","title":"Systems"},{"location":"examples/#charmmff-support","text":"Protein-Ligand 1 2 Protein-Ligand complex embedded in membrane 1 Mycalamide A Bound to the Large Ribosomal Subunit Protein-Ligand with LPH atoms","title":"CHARMMff support"},{"location":"examples/#analysis","text":"Single Trajectory Protocol 1 2 3 Multiple Trajectory Protocol 1 Binding free energy calculations Binding free energy calculation with GB Binding free energy calculation with linear PB (LPBE) Binding free energy calculation with NonLinear PB (non-LPBE) Binding free energy calculation with 3D-RISM model 1 Alanine scanning 1 2 3 Decomposition analysis 1 2 3 Entropy Interaction Entropy calculations 1 2 3 NMODE Entropy calculations 1 C2 Entropy calculations Stability calculations 1 2 3 QM/MMGBSA calculations It is part of the All set defined with -t 0 in gmx_MMPBSA_test \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 It is part of the Minimal set defined with -t 1 in gmx_MMPBSA_test \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 It is part of the Fast set defined with -t 2 in gmx_MMPBSA_test \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9 \u21a9","title":"Analysis"},{"location":"examples/gmx_MMPBSA_test/","text":"gmx_MMPBSA_test command-line \u00b6 $ gmx_MMPBSA_test -h usage: gmx_MMPBSA_test [-h] [-v] [-t [{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18} [{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18} ...]]] [-f FOLDER] [-r] [-ng] [-n NUM_PROCESSORS] This program is part of gmx_MMPBSA and will allow you to run various gmx_MMPBSA examples easily. optional arguments: -h, --help show this help message and exit -v, --version show program's version number and exit Test options: -t [{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18} [{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18} ...]] The level the test is going to be run at. Multiple systems and analysis can be run at the same time. Nr. of Sys * 0 16 All -- Run all examples (Can take a long time!!!) * 1 13 Minimal -- Does a minimal test with a set of systems and analyzes that show that gmx_MMPBSA runs correctly. Only exclude 3drism, nmode protein-ligand MT because take a long time or are redundant * 2 9 Fast -- Only the calculations that take a short time are run (Default) [Systems]: Slow Frames * 3 . | 10 Protein-Ligand (Single trajectory approximation) * 4 . | 10 Protein-Protein * 5 . | 10 Protein-DNA * 6 x | 4 Protein-Membrane * 7 . | 10 Protein-Glycan * 8 x | 4 Metalloprotein-Peptide * 9 . | 10 Protein-DNA-RNA-IONs-Ligand * 10 x | 4 Protein-Ligand (CHARMM force field) * 11 x | 4 Protein-ligand complex in membrane with CHARMMff [Analysis]: Slow Frames * 12 . | 10 Alanine Scanning * 13 . | 10 Stability calculation * 14 . | 10 Decomposition Analysis * 15 . | 16 Interaction Entropy approximation * 16 . | 10 Protein-Ligand (Multiple trajectory approximation) * 17 x | 4 Entropy calculation using Normal Mode approximation * 18 x | 4 Calculations using 3D-RISM approximation -f FOLDER, --folder FOLDER Defines the folder to store all data -r, --reuse Defines the existing test forlder will be reuse -ng, --nogui No open gmx_MMPBSA_ana after all calculations finished -n NUM_PROCESSORS, --num_processors NUM_PROCESSORS Defines the number of processor cores you want to use with MPI per calculation. If the number of frames is less than the number of cpus defined, the calculation will be performed with the number of processors = number of frames. gmx_MMPBSA is an effort to implement the GB/PB and others calculations in GROMACS. Based on MMPBSA.py (version 16.0) and AmberTools20 Running gmx_MMPBSA_test \u00b6 gmx_MMPBSA_test is designed to run a set of samples (all or minimal) or a specific example efficiently. Additionally, gmx_MMPBSA_test can run in parallel, decreasing the execution time gmx_MMPBSA_test will download the most recent version of the repository in the specified folder and will perform the calculations Minimal All Specific gmx_MMPBSA_test -f /home/user/Documents -n 10 Through this command-line, gmxMMPBSA_test will: Download gmx_MMPBSA repository content in /home/user/Documents Works with Fast set of examples [-t 2 is the default] Perform the calculation on 9 examples sequentially, using 10 cpus each time gmx_MMPBSA_test -f /home/user/Documents -t 0 -n 10 Through this command-line, gmxMMPBSA_test will: Download gmx_MMPBSA repository content in /home/user/Documents Works with All set of examples Perform the calculation on 16 examples sequentially, using 10 cpus each time gmx_MMPBSA_test -f /home/user/Documents -t 3 Through this command-line, gmxMMPBSA_test will: Download gmx_MMPBSA repository content in /home/user/Documents Execute 3 [Protein-Ligand (Single Trajectory approach)] example","title":"gmx_MMPBSA_test"},{"location":"examples/gmx_MMPBSA_test/#gmx_mmpbsa_test-command-line","text":"$ gmx_MMPBSA_test -h usage: gmx_MMPBSA_test [-h] [-v] [-t [{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18} [{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18} ...]]] [-f FOLDER] [-r] [-ng] [-n NUM_PROCESSORS] This program is part of gmx_MMPBSA and will allow you to run various gmx_MMPBSA examples easily. optional arguments: -h, --help show this help message and exit -v, --version show program's version number and exit Test options: -t [{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18} [{0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18} ...]] The level the test is going to be run at. Multiple systems and analysis can be run at the same time. Nr. of Sys * 0 16 All -- Run all examples (Can take a long time!!!) * 1 13 Minimal -- Does a minimal test with a set of systems and analyzes that show that gmx_MMPBSA runs correctly. Only exclude 3drism, nmode protein-ligand MT because take a long time or are redundant * 2 9 Fast -- Only the calculations that take a short time are run (Default) [Systems]: Slow Frames * 3 . | 10 Protein-Ligand (Single trajectory approximation) * 4 . | 10 Protein-Protein * 5 . | 10 Protein-DNA * 6 x | 4 Protein-Membrane * 7 . | 10 Protein-Glycan * 8 x | 4 Metalloprotein-Peptide * 9 . | 10 Protein-DNA-RNA-IONs-Ligand * 10 x | 4 Protein-Ligand (CHARMM force field) * 11 x | 4 Protein-ligand complex in membrane with CHARMMff [Analysis]: Slow Frames * 12 . | 10 Alanine Scanning * 13 . | 10 Stability calculation * 14 . | 10 Decomposition Analysis * 15 . | 16 Interaction Entropy approximation * 16 . | 10 Protein-Ligand (Multiple trajectory approximation) * 17 x | 4 Entropy calculation using Normal Mode approximation * 18 x | 4 Calculations using 3D-RISM approximation -f FOLDER, --folder FOLDER Defines the folder to store all data -r, --reuse Defines the existing test forlder will be reuse -ng, --nogui No open gmx_MMPBSA_ana after all calculations finished -n NUM_PROCESSORS, --num_processors NUM_PROCESSORS Defines the number of processor cores you want to use with MPI per calculation. If the number of frames is less than the number of cpus defined, the calculation will be performed with the number of processors = number of frames. gmx_MMPBSA is an effort to implement the GB/PB and others calculations in GROMACS. Based on MMPBSA.py (version 16.0) and AmberTools20","title":"gmx_MMPBSA_test command-line"},{"location":"examples/gmx_MMPBSA_test/#running-gmx_mmpbsa_test","text":"gmx_MMPBSA_test is designed to run a set of samples (all or minimal) or a specific example efficiently. Additionally, gmx_MMPBSA_test can run in parallel, decreasing the execution time gmx_MMPBSA_test will download the most recent version of the repository in the specified folder and will perform the calculations Minimal All Specific gmx_MMPBSA_test -f /home/user/Documents -n 10 Through this command-line, gmxMMPBSA_test will: Download gmx_MMPBSA repository content in /home/user/Documents Works with Fast set of examples [-t 2 is the default] Perform the calculation on 9 examples sequentially, using 10 cpus each time gmx_MMPBSA_test -f /home/user/Documents -t 0 -n 10 Through this command-line, gmxMMPBSA_test will: Download gmx_MMPBSA repository content in /home/user/Documents Works with All set of examples Perform the calculation on 16 examples sequentially, using 10 cpus each time gmx_MMPBSA_test -f /home/user/Documents -t 3 Through this command-line, gmxMMPBSA_test will: Download gmx_MMPBSA repository content in /home/user/Documents Execute 3 [Protein-Ligand (Single Trajectory approach)] example","title":"Running gmx_MMPBSA_test"},{"location":"examples/3D-RISM/","text":"Protein-protein binding free energy calculations with MM/3D-RISM \u00b6 Info This example can be found in the docs/examples/3D-RISM directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository. Requirements \u00b6 In its simplest version, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t 3drism gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Sample input file for MM/3D-RISM This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"3D-RISM\", startframe=5, endframe=8, / &rism polardecomp=0, thermo=\"gf\" / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand (in this case, the ligand is also another protein) amber format topologies and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 19 20 ) are needed. The mmpbsa. in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the MM/PB(GB)SA calculation with the igb2 (GB-OBC1) model and a salt concentration = 0.15M. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please refer to the gmx_MMPBSA_ana section for more information","title":"BFE calculation with 3D-RISM"},{"location":"examples/3D-RISM/#protein-protein-binding-free-energy-calculations-with-mm3d-rism","text":"Info This example can be found in the docs/examples/3D-RISM directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository.","title":"Protein-protein binding free energy calculations with MM/3D-RISM"},{"location":"examples/3D-RISM/#requirements","text":"In its simplest version, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/3D-RISM/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t 3drism gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Sample input file for MM/3D-RISM This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"3D-RISM\", startframe=5, endframe=8, / &rism polardecomp=0, thermo=\"gf\" / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/3D-RISM/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand (in this case, the ligand is also another protein) amber format topologies and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 19 20 ) are needed. The mmpbsa. in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the MM/PB(GB)SA calculation with the igb2 (GB-OBC1) model and a salt concentration = 0.15M. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please refer to the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Alanine_scanning/","text":"Alanine scanning \u00b6 Info This example can be found in the docs/examples/Alanine_scanning directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t ala_scan gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 12 -ct com_traj.xtc mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 12 -ct com_traj.xtc where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 Sample input file for Alanine scanning This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Alanine_Scanning\", startframe=5, endframe=14, verbose=2, forcefields=\"oldff/leaprc.ff99SB\", PBRadii=4, / &gb igb=8, saltcon=0.150, / &alanine_scanning mutant='ALA', mutant_res='B:13', cas_intdiel=1 / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand (in this case, the ligand is DNA) amber format topologies and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 12 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the the MM/PB(GB)SA calculation with the igb8 (GB-Neck2) model and a salt concentration = 0.15M. Of note, mbondi3 radii ( PBRadii=4 ) will be used as recommended for GB-Neck2 solvation model. Also, The dielectric constant ( intdiel ) will be modified depending on the nature of the residue to be mutated as cas_intdiel=1 . In this case, the residue B:13 is an Arginine which means intdiel = 5 will be used. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information How to define properly which residue is going to be mutated? \u00b6 The generated PDB files must keep the original numbering, so selection based on residue number is reliable. However, the chain id can vary depending on several factors. If you use the reference structure ( -cr flag), then you don't have to worry about any changes. The selection will be based on this structure. On the other hand, if this reference structure is omitted, then it will depend on: The complex structure file format The *.gro format does not contain information related to chains. GROMACS version We have noticed that in GROMACS 20xx.x versions, trjconv can omit the chain IDs. The option assign_chainID This option defines when chain IDs are assigned. Please see this variable in &general namelist variables section Tip In any of these cases, you must verify that the selection is correct. You can see the structure of the fixed Complex structure ( _GMXMMPBSA_FIXED_COM.pdb ), Receptor ( _GMXMMPBSA_REC_Fx.pdb ), and ligand ( _GMXMMPBSA_LIG_Fy.pdb ) respectively. x and y represent the fragment for discontinuous molecules","title":"Alanine scanning"},{"location":"examples/Alanine_scanning/#alanine-scanning","text":"Info This example can be found in the docs/examples/Alanine_scanning directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"Alanine scanning"},{"location":"examples/Alanine_scanning/#requirements","text":"In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/Alanine_scanning/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t ala_scan gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 12 -ct com_traj.xtc mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 12 -ct com_traj.xtc where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 Sample input file for Alanine scanning This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Alanine_Scanning\", startframe=5, endframe=14, verbose=2, forcefields=\"oldff/leaprc.ff99SB\", PBRadii=4, / &gb igb=8, saltcon=0.150, / &alanine_scanning mutant='ALA', mutant_res='B:13', cas_intdiel=1 / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/Alanine_scanning/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand (in this case, the ligand is DNA) amber format topologies and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 12 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the the MM/PB(GB)SA calculation with the igb8 (GB-Neck2) model and a salt concentration = 0.15M. Of note, mbondi3 radii ( PBRadii=4 ) will be used as recommended for GB-Neck2 solvation model. Also, The dielectric constant ( intdiel ) will be modified depending on the nature of the residue to be mutated as cas_intdiel=1 . In this case, the residue B:13 is an Arginine which means intdiel = 5 will be used. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Alanine_scanning/#how-to-define-properly-which-residue-is-going-to-be-mutated","text":"The generated PDB files must keep the original numbering, so selection based on residue number is reliable. However, the chain id can vary depending on several factors. If you use the reference structure ( -cr flag), then you don't have to worry about any changes. The selection will be based on this structure. On the other hand, if this reference structure is omitted, then it will depend on: The complex structure file format The *.gro format does not contain information related to chains. GROMACS version We have noticed that in GROMACS 20xx.x versions, trjconv can omit the chain IDs. The option assign_chainID This option defines when chain IDs are assigned. Please see this variable in &general namelist variables section Tip In any of these cases, you must verify that the selection is correct. You can see the structure of the fixed Complex structure ( _GMXMMPBSA_FIXED_COM.pdb ), Receptor ( _GMXMMPBSA_REC_Fx.pdb ), and ligand ( _GMXMMPBSA_LIG_Fy.pdb ) respectively. x and y represent the fragment for discontinuous molecules","title":"How to define properly which residue is going to be mutated?"},{"location":"examples/COVID-19_related_proteins/","text":"Given its relevance, we have tested gmx_MMPBSA with multiple COVID-19 related systems. The ultimate goal is to provide a useful tool for those researchers working on COVID-19 projects. The capability of gmx_MMPBSA to handle systems that combine a number of characteristics (i.e. metalloprotein-ligand, Protein-protein, Membrane proteins, glycosylated proteins etc.) constitutes a tremendous help for those researchers that use MD simulations and binding free energy calculations in their projects. We plan to incorporate more systems as they arise in the literature and databases. All these systems haven been previously prepared in CHARMM-GUI, and they are available at the CHARMM-GUI Archive - COVID-19 Proteins Library . References \u00b6 S. Jo, T. Kim, V.G. Iyer, and W. Im (2008) CHARMM-GUI: A Web-based Graphical User Interface for CHARMM. J. Comput. Chem. 29:1859-1865 H. Woo, S-J. Park, Y.K. Choi, T. Park, M. Tanveer, Y. Cao, N.R. Kern, J. Lee, M.S. Yeom, T.I. Croll, C. Seok, and W. Im (2020) Developing a Fully-glycosylated Full-length SARS-CoV-2 Spike Protein Model in a Viral Membrane. J. Phys. Chem. B. 124:7128\u20137137 Y.K. Choi, Y. Cao, M. Frank, H. Woo, S-J. Park, M.S. Yeom, T.I. Croll, C. Seok, W. Im (2021) Structure, Dynamics, Receptor Binding, and Antibody Binding of Fully-glycosylated Full-length SARS-CoV-2 Spike Protein in a Viral Membrane. J. Chem. Theory Comput. (in press)","title":"Info"},{"location":"examples/COVID-19_related_proteins/#references","text":"S. Jo, T. Kim, V.G. Iyer, and W. Im (2008) CHARMM-GUI: A Web-based Graphical User Interface for CHARMM. J. Comput. Chem. 29:1859-1865 H. Woo, S-J. Park, Y.K. Choi, T. Park, M. Tanveer, Y. Cao, N.R. Kern, J. Lee, M.S. Yeom, T.I. Croll, C. Seok, and W. Im (2020) Developing a Fully-glycosylated Full-length SARS-CoV-2 Spike Protein Model in a Viral Membrane. J. Phys. Chem. B. 124:7128\u20137137 Y.K. Choi, Y. Cao, M. Frank, H. Woo, S-J. Park, M.S. Yeom, T.I. Croll, C. Seok, W. Im (2021) Structure, Dynamics, Receptor Binding, and Antibody Binding of Fully-glycosylated Full-length SARS-CoV-2 Spike Protein in a Viral Membrane. J. Chem. Theory Comput. (in press)","title":"References"},{"location":"examples/COVID-19_related_proteins/Main_protease_7l5d/","text":"CHARMM and MM(PB/GB)SA PB model is recommended when working with CHARMMff files. Nevertheless, the combination of PB/GB models and CHARMM force field hasn't been tested extensively. Please, check this thread for more information and proceed with caution. SARS-CoV-2 Main Protease in complex with demethylated analog of masitinib binding free energy calculations (Single Trajectory method) with CHARMMff files \u00b6 Info This example can be found in the docs/examples/COVID-19_related_proteins/Main_protease_7l5d directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr final GROMACS MD trajectory, fitted and with no pbc. A topology file top take into account that *.itp files belonging to the topology file should be also present in the folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -cp topol.top mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -cp topol.top where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Sample input file for PB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"SARS_CoV2_Main_protease\", verbose=2, / &pb #radiopt=0 is recommended which means using radii from the prmtop file for both the PB calculation and for the NP calculation istrng=0.15, fillratio=4.0, radiopt=0, inp=1, / Remember radiopt = 0 is recommended which means using radii from the prmtop file See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 13 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. A topology file is also needed (mandatory) in this case to generate the topology files in amber format with all the terms for CHARMM force field. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Main protease"},{"location":"examples/COVID-19_related_proteins/Main_protease_7l5d/#sars-cov-2-main-protease-in-complex-with-demethylated-analog-of-masitinib-binding-free-energy-calculations-single-trajectory-method-with-charmmff-files","text":"Info This example can be found in the docs/examples/COVID-19_related_proteins/Main_protease_7l5d directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"SARS-CoV-2 Main Protease in complex with demethylated analog of masitinib binding free energy calculations (Single Trajectory method) with CHARMMff files"},{"location":"examples/COVID-19_related_proteins/Main_protease_7l5d/#requirements","text":"In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr final GROMACS MD trajectory, fitted and with no pbc. A topology file top take into account that *.itp files belonging to the topology file should be also present in the folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/COVID-19_related_proteins/Main_protease_7l5d/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -cp topol.top mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -cp topol.top where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Sample input file for PB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"SARS_CoV2_Main_protease\", verbose=2, / &pb #radiopt=0 is recommended which means using radii from the prmtop file for both the PB calculation and for the NP calculation istrng=0.15, fillratio=4.0, radiopt=0, inp=1, / Remember radiopt = 0 is recommended which means using radii from the prmtop file See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/COVID-19_related_proteins/Main_protease_7l5d/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 13 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. A topology file is also needed (mandatory) in this case to generate the topology files in amber format with all the terms for CHARMM force field. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/COVID-19_related_proteins/Papain-like_protease_7koj/","text":"CHARMM and MM(PB/GB)SA PB model is recommended when working with CHARMMff files. Nevertheless, the combination of PB/GB models and CHARMM force field hasn't been tested extensively. Please, check this thread for more information and proceed with caution. Papain-Like Protease of SARS CoV-2, C111S mutant, in complex with PLP_Snyder494 inhibitor binding free energy calculations (Single Trajectory method) with CHARMMff files \u00b6 Info This example can be found in the docs/examples/COVID-19_related_proteins/Papain-like_protease_7koj directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr final GROMACS MD trajectory, fitted and with no pbc. A topology file top take into account that *.itp files belonging to the topology file should be also present in the folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 18 13 -ct com_traj.xtc -cp topol.top mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 18 13 -ct com_traj.xtc -cp topol.top where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Sample input file for PB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"SARS_CoV2_Papain_like_protease\", verbose=2, / &pb #radiopt=0 is recommended which means using radii from the prmtop file for both the PB calculation and for the NP calculation istrng=0.15, fillratio=4.0, radiopt=0, inp=1, / Remember radiopt = 0 is recommended which means using radii from the prmtop file See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 18 13 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. A topology file is also needed (mandatory) in this case to generate the topology files in amber format with all the terms for CHARMM force field. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Papain-like protease"},{"location":"examples/COVID-19_related_proteins/Papain-like_protease_7koj/#papain-like-protease-of-sars-cov-2-c111s-mutant-in-complex-with-plp_snyder494-inhibitor-binding-free-energy-calculations-single-trajectory-method-with-charmmff-files","text":"Info This example can be found in the docs/examples/COVID-19_related_proteins/Papain-like_protease_7koj directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"Papain-Like Protease of SARS CoV-2, C111S mutant, in complex with PLP_Snyder494 inhibitor binding free energy calculations (Single Trajectory method) with CHARMMff files"},{"location":"examples/COVID-19_related_proteins/Papain-like_protease_7koj/#requirements","text":"In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr final GROMACS MD trajectory, fitted and with no pbc. A topology file top take into account that *.itp files belonging to the topology file should be also present in the folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/COVID-19_related_proteins/Papain-like_protease_7koj/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 18 13 -ct com_traj.xtc -cp topol.top mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 18 13 -ct com_traj.xtc -cp topol.top where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Sample input file for PB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"SARS_CoV2_Papain_like_protease\", verbose=2, / &pb #radiopt=0 is recommended which means using radii from the prmtop file for both the PB calculation and for the NP calculation istrng=0.15, fillratio=4.0, radiopt=0, inp=1, / Remember radiopt = 0 is recommended which means using radii from the prmtop file See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/COVID-19_related_proteins/Papain-like_protease_7koj/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 18 13 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. A topology file is also needed (mandatory) in this case to generate the topology files in amber format with all the terms for CHARMM force field. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/COVID-19_related_proteins/S1-ACE2_complex_7dmu/","text":"CHARMM and MM(PB/GB)SA PB model is recommended when working with CHARMMff files. Nevertheless, the combination of PB/GB models and CHARMM force field hasn't been tested extensively. Please, check this thread for more information and proceed with caution. SARS-CoV-2 spike receptor-binding domain complexed with high affinity ACE2 mutant 3N39 binding free energy calculations (Single Trajectory method) with CHARMMff files \u00b6 Info This example can be found in the docs/examples/COVID-19_related_proteins/S1-ACE2_complex_7dmu directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr final GROMACS MD trajectory, fitted and with no pbc. A topology file top take into account that *.itp files belonging to the topology file should be also present in the folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 20 19 -ct com_traj.xtc -cp topol.top mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 20 19 -ct com_traj.xtc -cp topol.top where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Sample input file for PB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"SARS_CoV2_S1_ACE\", verbose=2, / &pb #radiopt=0 is recommended which means using radii from the prmtop file for both the PB calculation and for the NP calculation istrng=0.15, fillratio=4.0, radiopt=0, inp=1, / Remember radiopt = 0 is recommended which means using radii from the prmtop file See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 20 19 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. A topology file is also needed (mandatory) in this case to generate the topology files in amber format with all the terms for CHARMM force field. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"S1-ACE2 complex"},{"location":"examples/COVID-19_related_proteins/S1-ACE2_complex_7dmu/#sars-cov-2-spike-receptor-binding-domain-complexed-with-high-affinity-ace2-mutant-3n39-binding-free-energy-calculations-single-trajectory-method-with-charmmff-files","text":"Info This example can be found in the docs/examples/COVID-19_related_proteins/S1-ACE2_complex_7dmu directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"SARS-CoV-2 spike receptor-binding domain complexed with high affinity ACE2 mutant 3N39 binding free energy calculations (Single Trajectory method) with CHARMMff files"},{"location":"examples/COVID-19_related_proteins/S1-ACE2_complex_7dmu/#requirements","text":"In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr final GROMACS MD trajectory, fitted and with no pbc. A topology file top take into account that *.itp files belonging to the topology file should be also present in the folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/COVID-19_related_proteins/S1-ACE2_complex_7dmu/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 20 19 -ct com_traj.xtc -cp topol.top mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 20 19 -ct com_traj.xtc -cp topol.top where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Sample input file for PB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"SARS_CoV2_S1_ACE\", verbose=2, / &pb #radiopt=0 is recommended which means using radii from the prmtop file for both the PB calculation and for the NP calculation istrng=0.15, fillratio=4.0, radiopt=0, inp=1, / Remember radiopt = 0 is recommended which means using radii from the prmtop file See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/COVID-19_related_proteins/S1-ACE2_complex_7dmu/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 20 19 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. A topology file is also needed (mandatory) in this case to generate the topology files in amber format with all the terms for CHARMM force field. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/COVID-19_related_proteins/S1_RBD_with_antibody_6zlr/","text":"CHARMM and MM(PB/GB)SA PB model is recommended when working with CHARMMff files. Nevertheless, the combination of PB/GB models and CHARMM force field hasn't been tested extensively. Please, check this thread for more information and proceed with caution. SARS-CoV-2 Receptor Binding Domain (RBD):CR3022 antibody complex binding free energy calculations (Single Trajectory method) with CHARMMff files \u00b6 Info This example can be found in the docs/examples/COVID-19_related_proteins/S1_RBD_with_antibody_6zlr directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr final GROMACS MD trajectory, fitted and with no pbc. A topology file top take into account that *.itp files belonging to the topology file should be also present in the folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 21 20 -ct com_traj.xtc -cp topol.top mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 21 20 -ct com_traj.xtc -cp topol.top where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Sample input file for PB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"SARS_CoV2_S1_Ab\", verbose=2, / &pb #radiopt=0 is recommended which means using radii from the prmtop file for both the PB calculation and for the NP calculation istrng=0.15, fillratio=4.0, radiopt=0, inp=1, / Remember radiopt = 0 is recommended which means using radii from the prmtop file See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 21 20 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. A topology file is also needed (mandatory) in this case to generate the topology files in amber format with all the terms for CHARMM force field. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"S1 RBD with antibody"},{"location":"examples/COVID-19_related_proteins/S1_RBD_with_antibody_6zlr/#sars-cov-2-receptor-binding-domain-rbdcr3022-antibody-complex-binding-free-energy-calculations-single-trajectory-method-with-charmmff-files","text":"Info This example can be found in the docs/examples/COVID-19_related_proteins/S1_RBD_with_antibody_6zlr directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"SARS-CoV-2 Receptor Binding Domain (RBD):CR3022 antibody complex binding free energy calculations (Single Trajectory method) with CHARMMff files"},{"location":"examples/COVID-19_related_proteins/S1_RBD_with_antibody_6zlr/#requirements","text":"In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr final GROMACS MD trajectory, fitted and with no pbc. A topology file top take into account that *.itp files belonging to the topology file should be also present in the folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/COVID-19_related_proteins/S1_RBD_with_antibody_6zlr/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 21 20 -ct com_traj.xtc -cp topol.top mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 21 20 -ct com_traj.xtc -cp topol.top where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Sample input file for PB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"SARS_CoV2_S1_Ab\", verbose=2, / &pb #radiopt=0 is recommended which means using radii from the prmtop file for both the PB calculation and for the NP calculation istrng=0.15, fillratio=4.0, radiopt=0, inp=1, / Remember radiopt = 0 is recommended which means using radii from the prmtop file See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/COVID-19_related_proteins/S1_RBD_with_antibody_6zlr/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 21 20 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. A topology file is also needed (mandatory) in this case to generate the topology files in amber format with all the terms for CHARMM force field. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Comp_receptor/","text":"Binding free energy calculations in multicomponent systems \u00b6 Info This example can be found in the docs/examples/Comp_receptor directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 Danger The ligand mol2 file must be the Antechamber output. In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. Ligand parameters file mol2 The Antechamber output mol2 file of ligand parametrization A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 33 14 -ct com_traj.xtc -lm ligand.mol2 mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 33 14 -ct com_traj.xtc -lm ligand.mol2 where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Although, we tried to use the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Complex_receptor\", verbose=2, forcefields=\"oldff/leaprc.ff99SBildn\",leaprc.gaff\" PBRadii=4, ions_parameters=1 / &gb igb=8, saltcon=0.150, intdiel=10 / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor (Protein+DNA+RNA+Ions) and ligand amber format topologies and trajectories will be obtained from that of the complex. Of note, a new variable \"forcefields\" has been added which eases the work with compound receptors with more than one type of molecule. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 33 14 ) are needed. A ligand .mol2 file is also needed for generating the ligand topology.The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 11 frames are going to be used when performing the the MM/PB(GB)SA calculation with the igb8 (GB-Neck2) model and a salt concentration = 0.15M. Of note, mbondi3 radii ( PBRadii=4 ) will be used as recommended for GB-Neck2 solvation model. Also, a high dielectric constant intdiel=10 will be used because of the high number of charged residues at the interface. In this case, Li/Merz ion parameters (12-6 normal usage set) for Mg ions were used. Check Amber manual for more info on ion parameters. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Multicomponent system"},{"location":"examples/Comp_receptor/#binding-free-energy-calculations-in-multicomponent-systems","text":"Info This example can be found in the docs/examples/Comp_receptor directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"Binding free energy calculations in multicomponent systems"},{"location":"examples/Comp_receptor/#requirements","text":"Danger The ligand mol2 file must be the Antechamber output. In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. Ligand parameters file mol2 The Antechamber output mol2 file of ligand parametrization A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/Comp_receptor/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 33 14 -ct com_traj.xtc -lm ligand.mol2 mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 33 14 -ct com_traj.xtc -lm ligand.mol2 where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Although, we tried to use the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Complex_receptor\", verbose=2, forcefields=\"oldff/leaprc.ff99SBildn\",leaprc.gaff\" PBRadii=4, ions_parameters=1 / &gb igb=8, saltcon=0.150, intdiel=10 / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/Comp_receptor/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor (Protein+DNA+RNA+Ions) and ligand amber format topologies and trajectories will be obtained from that of the complex. Of note, a new variable \"forcefields\" has been added which eases the work with compound receptors with more than one type of molecule. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 33 14 ) are needed. A ligand .mol2 file is also needed for generating the ligand topology.The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 11 frames are going to be used when performing the the MM/PB(GB)SA calculation with the igb8 (GB-Neck2) model and a salt concentration = 0.15M. Of note, mbondi3 radii ( PBRadii=4 ) will be used as recommended for GB-Neck2 solvation model. Also, a high dielectric constant intdiel=10 will be used because of the high number of charged residues at the interface. In this case, Li/Merz ion parameters (12-6 normal usage set) for Mg ions were used. Check Amber manual for more info on ion parameters. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Decomposition_analysis/","text":"Decomposition analysis \u00b6 Info This example can be found in the docs/examples/Decomposition_analysis directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 Danger The ligand mol2 file must be the Antechamber output. In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. Ligand parameters file mol2 The Antechamber output mol2 file of ligand parametrization A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional Remember When a topology file is defined, the ligand mol2 file is not needed. The ligand mol2 file only required when gmx_MMPBSA build the amber topology from a structure See a detailed list of all the flags in gmx_MMPBSA command line here That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t decomp gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -lm ligand.mol2 mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -lm ligand.mol2 where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 Sample input file for decomposition analysis This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Decomposition\", startframe=5, endframe=14, / &gb igb=5, saltcon=0.150, / #make sure to include at least one residue from both the receptor #and ligand in the print_res mask of the &decomp section. #http://archive.ambermd.org/201308/0075.html &decomp idecomp=2, dec_verbose=3, print_res=\"within 4\" #check _GMXMMPBSA_COM_FIXED.pdb file to select which residues are going to be printed in the output file #print_res=\"40,41,44,47,78,81,82,85,88,115,118,122,215,218,219,220,232,241\" / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 13 ) are needed. A ligand .mol2 file is also needed for generating the ligand topology. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the the MM/PB(GB)SA calculation with the igb5 (GB-OBC2) model and a salt concentration = 0.15M. Per-residue decomp with 1-4 EEL added to EEL and 1-4 VDW added to VDW potential terms ( idecomp=2 ) is going to be performed and residues within 4\u00c5 in both receptor and ligand will be printed in the output file. Please see print_res variable in &decomp namelist variables section Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information Alternatives for per-residue energy contribution visualization \u00b6 You can also use VMD and Chimera to view the modified pdb file with the per-residue energy contributions","title":"Decomposition analysis"},{"location":"examples/Decomposition_analysis/#decomposition-analysis","text":"Info This example can be found in the docs/examples/Decomposition_analysis directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"Decomposition analysis"},{"location":"examples/Decomposition_analysis/#requirements","text":"Danger The ligand mol2 file must be the Antechamber output. In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. Ligand parameters file mol2 The Antechamber output mol2 file of ligand parametrization A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional Remember When a topology file is defined, the ligand mol2 file is not needed. The ligand mol2 file only required when gmx_MMPBSA build the amber topology from a structure See a detailed list of all the flags in gmx_MMPBSA command line here That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t decomp gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -lm ligand.mol2 mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -lm ligand.mol2 where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 Sample input file for decomposition analysis This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Decomposition\", startframe=5, endframe=14, / &gb igb=5, saltcon=0.150, / #make sure to include at least one residue from both the receptor #and ligand in the print_res mask of the &decomp section. #http://archive.ambermd.org/201308/0075.html &decomp idecomp=2, dec_verbose=3, print_res=\"within 4\" #check _GMXMMPBSA_COM_FIXED.pdb file to select which residues are going to be printed in the output file #print_res=\"40,41,44,47,78,81,82,85,88,115,118,122,215,218,219,220,232,241\" / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Requirements"},{"location":"examples/Decomposition_analysis/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 13 ) are needed. A ligand .mol2 file is also needed for generating the ligand topology. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the the MM/PB(GB)SA calculation with the igb5 (GB-OBC2) model and a salt concentration = 0.15M. Per-residue decomp with 1-4 EEL added to EEL and 1-4 VDW added to VDW potential terms ( idecomp=2 ) is going to be performed and residues within 4\u00c5 in both receptor and ligand will be printed in the output file. Please see print_res variable in &decomp namelist variables section Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Decomposition_analysis/#alternatives-for-per-residue-energy-contribution-visualization","text":"You can also use VMD and Chimera to view the modified pdb file with the per-residue energy contributions","title":"Alternatives for per-residue energy contribution visualization"},{"location":"examples/Entropy_calculations/C2_Entropy/","text":"C2 Entropy calculations \u00b6 Info This example can be found in the docs/examples/Entropy_calculations/C2_Entropy directory in the repository folder Requirements \u00b6 Danger The ligand mol2 file must be the Antechamber output. In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx File containing the receptor and ligand in separated groups Receptor and ligand group integers Group numbers in the index files A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. Ligand parameters file mol2 The Antechamber output mol2 file of ligand parametrization A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional Remember When a topology file is defined, the ligand mol2 file is not needed. The ligand mol2 file only required when gmx_MMPBSA build the amber topology from a structure See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -lm ligand.mol2 mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -lm ligand.mol2 where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"C2_entropy\", startframe=5, endframe=21, verbose=2, c2_entropy=1, c2_segment=100, temperature=300, forcefields=\"oldff/leaprc.ff99SB,leaprc.gaff\" / &gb igb=5, saltcon=0.150, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 13 ) are needed. A ligand .mol2 file is also needed for generating the ligand topology. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the MM/PB(GB)SA calculation with the igb5 (GB-OBC2) model and a salt concentration = 0.15M. C2 Entropy will be calculated using all (100%) the frames ( c2_segment=100 ). Of note, C2 method tends to give unrealistically large entropies when the standard deviation of the interaction energy > ~ 3.6kcal/mol. Of note, two other methods ( QH and nmode ) can be used for estimating the entropic contribution, though they are way more expensive in computation as compared with C2 method. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"C2 Entropy calculations"},{"location":"examples/Entropy_calculations/C2_Entropy/#c2-entropy-calculations","text":"Info This example can be found in the docs/examples/Entropy_calculations/C2_Entropy directory in the repository folder","title":"C2 Entropy calculations"},{"location":"examples/Entropy_calculations/C2_Entropy/#requirements","text":"Danger The ligand mol2 file must be the Antechamber output. In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx File containing the receptor and ligand in separated groups Receptor and ligand group integers Group numbers in the index files A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. Ligand parameters file mol2 The Antechamber output mol2 file of ligand parametrization A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional Remember When a topology file is defined, the ligand mol2 file is not needed. The ligand mol2 file only required when gmx_MMPBSA build the amber topology from a structure See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/Entropy_calculations/C2_Entropy/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -lm ligand.mol2 mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -lm ligand.mol2 where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"C2_entropy\", startframe=5, endframe=21, verbose=2, c2_entropy=1, c2_segment=100, temperature=300, forcefields=\"oldff/leaprc.ff99SB,leaprc.gaff\" / &gb igb=5, saltcon=0.150, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/Entropy_calculations/C2_Entropy/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 13 ) are needed. A ligand .mol2 file is also needed for generating the ligand topology. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the MM/PB(GB)SA calculation with the igb5 (GB-OBC2) model and a salt concentration = 0.15M. C2 Entropy will be calculated using all (100%) the frames ( c2_segment=100 ). Of note, C2 method tends to give unrealistically large entropies when the standard deviation of the interaction energy > ~ 3.6kcal/mol. Of note, two other methods ( QH and nmode ) can be used for estimating the entropic contribution, though they are way more expensive in computation as compared with C2 method. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Entropy_calculations/Interaction_Entropy/","text":"Interaction Entropy calculations \u00b6 Info This example can be found in the docs/examples/Entropy_calculations/Interaction_Entropy directory in the repository folder Requirements \u00b6 In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t ie gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 Sample input file for entropy calculations (IE) This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"IE\", startframe=5, endframe=20, verbose=2, forcefields=\"oldff/leaprc.ff99SB\", #Interaction Entropy (IE)(https://pubs.acs.org/doi/abs/10.1021/jacs.6b02682) approximation interaction_entropy=1, ie_segment=25, temperature=298 / &gb igb=2, saltcon=0.150, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand (in this case, the ligand is also another protein) amber format topologies and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 19 20 ) are needed. The mmpbsa. in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the the MM/PB(GB)SA calculation with the igb2 (GB-OBC1) model and a salt concentration = 0.15M. Interaction Entropy (IE) will be calculated and the average for the last quartile ( entropy_seg=25 ) of the total number of frames will be reported. Of note, two other methods ( QH and nmode ) can be used for estimating the entropic contribution, though they are way more expensive in computation as compared with IE method. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Interaction Entropy"},{"location":"examples/Entropy_calculations/Interaction_Entropy/#interaction-entropy-calculations","text":"Info This example can be found in the docs/examples/Entropy_calculations/Interaction_Entropy directory in the repository folder","title":"Interaction Entropy calculations"},{"location":"examples/Entropy_calculations/Interaction_Entropy/#requirements","text":"In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/Entropy_calculations/Interaction_Entropy/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t ie gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 Sample input file for entropy calculations (IE) This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"IE\", startframe=5, endframe=20, verbose=2, forcefields=\"oldff/leaprc.ff99SB\", #Interaction Entropy (IE)(https://pubs.acs.org/doi/abs/10.1021/jacs.6b02682) approximation interaction_entropy=1, ie_segment=25, temperature=298 / &gb igb=2, saltcon=0.150, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/Entropy_calculations/Interaction_Entropy/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand (in this case, the ligand is also another protein) amber format topologies and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 19 20 ) are needed. The mmpbsa. in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the the MM/PB(GB)SA calculation with the igb2 (GB-OBC1) model and a salt concentration = 0.15M. Interaction Entropy (IE) will be calculated and the average for the last quartile ( entropy_seg=25 ) of the total number of frames will be reported. Of note, two other methods ( QH and nmode ) can be used for estimating the entropic contribution, though they are way more expensive in computation as compared with IE method. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Entropy_calculations/nmode/","text":"Normal Mode Entropy calculations \u00b6 Info This example can be found in the docs/examples/Entropy_calculations/nmode directory in the repository folder Requirements \u00b6 In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t nmode gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 Sample input file for entropy calculations (nmode) This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"NMode\", startframe=5, endframe=8, verbose=2, forcefields=\"oldff/leaprc.ff99SB\", / &gb igb=2, saltcon=0.150, / #note that nmode will use only a fraction of the no. of frames selected in #&general variable (21-5/1=16 in this case). This way, nmode will only #process 2 frames (15th and 16th frames) #note also that some parameters have been change to perform the calculation #faster (maxcyc=5, drms=100). The typical values for these parameters #are (maxcyc=50000, drms=0.001) &nmode nmstartframe=5, nmendframe=6, nminterval=1, maxcyc=5, drms=100, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples ## Considerations In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand (in this case, the ligand is also another protein) amber format topologies and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 19 20 ) are needed. The mmpbsa. in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the the MM/PB(GB)SA calculation with the igb2 (GB-OBC1) model and a salt concentration = 0.15M. nmode will be used for estimating the entropic contribution, though it's way more expensive in computation as compared with IE method. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"nmode Entropy"},{"location":"examples/Entropy_calculations/nmode/#normal-mode-entropy-calculations","text":"Info This example can be found in the docs/examples/Entropy_calculations/nmode directory in the repository folder","title":"Normal Mode Entropy calculations"},{"location":"examples/Entropy_calculations/nmode/#requirements","text":"In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/Entropy_calculations/nmode/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t nmode gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 Sample input file for entropy calculations (nmode) This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"NMode\", startframe=5, endframe=8, verbose=2, forcefields=\"oldff/leaprc.ff99SB\", / &gb igb=2, saltcon=0.150, / #note that nmode will use only a fraction of the no. of frames selected in #&general variable (21-5/1=16 in this case). This way, nmode will only #process 2 frames (15th and 16th frames) #note also that some parameters have been change to perform the calculation #faster (maxcyc=5, drms=100). The typical values for these parameters #are (maxcyc=50000, drms=0.001) &nmode nmstartframe=5, nmendframe=6, nminterval=1, maxcyc=5, drms=100, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples ## Considerations In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand (in this case, the ligand is also another protein) amber format topologies and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 19 20 ) are needed. The mmpbsa. in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the the MM/PB(GB)SA calculation with the igb2 (GB-OBC1) model and a salt concentration = 0.15M. nmode will be used for estimating the entropic contribution, though it's way more expensive in computation as compared with IE method. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Command-line"},{"location":"examples/Linear_PB_solver/","text":"Binding free energy calculation with linear PB (LPBE) \u00b6 Info This example can be found in the docs/examples/Linear_PB_solver directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 Danger The ligand mol2 file must be the Antechamber output. In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx File containing the receptor and ligand in separated groups Receptor and ligand group integers Group numbers in the index files A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. Ligand parameters file mol2 The Antechamber output mol2 file of ligand parametrization A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional Remember When a topology file is defined, the ligand mol2 file is not needed. The ligand mol2 file only required when gmx_MMPBSA build the amber topology from a structure See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -lm ligand.mol2 mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -lm ligand.mol2 where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 Sample input file for PB calculation #This input file is meant to show only that gmx_MMPBSA works. Although, we tried to use the input files as recommended in the #Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters #according to what is better for your system. &general sys_name=\"Linear_PB\", startframe=5, endframe=14, verbose=2, forcefields=\"oldff/leaprc.ff99SB,leaprc.gaff\" / &pb radiopt=0, istrng=0.150, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 13 ) are needed. A ligand .mol2 file is also needed for generating the ligand topology. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 10 frames are going to be used when performing the MM/PB(GB)SA calculation with the PB model (linear PB equation) and a salt concentration = 0.15M. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"BFE calculation with Linear PB"},{"location":"examples/Linear_PB_solver/#binding-free-energy-calculation-with-linear-pb-lpbe","text":"Info This example can be found in the docs/examples/Linear_PB_solver directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"Binding free energy calculation with linear PB (LPBE)"},{"location":"examples/Linear_PB_solver/#requirements","text":"Danger The ligand mol2 file must be the Antechamber output. In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx File containing the receptor and ligand in separated groups Receptor and ligand group integers Group numbers in the index files A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. Ligand parameters file mol2 The Antechamber output mol2 file of ligand parametrization A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional Remember When a topology file is defined, the ligand mol2 file is not needed. The ligand mol2 file only required when gmx_MMPBSA build the amber topology from a structure See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/Linear_PB_solver/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -lm ligand.mol2 mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -lm ligand.mol2 where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 Sample input file for PB calculation #This input file is meant to show only that gmx_MMPBSA works. Although, we tried to use the input files as recommended in the #Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters #according to what is better for your system. &general sys_name=\"Linear_PB\", startframe=5, endframe=14, verbose=2, forcefields=\"oldff/leaprc.ff99SB,leaprc.gaff\" / &pb radiopt=0, istrng=0.150, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/Linear_PB_solver/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 13 ) are needed. A ligand .mol2 file is also needed for generating the ligand topology. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 10 frames are going to be used when performing the MM/PB(GB)SA calculation with the PB model (linear PB equation) and a salt concentration = 0.15M. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Metalloprotein_peptide/","text":"Metalloprotein-peptide binding free energy calculations \u00b6 Info This example can be found in the docs/examples/Metalloprotein_peptide directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 In its simplest version, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t metalloprot_pep gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 20 21 -ct com_traj.pdb mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 20 21 -ct com_traj.pdb where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Metalloprotein-peptide\", startframe=1 endframe=4, verbose=2, ions_parameters=1, / &gb igb=2, saltcon=0.150, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand (in this case, the ligand is also another protein) amber format topologies and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 20 21 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 4 frames are going to be used when performing the the MM/PB(GB)SA calculation with the igb2 (GB-OBC1) model and a salt concentration = 0.15M. In this case, Li/Merz ion parameters (12-6 normal usage set) for Zn ions were used. Check Amber manual for more info on ion parameters. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Metalloprotein-peptide"},{"location":"examples/Metalloprotein_peptide/#metalloprotein-peptide-binding-free-energy-calculations","text":"Info This example can be found in the docs/examples/Metalloprotein_peptide directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"Metalloprotein-peptide binding free energy calculations"},{"location":"examples/Metalloprotein_peptide/#requirements","text":"In its simplest version, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/Metalloprotein_peptide/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t metalloprot_pep gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 20 21 -ct com_traj.pdb mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 20 21 -ct com_traj.pdb where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Metalloprotein-peptide\", startframe=1 endframe=4, verbose=2, ions_parameters=1, / &gb igb=2, saltcon=0.150, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/Metalloprotein_peptide/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand (in this case, the ligand is also another protein) amber format topologies and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 20 21 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 4 frames are going to be used when performing the the MM/PB(GB)SA calculation with the igb2 (GB-OBC1) model and a salt concentration = 0.15M. In this case, Li/Merz ion parameters (12-6 normal usage set) for Zn ions were used. Check Amber manual for more info on ion parameters. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/NonLinear_PB_solver/","text":"Binding free energy calculation with linear PB (NLPBE) \u00b6 Info This example can be found in the docs/examples/NonLinear_PB_solver directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 12 -ct com_traj.xtc mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 12 -ct com_traj.xtc where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 Sample input file for NLPB This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"NonLinear_PB\", startframe=5, endframe=10, verbose=2, forcefields=\"oldff/leaprc.ff99SB\", / &pb indi=10.0, istrng=0.15, radiopt=0, npbopt=1, eneopt=1, cutnb=8.0, / # check these threads # http://archive.ambermd.org/201203/0191.html # http://archive.ambermd.org/201610/0114.html # for more info on NLPB See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand (in this case, the ligand is DNA) amber format topologies and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 12 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 6 frames are going to be used when performing the the MM/PB(GB)SA calculation with the Non Linear PB solver ( npbopt=1 ). The dielectric constant ( indi ) is set = 10. Warning When running a NLPB solver, eneopt is set = 1. That way, the total electrostatic energy and forces will be computed with the particle-particle particle-mesh (P3M) procedure outlined in Lu and Luo. 8 In doing so, energy term EPB in the output file is set to zero, while EEL term includes both the reaction field energy (EPB) and the Coulombic energy (EEL). The van der Waals energy is computed along with the particle-particle portion of the Coulombic energy. This option requires a nonzero CUTNB (in this case, cutnb=8.0 ) and BCOPT = 5 (default option). It's noteworthy mentioning that DELTA G solv and DELTA G gas as reported are no longer properly decomposed. Since EPB and EEL are combined into the \"gas phase\" term, the gas and solvation terms can't be separated. Nevertheless, the total DELTA G should be perfectly fine, since everything is sum up together in the end. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"BFE calculation with NonLinear PB"},{"location":"examples/NonLinear_PB_solver/#binding-free-energy-calculation-with-linear-pb-nlpbe","text":"Info This example can be found in the docs/examples/NonLinear_PB_solver directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"Binding free energy calculation with linear PB (NLPBE)"},{"location":"examples/NonLinear_PB_solver/#requirements","text":"In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/NonLinear_PB_solver/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 12 -ct com_traj.xtc mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 12 -ct com_traj.xtc where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 Sample input file for NLPB This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"NonLinear_PB\", startframe=5, endframe=10, verbose=2, forcefields=\"oldff/leaprc.ff99SB\", / &pb indi=10.0, istrng=0.15, radiopt=0, npbopt=1, eneopt=1, cutnb=8.0, / # check these threads # http://archive.ambermd.org/201203/0191.html # http://archive.ambermd.org/201610/0114.html # for more info on NLPB See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/NonLinear_PB_solver/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand (in this case, the ligand is DNA) amber format topologies and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 12 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 6 frames are going to be used when performing the the MM/PB(GB)SA calculation with the Non Linear PB solver ( npbopt=1 ). The dielectric constant ( indi ) is set = 10. Warning When running a NLPB solver, eneopt is set = 1. That way, the total electrostatic energy and forces will be computed with the particle-particle particle-mesh (P3M) procedure outlined in Lu and Luo. 8 In doing so, energy term EPB in the output file is set to zero, while EEL term includes both the reaction field energy (EPB) and the Coulombic energy (EEL). The van der Waals energy is computed along with the particle-particle portion of the Coulombic energy. This option requires a nonzero CUTNB (in this case, cutnb=8.0 ) and BCOPT = 5 (default option). It's noteworthy mentioning that DELTA G solv and DELTA G gas as reported are no longer properly decomposed. Since EPB and EEL are combined into the \"gas phase\" term, the gas and solvation terms can't be separated. Nevertheless, the total DELTA G should be perfectly fine, since everything is sum up together in the end. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Protein_DNA/","text":"Protein-DNA binding free energy calculations \u00b6 Info This example can be found in the docs/examples/Protein_DNA directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t prot_dna gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 12 -ct com_traj.xtc mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 12 -ct com_traj.xtc where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Prot-DNA\" startframe=5 endframe=14 PBRadii=4 forcefields=\"oldff/leaprc.ff99SB\" verbose=2, / &gb igb=8, saltcon=0.150, intdiel=10 / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand (in this case, the ligand is DNA) amber format topologies and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 12 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the the MM/PB(GB)SA calculation with the igb8 (GB-Neck2) model and a salt concentration = 0.15M. Of note, mbondi3 radii ( PBRadii=4 ) will be used as recommended for GB-Neck2 solvation model. Also a high dielectric constant intdiel=10 will be used because of the high number of charged residues at the interface. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Protein-DNA"},{"location":"examples/Protein_DNA/#protein-dna-binding-free-energy-calculations","text":"Info This example can be found in the docs/examples/Protein_DNA directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"Protein-DNA binding free energy calculations"},{"location":"examples/Protein_DNA/#requirements","text":"In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/Protein_DNA/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t prot_dna gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 12 -ct com_traj.xtc mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 12 -ct com_traj.xtc where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Prot-DNA\" startframe=5 endframe=14 PBRadii=4 forcefields=\"oldff/leaprc.ff99SB\" verbose=2, / &gb igb=8, saltcon=0.150, intdiel=10 / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/Protein_DNA/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand (in this case, the ligand is DNA) amber format topologies and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 12 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the the MM/PB(GB)SA calculation with the igb8 (GB-Neck2) model and a salt concentration = 0.15M. Of note, mbondi3 radii ( PBRadii=4 ) will be used as recommended for GB-Neck2 solvation model. Also a high dielectric constant intdiel=10 will be used because of the high number of charged residues at the interface. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Protein_glycan/","text":"Protein-glycan binding free energy calculations \u00b6 Info This example can be found in the docs/examples/Protein_glycan directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t prot_glycan gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 26 -ct com_traj.xtc mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 26 -ct com_traj.xtc where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Protein-glycan\", startframe=5, endframe=14, verbose=2, forcefields=\"oldff/leaprc.ff99SB,gmxMMPBSA/leaprc.GLYCAM_06h-1\" / &gb igb=5, saltcon=0.150, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and glycan structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 26 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, there is no need to define a .mol2 for the glycan . 12 frames are going to be used when performing the the MM/PB(GB)SA calculation with the igb5 (GB-OBC2) model and a salt concentration = 0.15M. Of note, the recommended GLYCAM force fields are: * \"leaprc.GLYCAM_06j-1\" (Compatible with amber12SB and later), \"leaprc.GLYCAM_06EPb\" (Compatible with amber12SB and later), and \"leaprc.GLYCAM_06h-1\" (Compatible with amber99SB and earlier. It is included in gmx_MMPBSA package. If it is selected, it will be copied to $AMBERHOME/dat/x) Check Amber manual for more info on GLYCAM force fields. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Protein-glycan"},{"location":"examples/Protein_glycan/#protein-glycan-binding-free-energy-calculations","text":"Info This example can be found in the docs/examples/Protein_glycan directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"Protein-glycan binding free energy calculations"},{"location":"examples/Protein_glycan/#requirements","text":"In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/Protein_glycan/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t prot_glycan gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 26 -ct com_traj.xtc mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 26 -ct com_traj.xtc where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Protein-glycan\", startframe=5, endframe=14, verbose=2, forcefields=\"oldff/leaprc.ff99SB,gmxMMPBSA/leaprc.GLYCAM_06h-1\" / &gb igb=5, saltcon=0.150, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/Protein_glycan/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and glycan structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 26 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, there is no need to define a .mol2 for the glycan . 12 frames are going to be used when performing the the MM/PB(GB)SA calculation with the igb5 (GB-OBC2) model and a salt concentration = 0.15M. Of note, the recommended GLYCAM force fields are: * \"leaprc.GLYCAM_06j-1\" (Compatible with amber12SB and later), \"leaprc.GLYCAM_06EPb\" (Compatible with amber12SB and later), and \"leaprc.GLYCAM_06h-1\" (Compatible with amber99SB and earlier. It is included in gmx_MMPBSA package. If it is selected, it will be copied to $AMBERHOME/dat/x) Check Amber manual for more info on GLYCAM force fields. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Protein_ligand/MT/","text":"Protein-ligand binding free energy calculations (Multiple Trajectory method) \u00b6 Info This example can be found in the docs/examples/Protein_ligand/MT directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 Danger The ligand mol2 file must be the Antechamber output. In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro ( Complex, Receptor and Ligand ) Structure file containing the system coordinates An index file ndx ( Complex, Receptor and Ligand ) file containing the receptor and ligand in separated groups Receptor and ligand group integers ( Complex, Receptor and Ligand ) Group numbers in the index files A trajectory file xtc pdb gro trr ( Complex, Receptor and Ligand ) Final GROMACS MD trajectory, fitted and with no pbc. Ligand parameters file mol2 The Antechamber output mol2 file of ligand parametrization A topology file (not included) top ( Complex, Receptor and Ligand ) GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional Remember When a topology file is defined, the ligand mol2 file is not needed. The ligand mol2 file only required when gmx_MMPBSA build the amber topology from a structure See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t prot_lig_mt gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -rs rec.pdb -ri rec_index.ndx -rg 1 -rt rec_traj.pdb -lm ligand.mol2 -ls lig.pdb -li lig_index.ndx -lg 2 -lt lig_traj.pdb mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13\\ -ct com_traj.xtc -rs rec.pdb -ri rec_index.ndx -rg 1 -rt rec_traj.pdb \\ -lm ligand.mol2 -ls lig.pdb -li lig_index.ndx -lg 2 -lt lig_traj.pdb where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Prot-Lig-MT\", startframe=5, endframe=14, verbose=2, forcefields=\"oldff/leaprc.ff99SB\",leaprc.gaff\" / &gb igb=5, saltcon=0.150, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a multiple trajectory (MT) approximation is followed, which means the receptor and ligand structures and trajectories are needed. For the complex, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 13 ) are needed. For the receptor, a MD Structure+mass(db) file ( rec.pdb ), an index file ( rec_index.ndx ), a trajectory file ( rec_traj.pdb ), and the receptor group number in the rec_index file ( 1 ) are needed. For the ligand, a ligand .mol2 file is needed for generating the ligand topology. Besides, a MD Structure+mass(db) file ( lig.pdb ), an index file ( lig_index.ndx ), a trajectory file ( lig_traj.pdb ), and ligand group number in the lig_index file ( 2 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the the MM/PB(GB)SA calculation with the igb5 (GB-OBC2) model and a salt concentration = 0.15M. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Multiple Trajectory Protocol"},{"location":"examples/Protein_ligand/MT/#protein-ligand-binding-free-energy-calculations-multiple-trajectory-method","text":"Info This example can be found in the docs/examples/Protein_ligand/MT directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"Protein-ligand binding free energy calculations (Multiple Trajectory method)"},{"location":"examples/Protein_ligand/MT/#requirements","text":"Danger The ligand mol2 file must be the Antechamber output. In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro ( Complex, Receptor and Ligand ) Structure file containing the system coordinates An index file ndx ( Complex, Receptor and Ligand ) file containing the receptor and ligand in separated groups Receptor and ligand group integers ( Complex, Receptor and Ligand ) Group numbers in the index files A trajectory file xtc pdb gro trr ( Complex, Receptor and Ligand ) Final GROMACS MD trajectory, fitted and with no pbc. Ligand parameters file mol2 The Antechamber output mol2 file of ligand parametrization A topology file (not included) top ( Complex, Receptor and Ligand ) GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional Remember When a topology file is defined, the ligand mol2 file is not needed. The ligand mol2 file only required when gmx_MMPBSA build the amber topology from a structure See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/Protein_ligand/MT/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t prot_lig_mt gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -rs rec.pdb -ri rec_index.ndx -rg 1 -rt rec_traj.pdb -lm ligand.mol2 -ls lig.pdb -li lig_index.ndx -lg 2 -lt lig_traj.pdb mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13\\ -ct com_traj.xtc -rs rec.pdb -ri rec_index.ndx -rg 1 -rt rec_traj.pdb \\ -lm ligand.mol2 -ls lig.pdb -li lig_index.ndx -lg 2 -lt lig_traj.pdb where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Prot-Lig-MT\", startframe=5, endframe=14, verbose=2, forcefields=\"oldff/leaprc.ff99SB\",leaprc.gaff\" / &gb igb=5, saltcon=0.150, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/Protein_ligand/MT/#considerations","text":"In this case, a multiple trajectory (MT) approximation is followed, which means the receptor and ligand structures and trajectories are needed. For the complex, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 13 ) are needed. For the receptor, a MD Structure+mass(db) file ( rec.pdb ), an index file ( rec_index.ndx ), a trajectory file ( rec_traj.pdb ), and the receptor group number in the rec_index file ( 1 ) are needed. For the ligand, a ligand .mol2 file is needed for generating the ligand topology. Besides, a MD Structure+mass(db) file ( lig.pdb ), an index file ( lig_index.ndx ), a trajectory file ( lig_traj.pdb ), and ligand group number in the lig_index file ( 2 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the the MM/PB(GB)SA calculation with the igb5 (GB-OBC2) model and a salt concentration = 0.15M. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Protein_ligand/ST/","text":"Protein-ligand binding free energy calculations (Single Trajectory method) \u00b6 Info This example can be found in the docs/examples/Protein_ligand/ST directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 Danger The ligand mol2 file must be the Antechamber output. In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx File containing the receptor and ligand in separated groups Receptor and ligand group integers Group numbers in the index files A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. Ligand parameters file mol2 The Antechamber output mol2 file of ligand parametrization A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional Remember When a topology file is defined, the ligand mol2 file is not needed. The ligand mol2 file only required when gmx_MMPBSA build the amber topology from a structure See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t prot_lig_st gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -lm ligand.mol2 mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -lm ligand.mol2 where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Prot-Lig-ST\", startframe=5, endframe=14, verbose=2, forcefields=\"oldff/leaprc.ff99SB,leaprc.gaff\" / &gb igb=5, saltcon=0.150, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 13 ) are needed. A ligand .mol2 file is also needed for generating the ligand topology. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the MM/PB(GB)SA calculation with the igb5 (GB-OBC2) model and a salt concentration = 0.15M. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"BFE calculation with GB"},{"location":"examples/Protein_ligand/ST/#protein-ligand-binding-free-energy-calculations-single-trajectory-method","text":"Info This example can be found in the docs/examples/Protein_ligand/ST directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"Protein-ligand binding free energy calculations (Single Trajectory method)"},{"location":"examples/Protein_ligand/ST/#requirements","text":"Danger The ligand mol2 file must be the Antechamber output. In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx File containing the receptor and ligand in separated groups Receptor and ligand group integers Group numbers in the index files A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. Ligand parameters file mol2 The Antechamber output mol2 file of ligand parametrization A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional Remember When a topology file is defined, the ligand mol2 file is not needed. The ligand mol2 file only required when gmx_MMPBSA build the amber topology from a structure See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/Protein_ligand/ST/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t prot_lig_st gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -lm ligand.mol2 mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -lm ligand.mol2 where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Prot-Lig-ST\", startframe=5, endframe=14, verbose=2, forcefields=\"oldff/leaprc.ff99SB,leaprc.gaff\" / &gb igb=5, saltcon=0.150, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/Protein_ligand/ST/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 13 ) are needed. A ligand .mol2 file is also needed for generating the ligand topology. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the MM/PB(GB)SA calculation with the igb5 (GB-OBC2) model and a salt concentration = 0.15M. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Protein_ligand_CHARMMff/","text":"CHARMM and MM(PB/GB)SA PB model is recommended when working with CHARMMff files. Nevertheless, the combination of PB/GB models and CHARMM force field hasn't been tested extensively. Please, check this thread for more information and proceed with caution. Protein-ligand binding free energy calculations (Single Trajectory method) with CHARMMff files \u00b6 Info This example can be found in the docs/examples/Protein_ligand_CHARMMff directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr final GROMACS MD trajectory, fitted and with no pbc. A topology file top take into account that *.itp files belonging to the topology file should be also present in the folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t prot_lig_charmm gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -cp topol.top mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -cp topol.top where the mmpbsa.in input file, is a text file containing the following lines: Sample input file for PB calculation 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 Sample input file for PB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Prot-Lig-CHARMM\", startframe=1, endframe=4, verbose=2, / &pb # radiopt=0 is recommended which means using radii from the prmtop file for both the PB calculation and for the NP # calculation istrng=0.15, fillratio=4.0, radiopt=0 / Remember radiopt = 0 is recommended which means using radii from the prmtop file See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 13 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. A topology file is also needed (mandatory) in this case to generate the topology files in amber format with all the terms for CHARMM force field. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Protein-Ligand"},{"location":"examples/Protein_ligand_CHARMMff/#protein-ligand-binding-free-energy-calculations-single-trajectory-method-with-charmmff-files","text":"Info This example can be found in the docs/examples/Protein_ligand_CHARMMff directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"Protein-ligand binding free energy calculations (Single Trajectory method) with CHARMMff files"},{"location":"examples/Protein_ligand_CHARMMff/#requirements","text":"In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr final GROMACS MD trajectory, fitted and with no pbc. A topology file top take into account that *.itp files belonging to the topology file should be also present in the folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/Protein_ligand_CHARMMff/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t prot_lig_charmm gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -cp topol.top mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.xtc -cp topol.top where the mmpbsa.in input file, is a text file containing the following lines: Sample input file for PB calculation 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 Sample input file for PB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Prot-Lig-CHARMM\", startframe=1, endframe=4, verbose=2, / &pb # radiopt=0 is recommended which means using radii from the prmtop file for both the PB calculation and for the NP # calculation istrng=0.15, fillratio=4.0, radiopt=0 / Remember radiopt = 0 is recommended which means using radii from the prmtop file See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/Protein_ligand_CHARMMff/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 13 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. A topology file is also needed (mandatory) in this case to generate the topology files in amber format with all the terms for CHARMM force field. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Protein_ligand_LPH_atoms_CHARMMff/","text":"CHARMM and MM(PB/GB)SA PB model is recommended when working with CHARMMff files. Nevertheless, the combination of PB/GB models and CHARMM force field hasn't been tested extensively. Please, check this thread for more information and proceed with caution. Protein-ligand with LPH atoms BFE calculations (Single Trajectory method) -- CHARMMff files \u00b6 Info This example can be found in the docs/examples/Protein_ligand_LPH_atoms_CHARMMff directory in the repository folder LPH is a positively charged virtual particle attached to halogen atoms. This strategy aims to get a better representation of the halogen bond which is a highly directional, non-covalent interaction between a halogen atom and another electronegative atom (See here for more info). Unfortunately, including these particles in the topology will cause gmx_MMPBSA to end in an error. However, there is a way to generate the files without these particles and get gmx_MMPBSA up and running. Keep in mind As the LPH particle is not considered during the calculations in gmx_MMPBSA, take the results with a grain of salt, especially when working with systems where the halogen bond is determinant for the binding. Requirements \u00b6 In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr final GROMACS MD trajectory, fitted and with no pbc. A topology file top take into account that *.itp files belonging to the topology file should be also present in the folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here In order to generate the corresponding files (The MD Structure+mass(db), index, trajectory and the topology files) without the LPH particles, it's necessary to run a few commands. Bear with me! Let's generate the index file first: Important The main idea here is to generate a receptor group, a ligand group without the LPH particles and a complex group containing both the receptor and the ligand without the LPH particles. In general, index files generated with GROMACS directly will contain more detailed information ( i.e. , receptor and ligand separated) gmx make_ndx -f com.tpr -o index_mod_gromacs.ndx 0 System : 70483 atoms 1 Protein : 5580 atoms 2 Protein-H : 2817 atoms 3 C-alpha : 334 atoms 4 Backbone : 1002 atoms 5 MainChain : 1335 atoms 6 MainChain+Cb : 1654 atoms 7 MainChain+H : 1654 atoms 8 SideChain : 3926 atoms 9 SideChain-H : 1482 atoms 10 Prot-Masses : 5580 atoms 11 non-Protein : 64903 atoms 12 Other : 64903 atoms 13 3G5 : 32 atoms 14 CLA : 62 atoms 15 SOD : 63 atoms 16 TIP3 : 64746 atoms Splitting the ligand (group 13) by atoms >splitat 13 Grouping both LPH particles >47|48 Excluding both LPH particles from the ligand >13&!49 Naming ligand as lig >name 50 lig Grouping rec and lig >1|50 Cleaning >del 17-49 save and quit >q This is how it should look like at the end 0 System : 70483 atoms 1 Protein : 5580 atoms 2 Protein-H : 2817 atoms 3 C-alpha : 334 atoms 4 Backbone : 1002 atoms 5 MainChain : 1335 atoms 6 MainChain+Cb : 1654 atoms 7 MainChain+H : 1654 atoms 8 SideChain : 3926 atoms 9 SideChain-H : 1482 atoms 10 Prot-Masses : 5580 atoms 11 non-Protein : 64903 atoms 12 Other : 64903 atoms 13 3G5 : 32 atoms 14 CLA : 62 atoms 15 SOD : 63 atoms 16 TIP3 : 64746 atoms 17 lig : 30 atoms 18 Protein_lig : 5610 atoms Note Note that the number of atoms in the generated complex is 5610 because it doesn't include the LPH particles. Let's generate the MD Structure+mass(db) file: echo 18 | gmx trjconv -s com.tpr -f traj_fit.xtc -dump 0 -o str_noLP.pdb -n index_mod_gromacs.ndx Open str_noLP.pdb in your favorite visualizer and see it doesn't contain the LPH particles. Now, let's generate the trajectory with no LPH particles: echo 18 | gmx trjconv -s com.tpr -f traj_fit.xtc -o com_traj.xtc -n index_mod_gromacs.ndx Finally, let's edit the topology file. Go inside the toppar folder and open the HETA.itp file. As you will see, we deleted all the information related with LPH particles (atom numbers 31, and 32 respectively). In this case, we deleted the information for LPH particles in atoms (lines 47, 48) and pairs (lines 124, 132, 150, 153, 154, 157, 158, 159). Besides, delete the whole [ virtual_sites3 ] (lines 296-299) and [ exclusions ] (lines 301-318) fields. The original .itp ( HETA_original_with_LPH_info.itp ) is included for comparison purposes. Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs str_noLP.pdb -ci index_mod_gromacs.ndx -cg 1 17 -ct com_traj.xtc -cp topol.top mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs str_noLP.pdb -ci index_mod_gromacs.ndx -cg 1 17 -ct com_traj.xtc -cp topol.top where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 Sample input file for PB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Prot-Lig-ST\", startframe=5, endframe=9, verbose=2, solvated_trajectory=0, / &pb # radiopt=0 is recommended which means using radii from the prmtop file # for both the PB calculation and for the NP calculation istrng=0.15, fillratio=1.250, radiopt=0, inp=1, / Remember radiopt = 0 is recommended which means using radii from the prmtop file See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( str_noLP.pdb ), an index file ( index_mod_gromacs.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 17 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. A topology file is also needed (mandatory) in this case to generate the topology files in amber format with all the terms for CHARMM force field. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Protein-Ligand with LPH particles (ST)"},{"location":"examples/Protein_ligand_LPH_atoms_CHARMMff/#protein-ligand-with-lph-atoms-bfe-calculations-single-trajectory-method-charmmff-files","text":"Info This example can be found in the docs/examples/Protein_ligand_LPH_atoms_CHARMMff directory in the repository folder LPH is a positively charged virtual particle attached to halogen atoms. This strategy aims to get a better representation of the halogen bond which is a highly directional, non-covalent interaction between a halogen atom and another electronegative atom (See here for more info). Unfortunately, including these particles in the topology will cause gmx_MMPBSA to end in an error. However, there is a way to generate the files without these particles and get gmx_MMPBSA up and running. Keep in mind As the LPH particle is not considered during the calculations in gmx_MMPBSA, take the results with a grain of salt, especially when working with systems where the halogen bond is determinant for the binding.","title":"Protein-ligand with LPH atoms BFE calculations (Single Trajectory method) -- CHARMMff files"},{"location":"examples/Protein_ligand_LPH_atoms_CHARMMff/#requirements","text":"In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr final GROMACS MD trajectory, fitted and with no pbc. A topology file top take into account that *.itp files belonging to the topology file should be also present in the folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here In order to generate the corresponding files (The MD Structure+mass(db), index, trajectory and the topology files) without the LPH particles, it's necessary to run a few commands. Bear with me! Let's generate the index file first: Important The main idea here is to generate a receptor group, a ligand group without the LPH particles and a complex group containing both the receptor and the ligand without the LPH particles. In general, index files generated with GROMACS directly will contain more detailed information ( i.e. , receptor and ligand separated) gmx make_ndx -f com.tpr -o index_mod_gromacs.ndx 0 System : 70483 atoms 1 Protein : 5580 atoms 2 Protein-H : 2817 atoms 3 C-alpha : 334 atoms 4 Backbone : 1002 atoms 5 MainChain : 1335 atoms 6 MainChain+Cb : 1654 atoms 7 MainChain+H : 1654 atoms 8 SideChain : 3926 atoms 9 SideChain-H : 1482 atoms 10 Prot-Masses : 5580 atoms 11 non-Protein : 64903 atoms 12 Other : 64903 atoms 13 3G5 : 32 atoms 14 CLA : 62 atoms 15 SOD : 63 atoms 16 TIP3 : 64746 atoms Splitting the ligand (group 13) by atoms >splitat 13 Grouping both LPH particles >47|48 Excluding both LPH particles from the ligand >13&!49 Naming ligand as lig >name 50 lig Grouping rec and lig >1|50 Cleaning >del 17-49 save and quit >q This is how it should look like at the end 0 System : 70483 atoms 1 Protein : 5580 atoms 2 Protein-H : 2817 atoms 3 C-alpha : 334 atoms 4 Backbone : 1002 atoms 5 MainChain : 1335 atoms 6 MainChain+Cb : 1654 atoms 7 MainChain+H : 1654 atoms 8 SideChain : 3926 atoms 9 SideChain-H : 1482 atoms 10 Prot-Masses : 5580 atoms 11 non-Protein : 64903 atoms 12 Other : 64903 atoms 13 3G5 : 32 atoms 14 CLA : 62 atoms 15 SOD : 63 atoms 16 TIP3 : 64746 atoms 17 lig : 30 atoms 18 Protein_lig : 5610 atoms Note Note that the number of atoms in the generated complex is 5610 because it doesn't include the LPH particles. Let's generate the MD Structure+mass(db) file: echo 18 | gmx trjconv -s com.tpr -f traj_fit.xtc -dump 0 -o str_noLP.pdb -n index_mod_gromacs.ndx Open str_noLP.pdb in your favorite visualizer and see it doesn't contain the LPH particles. Now, let's generate the trajectory with no LPH particles: echo 18 | gmx trjconv -s com.tpr -f traj_fit.xtc -o com_traj.xtc -n index_mod_gromacs.ndx Finally, let's edit the topology file. Go inside the toppar folder and open the HETA.itp file. As you will see, we deleted all the information related with LPH particles (atom numbers 31, and 32 respectively). In this case, we deleted the information for LPH particles in atoms (lines 47, 48) and pairs (lines 124, 132, 150, 153, 154, 157, 158, 159). Besides, delete the whole [ virtual_sites3 ] (lines 296-299) and [ exclusions ] (lines 301-318) fields. The original .itp ( HETA_original_with_LPH_info.itp ) is included for comparison purposes.","title":"Requirements"},{"location":"examples/Protein_ligand_LPH_atoms_CHARMMff/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs str_noLP.pdb -ci index_mod_gromacs.ndx -cg 1 17 -ct com_traj.xtc -cp topol.top mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs str_noLP.pdb -ci index_mod_gromacs.ndx -cg 1 17 -ct com_traj.xtc -cp topol.top where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 Sample input file for PB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Prot-Lig-ST\", startframe=5, endframe=9, verbose=2, solvated_trajectory=0, / &pb # radiopt=0 is recommended which means using radii from the prmtop file # for both the PB calculation and for the NP calculation istrng=0.15, fillratio=1.250, radiopt=0, inp=1, / Remember radiopt = 0 is recommended which means using radii from the prmtop file See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/Protein_ligand_LPH_atoms_CHARMMff/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( str_noLP.pdb ), an index file ( index_mod_gromacs.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 17 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. A topology file is also needed (mandatory) in this case to generate the topology files in amber format with all the terms for CHARMM force field. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Protein_membrane/","text":"MMPBSA with membrane proteins \u00b6 Info This example can be found in the docs/examples/Protein_membrane directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 Danger The ligand mol2 file must be the Antechamber output. In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. Ligand parameters file mol2 The Antechamber output mol2 file of ligand parametrization A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional Remember When a topology file is defined, the ligand mol2 file is not needed. The ligand mol2 file only required when gmx_MMPBSA build the amber topology from a structure See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t memb_prot gmx_MMPBSA -O -i mmpbsa.in -cs com.pdb -ci index.ndx -cg 1 13 -ct com_traj.pdb -lm ligand.mol2 mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.pdb -lm ligand.mol2 where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 Sample input file for MMPBSA with membrane proteins This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Prot-Memb\", startframe=1, endframe=4, debug_printlevel=2, / &pb radiopt=0, indi=20.0, istrng=0.150, fillratio=1.25, ipb=1, nfocus=1, bcopt=10, eneopt=1, cutfd=7.0, cutnb=99.0, npbverb=1, solvopt=2, inp=2, memopt=1, emem=7.0, mctrdz=-10.383, mthick=36.086, poretype=1, maxarcdot=15000 / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.pdb ), an index file ( index.ndx ), a trajectory file ( com_traj.pdb ), and both the receptor and ligand group numbers in the index file ( 1 13 ) are needed. A ligand .mol2 file is also needed for generating the ligand topology. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. Of note, special parameters for MMPBSA with membrane proteins have been included. See more here . Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Membrane proteins"},{"location":"examples/Protein_membrane/#mmpbsa-with-membrane-proteins","text":"Info This example can be found in the docs/examples/Protein_membrane directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"MMPBSA with membrane proteins"},{"location":"examples/Protein_membrane/#requirements","text":"Danger The ligand mol2 file must be the Antechamber output. In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. Ligand parameters file mol2 The Antechamber output mol2 file of ligand parametrization A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional Remember When a topology file is defined, the ligand mol2 file is not needed. The ligand mol2 file only required when gmx_MMPBSA build the amber topology from a structure See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/Protein_membrane/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t memb_prot gmx_MMPBSA -O -i mmpbsa.in -cs com.pdb -ci index.ndx -cg 1 13 -ct com_traj.pdb -lm ligand.mol2 mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 13 -ct com_traj.pdb -lm ligand.mol2 where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 Sample input file for MMPBSA with membrane proteins This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Prot-Memb\", startframe=1, endframe=4, debug_printlevel=2, / &pb radiopt=0, indi=20.0, istrng=0.150, fillratio=1.25, ipb=1, nfocus=1, bcopt=10, eneopt=1, cutfd=7.0, cutnb=99.0, npbverb=1, solvopt=2, inp=2, memopt=1, emem=7.0, mctrdz=-10.383, mthick=36.086, poretype=1, maxarcdot=15000 / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/Protein_membrane/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.pdb ), an index file ( index.ndx ), a trajectory file ( com_traj.pdb ), and both the receptor and ligand group numbers in the index file ( 1 13 ) are needed. A ligand .mol2 file is also needed for generating the ligand topology. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. Of note, special parameters for MMPBSA with membrane proteins have been included. See more here . Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Protein_membrane_CHARMMff/","text":"CHARMM and MM(PB/GB)SA PB model is recommended when working with CHARMMff files. Nevertheless, the combination of PB/GB models and CHARMM force field hasn't been tested extensively. Please, check this thread for more information and proceed with caution. Protein-ligand embedded in membrane binding free energy calculations (Single Trajectory method) with CHARMMff files \u00b6 Info This example can be found in the docs/examples/Protein_membrane_CHARMMff directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr final GROMACS MD trajectory, fitted and with no pbc. A topology file top take into account that *.itp files belonging to the topology file should be also present in the folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t memb_charmm gmx_MMPBSA -O -i mmpbsa.in -cs com.pdb -ci index.ndx -cg 6 5 -ct md.xtc -cp topol.top mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.pdb -ci index.ndx -cg 6 5 -ct md.xtc -cp topol.top where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 Sample input file for MMPBSA with membrane proteins This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Prot-Memb-CHARMM\", startframe=1, endframe=4, debug_printlevel=2, / &pb radiopt=0, indi=20.0, istrng=0.150, fillratio=1.25, ipb=1, nfocus=1, bcopt=10, eneopt=1, cutfd=7.0, cutnb=99.0, npbverb=1, solvopt=2, inp=2, memopt=1, emem=7.0, mctrdz=31, mthick=31, poretype=1, maxarcdot=15000 / Remember radiopt = 0 is recommended which means using radii from the prmtop file See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 This is a protein-protein complex system that contains several glycosilation sites and ligands bound. All of that, is embedded in POPC:CHOL a (4:1) membrane. As you will see, gmx_MMPBSA is able to handle successfully such a complex system. Of note, just a relevant part of the entire system has been considered for binding free calculations, since the inclusion of the rest will increase the computation time without improving the results. You can check the file _GMXMMPBSA_COM_FIXED.pdb during the calculation to see how the complex looks like. In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.pdb ), an index file ( index.ndx ), a trajectory file ( md.xtc ), and both the receptor and ligand group numbers in the index file ( 6 5 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. A topology file is also needed (mandatory) in this case to generate the topology files in amber format with all the terms for CHARMM force field. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Protein-ligand complex embedded in membrane"},{"location":"examples/Protein_membrane_CHARMMff/#protein-ligand-embedded-in-membrane-binding-free-energy-calculations-single-trajectory-method-with-charmmff-files","text":"Info This example can be found in the docs/examples/Protein_membrane_CHARMMff directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"Protein-ligand embedded in membrane binding free energy calculations (Single Trajectory method) with CHARMMff files"},{"location":"examples/Protein_membrane_CHARMMff/#requirements","text":"In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr final GROMACS MD trajectory, fitted and with no pbc. A topology file top take into account that *.itp files belonging to the topology file should be also present in the folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/Protein_membrane_CHARMMff/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t memb_charmm gmx_MMPBSA -O -i mmpbsa.in -cs com.pdb -ci index.ndx -cg 6 5 -ct md.xtc -cp topol.top mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.pdb -ci index.ndx -cg 6 5 -ct md.xtc -cp topol.top where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 Sample input file for MMPBSA with membrane proteins This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Prot-Memb-CHARMM\", startframe=1, endframe=4, debug_printlevel=2, / &pb radiopt=0, indi=20.0, istrng=0.150, fillratio=1.25, ipb=1, nfocus=1, bcopt=10, eneopt=1, cutfd=7.0, cutnb=99.0, npbverb=1, solvopt=2, inp=2, memopt=1, emem=7.0, mctrdz=31, mthick=31, poretype=1, maxarcdot=15000 / Remember radiopt = 0 is recommended which means using radii from the prmtop file See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/Protein_membrane_CHARMMff/#considerations","text":"This is a protein-protein complex system that contains several glycosilation sites and ligands bound. All of that, is embedded in POPC:CHOL a (4:1) membrane. As you will see, gmx_MMPBSA is able to handle successfully such a complex system. Of note, just a relevant part of the entire system has been considered for binding free calculations, since the inclusion of the rest will increase the computation time without improving the results. You can check the file _GMXMMPBSA_COM_FIXED.pdb during the calculation to see how the complex looks like. In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.pdb ), an index file ( index.ndx ), a trajectory file ( md.xtc ), and both the receptor and ligand group numbers in the index file ( 6 5 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. A topology file is also needed (mandatory) in this case to generate the topology files in amber format with all the terms for CHARMM force field. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Protein_protein/","text":"Protein-protein binding free energy calculations \u00b6 Info This example can be found in the docs/examples/Protein_protein directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx File containing the receptor and ligand in separated groups Receptor and ligand group integers Group numbers in the index files A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here An input parameters file (*.in) -- input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file (*.tpr, *.pdb, *.gro) An index file (*.ndx) -- *.ndx file containing the receptor and ligand in separated groups Receptor and ligand group numbers in the index file A trajectory file (*.xtc, *.pdb, *.gro, *.trr) -- final GROMACS MD trajectory, fitted and with no pbc. See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t prot_prot gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Prot-Prot\", startframe=5, endframe=14, verbose=2, forcefields=\"oldff/leaprc.ff99SB\", / &gb igb=2, saltcon=0.150, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand (in this case, the ligand is also another protein) amber format topologies and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 19 20 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the the MM/PB(GB)SA calculation with the igb2 (GB-OBC1) model and a salt concentration = 0.15M. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Protein-protein"},{"location":"examples/Protein_protein/#protein-protein-binding-free-energy-calculations","text":"Info This example can be found in the docs/examples/Protein_protein directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"Protein-protein binding free energy calculations"},{"location":"examples/Protein_protein/#requirements","text":"In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx File containing the receptor and ligand in separated groups Receptor and ligand group integers Group numbers in the index files A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here An input parameters file (*.in) -- input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file (*.tpr, *.pdb, *.gro) An index file (*.ndx) -- *.ndx file containing the receptor and ligand in separated groups Receptor and ligand group numbers in the index file A trajectory file (*.xtc, *.pdb, *.gro, *.trr) -- final GROMACS MD trajectory, fitted and with no pbc. See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/Protein_protein/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t prot_prot gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Prot-Prot\", startframe=5, endframe=14, verbose=2, forcefields=\"oldff/leaprc.ff99SB\", / &gb igb=2, saltcon=0.150, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/Protein_protein/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand (in this case, the ligand is also another protein) amber format topologies and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 19 20 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the the MM/PB(GB)SA calculation with the igb2 (GB-OBC1) model and a salt concentration = 0.15M. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/QM_MMGBSA/","text":"QM/MMGBSA binding free energy calculations \u00b6 Info This example can be found in the docs/examples/QM_MMGBSA directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 20 -ct com_traj.xtc -cp complex.top -cr ref.pdb mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 20 -ct com_traj.xtc -cp complex.top -cr ref.pdb where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"QM/MMGBSA\", startframe=1, endframe=10, verbose=2, PBRadii=2, / &gb igb=1, saltcon=0.150, ifqnt=1, qm_theory=PM3, qm_residues=\"A/31,36 C/62,73,75,85 D/91\" / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and glycan structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 20 ) are needed. In this case we used the GROMACS topology file ( complex.top ) to generate Amber's one. We also used a reference structure of the complex ( ref.pdb ) with the correct chain IDs and residue numbers. Extremely attention should be paid to those residues selected in the QM region. In this case we selected the ligand and 6 residues that make direct contact with the ligand. The mmpbsa.in input file will contain all the parameters needed for the QM/MMGBSA calculation. In this case, there is no need to define a .mol2 for the glycan . 11 frames are going to be used when performing QM/MMGBSA calculation with the igb1 (GB-HCT) model (note that mbondi raddi set PBRadii=2 is used), PM3 method and a salt concentration = 0.15M. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"QM/MMGBSA"},{"location":"examples/QM_MMGBSA/#qmmmgbsa-binding-free-energy-calculations","text":"Info This example can be found in the docs/examples/QM_MMGBSA directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"QM/MMGBSA binding free energy calculations"},{"location":"examples/QM_MMGBSA/#requirements","text":"In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx file containing the receptor and ligand in separated groups Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/QM_MMGBSA/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 20 -ct com_traj.xtc -cp complex.top -cr ref.pdb mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 1 20 -ct com_traj.xtc -cp complex.top -cr ref.pdb where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"QM/MMGBSA\", startframe=1, endframe=10, verbose=2, PBRadii=2, / &gb igb=1, saltcon=0.150, ifqnt=1, qm_theory=PM3, qm_residues=\"A/31,36 C/62,73,75,85 D/91\" / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/QM_MMGBSA/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and glycan structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 1 20 ) are needed. In this case we used the GROMACS topology file ( complex.top ) to generate Amber's one. We also used a reference structure of the complex ( ref.pdb ) with the correct chain IDs and residue numbers. Extremely attention should be paid to those residues selected in the QM region. In this case we selected the ligand and 6 residues that make direct contact with the ligand. The mmpbsa.in input file will contain all the parameters needed for the QM/MMGBSA calculation. In this case, there is no need to define a .mol2 for the glycan . 11 frames are going to be used when performing QM/MMGBSA calculation with the igb1 (GB-HCT) model (note that mbondi raddi set PBRadii=2 is used), PM3 method and a salt concentration = 0.15M. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Ribosomal50S_Mycalamide_A/","text":"CHARMM and MM(PB/GB)SA PB model is recommended when working with CHARMMff files. Nevertheless, the combination of PB/GB models and CHARMM force field hasn't been tested extensively. Please, check this thread for more information and proceed with caution. Mycalamide A Bound to the Large Ribosomal Subunit binding free energy calculations (Single Trajectory method) with CHARMMff files \u00b6 Info This example can be found in the docs/examples/Ribosomal50S_Mycalamide_A directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr final GROMACS MD trajectory, fitted and with no pbc. A topology file top take into account that *.itp files belonging to the topology file should be also present in the folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 41 23 -ct com_traj.xtc -cp topol.top mpirun -np 6 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 41 23 -ct com_traj.xtc -cp topol.top where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Although, we tried to use the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. sys_name=\"Ribo-MycalamideA\", verbose=2, / &gb igb=8, intdiel=10, saltcon=0.15, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 This is an extremely complex system (PDB ID: 3I55) that contains several ions, protein chains, ribosomal RNA as well as a ligand (Mycalamide A) bound. As you will see, gmx_MMPBSA is able to handle successfully such a complex system. Of note, just a relevant part of the entire system has been considered for binding free calculations, since the inclusion of the rest will increase the computation time without improving the results. You can check the file _GMXMMPBSA_COM_FIXED.pdb during the calculation to see how the complex looks like. In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 41 23 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. A topology file is also needed (mandatory) in this case to generate the topology files in amber format with all the terms for CHARMM force field. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Mycalamide A Bound to the Large Ribosomal Subunit"},{"location":"examples/Ribosomal50S_Mycalamide_A/#mycalamide-a-bound-to-the-large-ribosomal-subunit-binding-free-energy-calculations-single-trajectory-method-with-charmmff-files","text":"Info This example can be found in the docs/examples/Ribosomal50S_Mycalamide_A directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"Mycalamide A Bound to the Large Ribosomal Subunit binding free energy calculations (Single Trajectory method) with CHARMMff files"},{"location":"examples/Ribosomal50S_Mycalamide_A/#requirements","text":"In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates Receptor and ligand group integers Receptor and ligand group numbers in the index file A trajectory file xtc pdb gro trr final GROMACS MD trajectory, fitted and with no pbc. A topology file top take into account that *.itp files belonging to the topology file should be also present in the folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/Ribosomal50S_Mycalamide_A/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: Serial With MPI gmx_MMPBSA -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 41 23 -ct com_traj.xtc -cp topol.top mpirun -np 6 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 41 23 -ct com_traj.xtc -cp topol.top where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Although, we tried to use the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. sys_name=\"Ribo-MycalamideA\", verbose=2, / &gb igb=8, intdiel=10, saltcon=0.15, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/Ribosomal50S_Mycalamide_A/#considerations","text":"This is an extremely complex system (PDB ID: 3I55) that contains several ions, protein chains, ribosomal RNA as well as a ligand (Mycalamide A) bound. As you will see, gmx_MMPBSA is able to handle successfully such a complex system. Of note, just a relevant part of the entire system has been considered for binding free calculations, since the inclusion of the rest will increase the computation time without improving the results. You can check the file _GMXMMPBSA_COM_FIXED.pdb during the calculation to see how the complex looks like. In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand structures and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 41 23 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. A topology file is also needed (mandatory) in this case to generate the topology files in amber format with all the terms for CHARMM force field. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"},{"location":"examples/Stability/","text":"Stability calculations \u00b6 Info This example can be found in the docs/examples/Stability/ directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository Requirements \u00b6 In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx File containing the receptor and ligand in separated groups Receptor and ligand group integers Group numbers in the index files A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here Command-line \u00b6 That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t stability gmx_MMPBSA -O -i mmpbsa.in -s -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Stability\", startframe=5, endframe=14, verbose=2, forcefields=\"oldff/leaprc.ff99SB\", / &gb igb=2, saltcon=0.150, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples Considerations \u00b6 In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand (in this case, the ligand is also another protein) amber format topologies and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 19 20 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the the MM/PB(GB)SA calculation with the igb2 (GB-OBC1) model and a salt concentration = 0.15M. \"Stability\" calculation will be performed, and you will get statistics based on only a single system (complex). Any additional receptor or ligand information given will be ignored. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Stability calculations"},{"location":"examples/Stability/#stability-calculations","text":"Info This example can be found in the docs/examples/Stability/ directory in the repository folder. If you didn't use gmx_MMPBSA_test before, use downgit to download the specific folder from gmx_MMPBSA Github repository","title":"Stability calculations"},{"location":"examples/Stability/#requirements","text":"In this case, gmx_MMPBSA requires: Input File required Required Type Description Input parameters file in Input file containing all the specifications regarding the type of calculation that is going to be performed The MD Structure+mass(db) file tpr pdb gro Structure file containing the system coordinates An index file ndx File containing the receptor and ligand in separated groups Receptor and ligand group integers Group numbers in the index files A trajectory file xtc pdb gro trr Final GROMACS MD trajectory, fitted and with no pbc. A topology file (not included) top GROMACS topology file (The * .itp files defined in the topology must be in the same folder A Reference Structure file pdb Complex reference structure file (without hydrogens) with the desired assignment of chain ID and residue numbers -> Must be defined -- -> Optional, but recommended -- -> Optional See a detailed list of all the flags in gmx_MMPBSA command line here","title":"Requirements"},{"location":"examples/Stability/#command-line","text":"That being said, once you are in the folder containing all files, the command-line will be as follows: gmx_MMPBSA_test Serial With MPI gmx_MMPBSA_test -t stability gmx_MMPBSA -O -i mmpbsa.in -s -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc mpirun -np 2 gmx_MMPBSA MPI -O -i mmpbsa.in -cs com.tpr -ci index.ndx -cg 19 20 -ct com_traj.xtc where the mmpbsa.in input file, is a text file containing the following lines: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 Sample input file for GB calculation This input file is meant to show only that gmx_MMPBSA works. Althought, we tried to used the input files as recommended in the Amber manual, some parameters have been changed to perform more expensive calculations in a reasonable amount of time. Feel free to change the parameters according to what is better for your system. &general sys_name=\"Stability\", startframe=5, endframe=14, verbose=2, forcefields=\"oldff/leaprc.ff99SB\", / &gb igb=2, saltcon=0.150, / See a detailed list of all the options in gmx_MMPBSA input file here as well as several examples","title":"Command-line"},{"location":"examples/Stability/#considerations","text":"In this case, a single trajectory (ST) approximation is followed, which means the receptor and ligand (in this case, the ligand is also another protein) amber format topologies and trajectories will be obtained from that of the complex. To do so, a MD Structure+mass(db) file ( com.tpr ), an index file ( index.ndx ), a trajectory file ( com_traj.xtc ), and both the receptor and ligand group numbers in the index file ( 19 20 ) are needed. The mmpbsa.in input file will contain all the parameters needed for the MM/PB(GB)SA calculation. In this case, 16 frames (endframe-startframe)/interval = (21-5)/1 = 16 are going to be used when performing the the MM/PB(GB)SA calculation with the igb2 (GB-OBC1) model and a salt concentration = 0.15M. \"Stability\" calculation will be performed, and you will get statistics based on only a single system (complex). Any additional receptor or ligand information given will be ignored. Note Once the calculation is done, you can analyze the results in gmx_MMPBSA_ana (if you didn't define -nogui ). Please see the gmx_MMPBSA_ana section for more information","title":"Considerations"}]}